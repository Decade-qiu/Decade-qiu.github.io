<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="blog, decade, lucky">
    <meta name="description" content="Decade&#39;s lucky blog">
    <meta name="author" content="Zhongjun Qiu">
    
    <title>
        
            å¸¸è§çš„ LLM æ–‡æœ¬åµŒå…¥ï¼ˆEmbeddingï¼‰æ–¹æ³•è§£æ |
        
        Decade
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
        <link rel="shortcut icon" href="https://decade.net.cn/images/logo.ico">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/font/css/fontawesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/font/css/regular.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/font/css/solid.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/font/css/brands.min.css">
    
        
            
        
            
                
<link rel="stylesheet" href="/css/custom.css">

            
        
    
    <script class="keep-theme-configurations">
    const KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"decade.net.cn","root":"/","language":"en","path":"search.json"}
    KEEP.theme_config = {"base_info":{"primary_color":"#0066cc","title":"Decade","author":"Zhongjun Qiu","avatar":"/images/avatar.ico","logo":"/images/avatar.ico","favicon":"https://decade.net.cn/images/logo.ico"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","tags":"/tags || fa-solid fa-tags","categories":"/categories || fa-solid fa-layer-group","more":{"icon":"fa-solid fa-circle-user","children":[{"tool":"/tools || fa-solid fa-tools"},{"life":"/photos || fa-solid fa-image"},{"me":"/about || fa-solid fa-user-graduate"},{"Git":"/custom/index.html || fa-solid fa-user"}]}},"first_screen":{"enable":true,"background_img":"/images/bg.svg","background_img_dark":"/images/bg.svg","description":"The Steadfast Determination of An Ordinary Soul.","hitokoto":false},"social_contact":{"enable":true,"links":{"github":"https://github.com/Decade-qiu","weixin":"img | /images/social/weixin.jpg","qq":null,"weibo":null,"zhihu":null,"twitter":null,"x":"https://x.com/LukasMa46743746","facebook":null,"email":"qiuyu6021@gmail.com"}},"scroll":{"progress_bar":true,"percent":true,"hide_header":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-history","post_datetime_format":"ago"},"post":{"author_badge":{"enable":true,"level_badge":false,"custom_badge":"å…ƒå©´å¼€å‘è€…"},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":true,"reward":{"enable":true,"img_link":"/images/post/payment.jpg","text":null,"icon":null},"created_datetime_icon":"fa-solid fa-calendar-plus","updated_datetime_icon":"fa-solid fa-arrows-rotate"},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":false,"init_open":false,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":false,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":true},"comment":{"enable":true,"use":"waline","valine":{"appid":null,"appkey":null,"server_urls":null,"placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.39"},"waline":{"server_url":"https://waline-vercel-two-rho.vercel.app/","reaction":true,"version":"3.3.2"},"giscus":{"repo":null,"repo_id":null,"category":"Announcements","category_id":null,"reactions_enabled":false},"artalk":{"server":null},"disqus":{"shortname":null}},"rss":{"enable":false},"lazyload":{"enable":true},"cdn":{"enable":true,"provider":"cdnjs"},"pjax":{"enable":false},"footer":{"since":2020,"word_count":true,"site_deploy":{"enable":true,"provider":"github","url":"https://github.com"},"record":{"enable":false,"list":[{"code":null,"link":null}]}},"inject":{"enable":true,"css":[null,"/css/custom.css"],"js":[null,"/js/custom_code_block.js"]},"root":"","source_data":{"photos":[{"url":"/images/post/ã€å“²é£å£çº¸ã€‘æ—¥æœ¬åŠ¨æ¼«-ç”µé”¯äºº.webp","name":"ç”µé”¯äºº"},{"url":"/images/post/Quicker_20250428_193139.webp","name":"kowayia"},{"url":"/images/post/Quicker_20250428_233349.webp","name":"ä¸–ç•Œåœ°å›¾"},{"url":"/images/post/tmpFE1E.tmp.webp","name":"æ–½çº¢"},{"url":"/images/post/result-1745849388402.webp","name":"ä»‡å¿ éª.åŠ¨æ¼«ç‰ˆ"},{"url":"/images/photos/çŒ«çŒ«å›°äº†PNG.png","name":"çŒ«çŒ«å›°äº†PNG"},{"url":"/images/photos/å®é™çš„æš´é›¨å¤©.png","name":"å®é™çš„æš´é›¨å¤©"},{"url":"/images/photos/æˆ‘åœ¨æ‰¬å·å¥½æƒ³ä½ .png","name":"æˆ‘åœ¨æ‰¬å·å¥½æƒ³ä½ "},{"url":"/images/photos/ä¿¡é¸½.png","name":"ä¿¡é¸½"},{"url":"/images/photos/å•¤é…’çƒ§çƒ¤.png","name":"å•¤é…’çƒ§çƒ¤"},{"url":"/images/photos/éšæ‰‹æ‹.png","name":"éšæ‰‹æ‹"},{"url":"/images/photos/ç³–æ²¹æ··åˆç‚¸å¼¹.png","name":"ç³–æ²¹æ··åˆç‚¸å¼¹"},{"url":"/images/photos/é¦™é¦™çš„.png","name":"é¦™é¦™çš„"},{"url":"/images/photos/èå­è±è±.png","name":"èå­è±è±"},{"url":"/images/post/æŒ‡Cä¸ºpython.png","name":"æŒ‡Cä¸ºpython"},{"url":"/images/photos/YangZhou_Station.png","name":"YangZhou Station"},{"url":"/images/photos/GBC.jpg","name":"Girls Band Cry"},{"url":"/images/photos/bocchi.webp","name":"Bocchi the Rock!"}],"tools":[{"category":"AIGC","anchorId":"QUlHQw0"},{"name":"ChatGPT","link":"https://chat.openai.com/","description":"OpenAI æ——ä¸‹ AI èŠå¤©å¯¹è¯å·¥å…·","image":"/images/tools/chatgpt.svg"},{"name":"Gemini","link":"https://gemini.google.com/app","description":"Google æ——ä¸‹ AI èŠå¤©å¯¹è¯å·¥å…·","image":"/images/tools/gemini.svg"},{"name":"Copilot","link":"https://copilot.microsoft.com/","description":"Microsoft æ——ä¸‹ AI èŠå¤©å¯¹è¯å·¥å…·","image":"/images/tools/copilot.png"},{"name":"Deepseek","link":"https://chat.deepseek.com/","description":"Deepseek æ——ä¸‹ AI èŠå¤©å¯¹è¯å·¥å…·","image":"/images/tools/deepseek.jpg"},{"name":"Qwen","link":"https://chat.qwen.ai/","description":"Alibaba æ——ä¸‹ AI èŠå¤©å¯¹è¯å·¥å…·","image":"/images/tools/tongyiqianwen.svg"},{"name":"å³æ¢¦AI","link":"https://jimeng.jianying.com/ai-tool/home","description":"Dreamina å›¾åƒç”Ÿæˆå·¥å…·","image":"/images/tools/dream.png"},{"name":"komiko","link":"https://komiko.app/home","description":"Komiko åŠ¨æ¼«åŒ–AIå·¥å…·","image":"/images/tools/komiko.webp"},{"name":"InsMind","link":"https://www.insmind.com/zh-cn/workspace/","description":"AIå›¾ç‰‡ç¼–è¾‘å·¥å…·","image":"/images/tools/insmind.svg"},{"name":"Raphael","link":"https://raphael.app/zh","description":"AIå›¾ç‰‡ç”Ÿæˆå·¥å…·","image":"/images/tools/rap.png"},{"name":"è…¾è®¯å…ƒå®","link":"https://yuanbao.tencent.com/chat/","description":"Tencent æ——ä¸‹ AI èŠå¤©å¯¹è¯å·¥å…·","image":"/images/tools/tencent.jpg"},{"name":"è±†åŒ…","link":"https://www.doubao.com/chat/","description":"å­—èŠ‚è·³åŠ¨ å›¾ç‰‡ç”Ÿæˆå·¥å…·","image":"/images/tools/dn.jpg"},{"category":"Airport","anchorId":"QWlycG9ydA12"},{"name":"ç‹¬è§’å…½","link":"https://91unicorn.cloud/","description":"ååˆ†ç¨³å®š","image":"/images/tools/dujiaoshou.ico"},{"name":"æé€Ÿæœºåœº","link":"https://xn--mes358acgm99l.com/","description":"ä¾¿å®œå¥½ç”¨","image":"/images/tools/jisu.ico"},{"name":"iKuuu","link":"https://ikuuu.org/user","description":"ä»¥å¤‡ä¸æ—¶ä¹‹éœ€","image":"/images/tools/ikuu.ico"},{"category":"File Converter","anchorId":"RmlsZSUyMENvbnZlcnRlcg16"},{"name":"Online Image Tool","link":"https://www.onlineimagetool.com/zh/","description":"åœ¨çº¿å‹ç¼©å’Œè½¬æ¢å›¾ç‰‡","image":"/images/tools/oit.png"},{"name":"Vector Magic","link":"https://zh.vectormagic.com/","description":"æ–‡ä»¶çŸ¢é‡åŒ–","image":"/images/tools/apple-touch-icon-180_97956a9f5fbf6a767de100280d78c1f8.png"},{"name":"TinyPNG","link":"https://tinypng.com/","description":"Smart AVIF, WebP, PNG and JPEG Compression for Faster Websites","image":"/images/tools/tiny.ico"},{"name":"è¸å¾—","link":"https://techbrood.com/tool","description":"HTML5åœ¨çº¿å·¥å…·","image":"/images/tools/td.ico"},{"name":"UUåœ¨çº¿å·¥å…·","link":"https://uutool.cn/base64/","description":"base64å·¥å…·åŒ…","image":"/images/tools/uu.png"},{"name":"I Love PDF","link":"https://www.ilovepdf.com/","description":"PDFå·¥å…·åŒ…","image":"/images/tools/ilovepdf.svg"},{"category":"Free GPT API","anchorId":"RnJlZSUyMEdQVCUyMEFQSQ23"},{"name":"Gemini API","link":"https://ai.google.dev/gemini-api/docs/quickstart?lang=python","description":"Google Gemini API","image":"/images/tools/touchicon-180-new.png"},{"name":"SiliconCloud","link":"https://cloud.siliconflow.cn/models","description":"å„ç§æ¨¡å‹API"},{"name":"Cloudflare Workers AI","link":"https://developers.cloudflare.com/workers-ai/configuration/open-ai-compatibility/","description":"OpenAI compatible API endpoints","image":"/images/tools/logo.p_ySeMR1.svg"},{"name":"ç®—äº†ä¹ˆ","link":"https://api.suanli.cn/","description":"å…±äº«ç®—åŠ›API","image":"/images/tools/suanlm.svg"},{"category":"Resource Explorer","anchorId":"UmVzb3VyY2UlMjBFeHBsb3Jlcg28"},{"name":"Free for Developers","link":"https://free-for.dev/","description":"A list of SaaS, PaaS and IaaS offerings that have free tiers of interest to devops and infradev","image":"/images/tools/freefd.webp"},{"name":"zlibrary","link":"https://zh.z-library.sk/","description":"åœ¨çº¿å›¾ä¹¦é¦†","image":"/images/tools/logo.zlibrary.svg"},{"name":"PicX","link":"https://picx.xpoet.cn/","description":"åŸºäºGithubçš„å›¾åºŠ","image":"/images/tools/logo.ffee4291.png"},{"name":"HaoWallpaper","link":"https://haowallpaper.com/","description":"å“²é£å£çº¸","image":"/images/tools/haowall.ico"},{"name":"Awesome","link":"https://wallhaven.cc/","description":"WallHaven","image":"/images/tools/wallheaven.ico"},{"name":"WallHere","link":"https://wallhere.com/","description":"WallHere"},{"name":"SnapAny","link":"https://snapany.com/zh","description":"ä¸‡èƒ½è§†é¢‘å›¾ç‰‡è§£æä¸‹è½½"},{"name":"Ã˜Magnet","link":"https://0cili.org/","description":"ç§å­ä¸‹è½½"},{"name":"twitter","link":"https://snapvid.net/zh-cn/twitter-downloader","description":"æ¨ç‰¹è§†é¢‘ä¸‹è½½å™¨","image":"/images/tools/apple-touch-icon.png"},{"name":"youtube","link":"https://www.y2mate.com/en949","description":"Youtubeè§†é¢‘ä¸‹è½½å™¨","image":"/images/tools/y2mate.webp"},{"name":"Icons8","link":"https://icons8.com/icons","description":"å…è´¹å›¾æ ‡ä¸‹è½½","image":"/images/tools/logo-icons8.svg"},{"name":"å…¨èƒ½emoji","link":"https://www.emojiall.com/zh-hans","description":"emojiåˆ¶ä½œ","image":"/images/tools/emoji.ico"},{"name":"emojidb","link":"https://emojidb.org/","description":"å…è´¹è¡¨æƒ…åŒ…ä¸‹è½½","image":"/images/tools/emojidb.png"},{"name":"Flaticon","link":"https://www.flaticon.com/","description":"å…è´¹å›¾æ ‡ä¸‹è½½","image":"/images/tools/logo-flaticon.svg"},{"name":"IconFinder","link":"https://www.iconfinder.com/","description":"å…è´¹å›¾æ ‡ä¸‹è½½","image":"/images/tools/logo-iconfinder.svg"}]},"version":"4.2.5"}
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"}
    KEEP.language_code_block = {"copy":"Copy code","copied":"Copied","fold":"Fold code block","folded":"Folded"}
    KEEP.language_copy_copyright = {"copy":"Copy copyright info","copied":"Copied","title":"Original post title","author":"Original post author","link":"Original post link"}
  </script>
<meta name="generator" content="Hexo 7.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
</div>



<main class="page-container border-box">
    <!-- home first screen  -->
    

    <!-- page content -->
    <div class="page-main-content border-box">
        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="border-box header-content">
        <div class="left flex-start border-box">
            
                <a class="logo-image border-box" href="/">
                    <img src="/images/avatar.ico">
                </a>
            
            <a class="site-name border-box" href="/">
               Decade
            </a>
        </div>

        <div class="right border-box">
            <div class="pc border-box">
                <ul class="menu-list border-box">
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-home"></i>
                                
                                HOME
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/archives">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-box-archive"></i>
                                
                                ARCHIVES
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/tags">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-tags"></i>
                                
                                TAGS
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/categories">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-layer-group"></i>
                                
                                CATEGORIES
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box has-sub-menu">
                            <a class="menu-text-color border-box" href="javascript:void(0);">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-circle-user"></i>
                                
                                MORE
                                
                                    <i class="menu-text-color collapse-icon fa-solid fa-angle-down"></i>
                                
                            </a>
                            
                                <ul class="sub-menu-list border-box">
                                    
                                        
                                        <li class="sub-menu-item border-box ">
                                            <a class="menu-text-color border-box flex-start" href="/tools">
                                                
                                                    <i class="menu-text-color sub-menu-icon fa-solid fa-tools"></i>
                                                
                                                TOOL
                                            </a>
                                        </li>
                                    
                                        
                                        <li class="sub-menu-item border-box ">
                                            <a class="menu-text-color border-box flex-start" href="/photos">
                                                
                                                    <i class="menu-text-color sub-menu-icon fa-solid fa-image"></i>
                                                
                                                LIFE
                                            </a>
                                        </li>
                                    
                                        
                                        <li class="sub-menu-item border-box ">
                                            <a class="menu-text-color border-box flex-start" href="/about">
                                                
                                                    <i class="menu-text-color sub-menu-icon fa-solid fa-user-graduate"></i>
                                                
                                                ME
                                            </a>
                                        </li>
                                    
                                        
                                        <li class="sub-menu-item border-box ">
                                            <a class="menu-text-color border-box flex-start" href="/custom/">
                                                
                                                    <i class="menu-text-color sub-menu-icon fa-solid fa-user"></i>
                                                
                                                GIT
                                            </a>
                                        </li>
                                    
                                </ul>
                            
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="menu-text-color fas search fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile border-box flex-start">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list border-box">
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-home"></i>
                                </span>
                            
                            HOME
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/archives">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-box-archive"></i>
                                </span>
                            
                            ARCHIVES
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/tags">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-tags"></i>
                                </span>
                            
                            TAGS
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/categories">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-layer-group"></i>
                                </span>
                            
                            CATEGORIES
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box has-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="javascript:void(0);">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-circle-user"></i>
                                </span>
                            
                            MORE
                        </a>
                        
                            <i class="right-side collapse-icon fa-solid fa-angle-left"></i>
                        
                    </label>
                    
                        <ul class="drawer-sub-menu-list border-box">
                            
                                
                                <li class="sub-menu-item border-box">
                                    <a class="drawer-menu-text-color border-box flex-start" href="/tools">
                                        
                                            <span class="sub-menu-icon-wrap border-box flex-center">
                                                <i class="drawer-menu-text-color sub-menu-icon fa-solid fa-tools"></i>
                                            </span>
                                        
                                        TOOL
                                    </a>
                                </li>
                            
                                
                                <li class="sub-menu-item border-box">
                                    <a class="drawer-menu-text-color border-box flex-start" href="/photos">
                                        
                                            <span class="sub-menu-icon-wrap border-box flex-center">
                                                <i class="drawer-menu-text-color sub-menu-icon fa-solid fa-image"></i>
                                            </span>
                                        
                                        LIFE
                                    </a>
                                </li>
                            
                                
                                <li class="sub-menu-item border-box">
                                    <a class="drawer-menu-text-color border-box flex-start" href="/about">
                                        
                                            <span class="sub-menu-icon-wrap border-box flex-center">
                                                <i class="drawer-menu-text-color sub-menu-icon fa-solid fa-user-graduate"></i>
                                            </span>
                                        
                                        ME
                                    </a>
                                </li>
                            
                                
                                <li class="sub-menu-item border-box">
                                    <a class="drawer-menu-text-color border-box flex-start" href="/custom/">
                                        
                                            <span class="sub-menu-icon-wrap border-box flex-center">
                                                <i class="drawer-menu-text-color sub-menu-icon fa-solid fa-user"></i>
                                            </span>
                                        
                                        GIT
                                    </a>
                                </li>
                            
                        </ul>
                    
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle border-box">

            <div class="main-content border-box">
                

                    
<div class="fade-in-down-animation">
    <div class="post-page-container border-box">
        <div class="post-content-container border-box">
            
                <div class="post-content-top border-box"
                     style="height: 480px"
                >
                    <div class="cover-post-title">
                        å¸¸è§çš„ LLM æ–‡æœ¬åµŒå…¥ï¼ˆEmbeddingï¼‰æ–¹æ³•è§£æ
                    </div>
                    <img class="post-cover" src="/images/post/iShot_2025-11-03_20.50.07.webp"
                         onerror="this.style.display='none'"
                    >
                </div>
            

            <div class="post-content-bottom border-box has-cover">
                

                
                    <div class="post-header border-box">
                        
                            <div class="avatar-box border-box">
                                <img src="/images/avatar.ico">
                            </div>
                        
                        <div class="info-box">
                            <div class="author border-box">
                                <span class="name">Zhongjun Qiu</span>
                                
                                    <span class="author-badge">å…ƒå©´å¼€å‘è€…</span>
                                
                            </div>
                            <div class="meta-info border-box">
                                

<div class="post-meta-info-container border-box post">
    <div class="post-meta-info border-box">
        

        
            <span class="meta-info-item post-create-date">
                <i class="icon fa-solid fa-calendar-plus"></i>&nbsp;
                <span class="datetime">2025-11-03 20:40:22</span>
            </span>

            
                <span class="meta-info-item post-update-date">
                    <i class="icon fa-solid fa-arrows-rotate"></i>&nbsp;
                    <span class="datetime" data-updated="Mon Nov 03 2025 21:42:11 GMT+0800">2025-11-03 21:42:11</span>
                </span>
            
        

        
            <span class="meta-info-item post-category border-box"><i class="icon fas fa-folder"></i>&nbsp;
                <ul class="post-category-ul">
                    
                            <li class="category-item"><a href="/categories/LLM/">LLM</a></li>
                        
                    
                </ul>
            </span>
        

        
            <span class="post-tag meta-info-item border-box">
                <ul class="post-tag-ul">
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/Embedding/">Embedding</a></li>
                        
                    
                </ul>
            </span>
        

        
        
            <span class="meta-info-item post-wordcount">
                <i class="icon fas fa-file-word"></i>&nbsp;<span>7.6k Words</span>
            </span>
        
        
            <span class="meta-info-item post-min2read">
                <i class="icon fas fa-clock"></i>&nbsp;<span>32 Mins</span>
            </span>
        
        
            <span class="meta-info-item post-pv">
                <i class="icon fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
            </span>
        
    </div>

    
</div>

                            </div>
                        </div>
                    </div>
                

                <div class="post-content keep-markdown-body ">
                    

                    
                         <p>æœ¬ç¯‡æ–‡ç« ä»‹ç»å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ä¸­å¸¸ç”¨çš„æ–‡æœ¬åµŒå…¥ï¼ˆEmbeddingï¼‰æ–¹æ³•ï¼ŒåŒ…æ‹¬ä¼ ç»Ÿçš„
One-Hot ç¼–ç ã€è¯è¢‹æ¨¡å‹ï¼ˆBoWï¼‰ã€TF-IDF ä»¥åŠç°ä»£çš„è¯å‘é‡ï¼ˆWord
Embeddingï¼‰æŠ€æœ¯ã€‚æ¯ç§æ–¹æ³•çš„åŸç†ã€ä¼˜ç¼ºç‚¹åŠå…¶åœ¨å®é™…ä¸­çš„åº”ç”¨åœºæ™¯éƒ½ä¼šè¿›è¡Œè¯¦ç»†è®²è§£ï¼Œå¹¶é™„æœ‰ä»£ç ç¤ºä¾‹ä»¥å¸®åŠ©ç†è§£ã€‚</p>
<span id="more"></span>
<h2 id="å¼•è¨€å¤§è¯­è¨€æ¨¡å‹llmçš„ç¬¬äºŒå—åŸºçŸ³embedding">ğŸ’¡
å¼•è¨€ï¼šå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„ç¬¬äºŒå—åŸºçŸ³â€”â€”Embedding</h2>
<p>åœ¨ä¸Šä¸€ç¯‡ä¸­ï¼Œæˆ‘ä»¬æ¢è®¨äº† <strong>Tokenizer</strong>
å¦‚ä½•å°†æ–‡æœ¬è½¬åŒ–ä¸ºæœºå™¨å¯è¯»çš„ <strong>Token ID
åºåˆ—</strong>ã€‚ç„¶è€Œï¼Œè¿™äº›ç®€å•çš„ ID æ•°å­—ï¼ˆå¦‚
<code>[464, 9016, 2793, ...]</code>ï¼‰æœ¬èº«ä¸åŒ…å«ä»»ä½•è¯­ä¹‰ä¿¡æ¯ã€‚æ¨¡å‹çŸ¥é“ ID
9016 å¯¹åº” â€œlowestâ€ï¼Œä½†ä¸çŸ¥é“å®ƒä¸ ID 2793 å¯¹åº”çš„ â€œlowerâ€
åœ¨æ„ä¹‰ä¸Šæ˜¯ç›¸ä¼¼çš„ï¼Œè€Œä¸ ID 4000 å¯¹åº”çš„ â€œbananaâ€ æ˜¯ä¸ç›¸å…³çš„ã€‚</p>
<p>è¦è®©æœºå™¨çœŸæ­£ç†è§£è¯­è¨€çš„<strong>æ„ä¹‰ã€ä¸Šä¸‹æ–‡å’Œå…³ç³»</strong>ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæœºåˆ¶å°†ç¦»æ•£çš„ã€æ¯«æ— å…³è”çš„
Token ID
è½¬åŒ–ä¸ºè¿ç»­çš„ã€å…·æœ‰ä¸°å¯Œè¯­ä¹‰ä¿¡æ¯çš„<strong>å‘é‡ï¼ˆVectorï¼‰</strong>è¡¨ç¤ºã€‚è¿™ä¸ªæœºåˆ¶å°±æ˜¯
<strong>Embeddingï¼ˆè¯åµŒå…¥æˆ–ä»¤ç‰ŒåµŒå…¥ï¼‰</strong>ã€‚</p>
<h3 id="ä¸ºä»€ä¹ˆ-embedding-æ˜¯-llm-çš„æ ¸å¿ƒç»„ä»¶">ä¸ºä»€ä¹ˆ Embedding æ˜¯ LLM
çš„æ ¸å¿ƒç»„ä»¶ï¼Ÿ</h3>
<ol type="1">
<li><strong>è¯­ä¹‰è¡¨ç¤ºï¼ˆSemantic Representationï¼‰</strong>ï¼šEmbedding
æ˜¯ä¸€å¼ é«˜ç»´ç©ºé—´ä¸­çš„â€œåœ°å›¾â€ã€‚å®ƒé€šè¿‡å­¦ä¹ ï¼Œå°†å…·æœ‰ç›¸ä¼¼æ„ä¹‰çš„ Token
æ”¾ç½®åœ¨è¿™ä¸ªç©ºé—´ä¸­å½¼æ­¤<strong>æ¥è¿‘</strong>çš„ä½ç½®ã€‚ä¾‹å¦‚ï¼Œåœ¨å‘é‡ç©ºé—´ä¸­ï¼Œ<span class="math inline">Vector(â€œKingâ€)â€…âˆ’â€…Vector(â€œManâ€)â€…+â€…Vector(â€œWomanâ€)</span>
çº¦ç­‰äº <span class="math inline">Vector(â€œQueenâ€)</span>ï¼Œè¿™ä½“ç°äº†è¯­è¨€å†…åœ¨çš„ä»£æ•°å…³ç³»ã€‚</li>
<li><strong>é™ç»´ä¸ç‰¹å¾æå–ï¼ˆDimensionality Reduction &amp;
Featuresï¼‰</strong>ï¼šEmbedding å°†åºå¤§ä¸”ç¨€ç–çš„è¯æ±‡è¡¨ï¼ˆæ•°ä¸‡ä¸ª
Tokenï¼‰æ˜ å°„åˆ°ç›¸å¯¹ä½ç»´ä¸”å¯†é›†çš„å‘é‡ç©ºé—´ï¼ˆå¦‚ 768 ç»´æˆ– 4096
ç»´ï¼‰ï¼Œæå¤§åœ°æé«˜äº†æ¨¡å‹çš„è®¡ç®—æ•ˆç‡å’Œå­¦ä¹ èƒ½åŠ›ã€‚</li>
<li><strong>æ¨¡å‹å…¼å®¹æ€§ï¼ˆNeural Network Compatibilityï¼‰</strong>ï¼šæ— è®ºæ˜¯
Transformer æ¶æ„ã€RNN è¿˜æ˜¯
CNNï¼Œå®ƒä»¬éƒ½éœ€è¦è¿ç»­çš„ã€å¯å¾®åˆ†çš„æ•°å€¼è¾“å…¥æ‰èƒ½è¿›è¡Œæ¢¯åº¦ä¸‹é™å’Œè®­ç»ƒã€‚Embedding
å±‚æ­£æ˜¯æä¾›äº†è¿™ç§<strong>å¯å­¦ä¹ çš„æ•°å€¼åŒ–è¡¨ç¤º</strong>ï¼Œæ˜¯æ•´ä¸ªæ·±åº¦å­¦ä¹ æ¨¡å‹æ¥æ”¶è¾“å…¥çš„å¿…ç»ä¹‹è·¯ã€‚</li>
</ol>
<h2 id="one-hot-ç¼–ç ç‹¬çƒ­è¡¨ç¤º">1. One-Hot ç¼–ç ï¼ˆç‹¬çƒ­è¡¨ç¤ºï¼‰</h2>
<h3 id="ä¸»è¦æ€æƒ³ä¸åŸç†">ğŸ’¡ ä¸»è¦æ€æƒ³ä¸åŸç†</h3>
<p>One-Hot
ç¼–ç æ˜¯ä¸€ç§<strong>ç¨€ç–ã€é«˜ç»´ã€ç¦»æ•£</strong>çš„å‘é‡è¡¨ç¤ºæ–¹æ³•ï¼Œä¹Ÿæ˜¯æœ€æ—©ã€æœ€ç›´è§‚çš„æ–‡æœ¬è¡¨ç¤ºæ–¹å¼ã€‚</p>
<ul>
<li><strong>åŸç†ï¼š</strong> é¦–å…ˆï¼Œå¯¹è®­ç»ƒè¯­æ–™ä¸­çš„æ‰€æœ‰ä¸é‡å¤çš„è¯ï¼ˆæˆ–
Tokenï¼‰å»ºç«‹ä¸€ä¸ªè¯æ±‡è¡¨ <span class="math inline"><em>V</em></span>ã€‚è¯æ±‡è¡¨çš„å¤§å° <span class="math inline">|<em>V</em>|</span> å³ä¸ºå‘é‡çš„ç»´åº¦ã€‚</li>
<li><strong>è¡¨ç¤ºï¼š</strong> è¯ <span class="math inline"><em>w</em></span> çš„ One-Hot å‘é‡ <span class="math inline"><strong>v</strong><sub><em>w</em></sub></span>
æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º <span class="math inline">|<em>V</em>|</span>
çš„å‘é‡ï¼Œå…¶ä¸­åªæœ‰å¯¹åº”äº <span class="math inline"><em>w</em></span>
åœ¨è¯æ±‡è¡¨ä¸­çš„ç´¢å¼•ä½ç½®ä¸º <strong>1</strong>ï¼Œå…¶ä»–ä½ç½®å‡ä¸º
<strong>0</strong>ã€‚</li>
</ul>
<h3 id="ç¼ºç‚¹åˆ†æ">ğŸ§ ç¼ºç‚¹åˆ†æ</h3>
<ol type="1">
<li><strong>ç»´åº¦ç¾éš¾ï¼š</strong>
å½“è¯æ±‡è¡¨å¾ˆå¤§æ—¶ï¼ˆå¦‚å‡ åä¸‡ï¼‰ï¼Œå‘é‡ç»´åº¦æé«˜ï¼Œä¸”ç»å¤§å¤šæ•°å…ƒç´ æ˜¯
0ï¼ˆç¨€ç–ï¼‰ï¼Œè®¡ç®—æ•ˆç‡ä½ä¸‹ã€‚</li>
<li><strong>è¯­ä¹‰é¸¿æ²Ÿï¼š</strong> ä»»æ„ä¸¤ä¸ªè¯çš„ One-Hot
å‘é‡çš„ç‚¹ç§¯ï¼ˆæˆ–ä½™å¼¦ç›¸ä¼¼åº¦ï¼‰æ€»æ˜¯
0ï¼Œè¡¨ç¤ºå®ƒä»¬ä¹‹é—´<strong>å®Œå…¨ç‹¬ç«‹</strong>ã€‚è¿™æ— æ³•ä½“ç°è¯æ±‡é—´çš„ä»»ä½•è¯­ä¹‰å…³ç³»ï¼ˆä¾‹å¦‚ï¼šâ€œçŒ«â€å’Œâ€œè™â€å¾ˆç›¸ä¼¼ï¼Œä½†å®ƒä»¬çš„
One-Hot å‘é‡è·ç¦»ä¸â€œçŒ«â€å’Œâ€œå®‡å®™é£èˆ¹â€çš„è·ç¦»æ˜¯ç›¸åŒçš„ï¼‰ã€‚</li>
</ol>
<h3 id="ç¤ºä¾‹python-å®ç°">ğŸ’» ç¤ºä¾‹ï¼ˆPython å®ç°ï¼‰</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‡è®¾çš„è¯æ±‡è¡¨ V</span></span><br><span class="line">vocab = [<span class="string">'æˆ‘'</span>, <span class="string">'çˆ±'</span>, <span class="string">'å­¦ä¹ '</span>, <span class="string">'è‡ªç„¶è¯­è¨€å¤„ç†'</span>, <span class="string">'æŠ€æœ¯'</span>]</span><br><span class="line">vocab_size = <span class="built_in">len</span>(vocab)</span><br><span class="line">word_to_idx = {word: i <span class="keyword">for</span> i, word <span class="keyword">in</span> <span class="built_in">enumerate</span>(vocab)}</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">one_hot_encode</span>(<span class="params">word</span>):</span><br><span class="line">    <span class="string">"""ä¸ºç»™å®šè¯ç”Ÿæˆ One-Hot å‘é‡"""</span></span><br><span class="line">    <span class="keyword">if</span> word <span class="keyword">not</span> <span class="keyword">in</span> word_to_idx:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">f"'<span class="subst">{word}</span>' ä¸åœ¨è¯æ±‡è¡¨ä¸­ã€‚"</span>)</span><br><span class="line">    </span><br><span class="line">    vector = np.zeros(vocab_size)</span><br><span class="line">    index = word_to_idx[word]</span><br><span class="line">    vector[index] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> vector</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–ç  "å­¦ä¹ "</span></span><br><span class="line">word_study = <span class="string">'å­¦ä¹ '</span></span><br><span class="line">vector_study = one_hot_encode(word_study)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"è¯æ±‡è¡¨å¤§å°: <span class="subst">{vocab_size}</span>"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"'<span class="subst">{word_study}</span>' çš„ One-Hot å‘é‡: <span class="subst">{vector_study}</span>"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–ç  "æŠ€æœ¯"</span></span><br><span class="line">word_tech = <span class="string">'æŠ€æœ¯'</span></span><br><span class="line">vector_tech = one_hot_encode(word_tech)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"'<span class="subst">{word_tech}</span>' çš„ One-Hot å‘é‡: <span class="subst">{vector_tech}</span>"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—ä¸¤ä¸ªå‘é‡çš„ä½™å¼¦ç›¸ä¼¼åº¦</span></span><br><span class="line"><span class="comment"># np.dot(v1, v2) / (np.linalg.norm(v1) * np.linalg.norm(v2))</span></span><br><span class="line">similarity = np.dot(vector_study, vector_tech)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"'<span class="subst">{word_study}</span>' å’Œ '<span class="subst">{word_tech}</span>' çš„ç›¸ä¼¼åº¦: <span class="subst">{similarity}</span>"</span>) </span><br><span class="line"><span class="comment"># ç»“æœå§‹ç»ˆä¸º 0ï¼Œå› ä¸ºå‘é‡æ­£äº¤</span></span><br></pre></td></tr></table></figure>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¯æ±‡è¡¨å¤§å°: 5</span><br><span class="line">'å­¦ä¹ ' çš„ One-Hot å‘é‡: [0. 0. 1. 0. 0.]</span><br><span class="line">'æŠ€æœ¯' çš„ One-Hot å‘é‡: [0. 0. 0. 0. 1.]</span><br><span class="line">'å­¦ä¹ ' å’Œ 'æŠ€æœ¯' çš„ç›¸ä¼¼åº¦: 0.0</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥ç”¨ç°æˆçš„åº“</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> OneHotEncoder</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">corpus = [[<span class="string">"æˆ‘"</span>], [<span class="string">"çˆ±"</span>], [<span class="string">"è‡ªç„¶è¯­è¨€"</span>], [<span class="string">"å¤„ç†"</span>]]</span><br><span class="line"></span><br><span class="line">enc = OneHotEncoder(sparse_output=<span class="literal">False</span>)  <span class="comment"># è¿”å›ç¨ å¯†çŸ©é˜µ</span></span><br><span class="line">onehot = enc.fit_transform(corpus)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"è¯è¡¨:"</span>, enc.categories_)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"One-hot è¡¨ç¤º:\n"</span>, onehot)</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">è¯è¡¨: [<span class="built_in">array</span>([<span class="string">'å¤„ç†'</span>, <span class="string">'æˆ‘'</span>, <span class="string">'çˆ±'</span>, <span class="string">'è‡ªç„¶è¯­è¨€'</span>], dtype=object)]</span><br><span class="line">One-hot è¡¨ç¤º:</span><br><span class="line"> [[<span class="number">0.</span> <span class="number">1.</span> <span class="number">0.</span> <span class="number">0.</span>]</span><br><span class="line"> [<span class="number">0.</span> <span class="number">0.</span> <span class="number">1.</span> <span class="number">0.</span>]</span><br><span class="line"> [<span class="number">0.</span> <span class="number">0.</span> <span class="number">0.</span> <span class="number">1.</span>]</span><br><span class="line"> [<span class="number">1.</span> <span class="number">0.</span> <span class="number">0.</span> <span class="number">0.</span>]]</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="è¯è¢‹ç¼–ç åŠä¼˜åŒ–bow-n-gram-tf-idf">2. è¯è¢‹ç¼–ç åŠä¼˜åŒ–ï¼ˆBoW, N-gram,
TF-IDFï¼‰</h2>
<h3 id="ä¸»è¦æ€æƒ³ä¸åŸç†-1">ğŸ§  ä¸»è¦æ€æƒ³ä¸åŸç†</h3>
<p>è¿™ç±»æ–¹æ³•å°†ä¸€ä¸ªæ–‡æ¡£è¡¨ç¤ºä¸ºä¸€ä¸ªå‘é‡ï¼Œå‘é‡çš„æ¯ä¸ªç»´åº¦å¯¹åº”è¯æ±‡è¡¨ä¸­çš„ä¸€ä¸ªè¯ã€‚å®ƒä»¬ä¸»è¦å…³æ³¨<strong>è¯æ±‡çš„é¢‘ç‡æˆ–é‡è¦æ€§</strong>ï¼Œ<strong>å¿½ç•¥è¯åº</strong>ã€‚</p>
<h4 id="è¯è¢‹æ¨¡å‹-bag-of-words-bow">2.1 è¯è¢‹æ¨¡å‹ (Bag-of-Words, BoW)</h4>
<ul>
<li><strong>æ€æƒ³ï¼š</strong>
å°†æ–‡æ¡£è§†ä¸ºâ€œä¸€è¢‹å­â€è¯è¯­çš„é›†åˆï¼Œ<strong>åªç»Ÿè®¡è¯è¯­çš„å‡ºç°æ¬¡æ•°</strong>ï¼ˆTerm
Frequency, TFï¼‰ï¼Œå®Œå…¨ä¸è€ƒè™‘è¯è¯­å‡ºç°çš„é¡ºåºå’Œè¯­æ³•ç»“æ„ã€‚</li>
<li><strong>åŸç†ï¼š</strong> æ–‡æ¡£å‘é‡ <span class="math inline"><strong>d</strong></span> çš„ç¬¬ <span class="math inline"><em>i</em></span> ç»´æ•°å€¼å°±æ˜¯è¯æ±‡è¡¨ä¸­çš„ç¬¬ <span class="math inline"><em>i</em></span> ä¸ªè¯åœ¨æ–‡æ¡£ä¸­å‡ºç°çš„æ¬¡æ•° <span class="math inline"><em>C</em><em>o</em><em>u</em><em>n</em><em>t</em>(<em>w</em><sub><em>i</em></sub>,â€†<em>d</em>)</span>ã€‚</li>
</ul>
<p><strong>è¯è¢‹æ¨¡å‹ï¼ˆBoWï¼‰</strong> å°†æ–‡æœ¬è¡¨ç¤ºä¸º
<strong>è¯é¢‘ç»Ÿè®¡å‘é‡</strong>ï¼š</p>
<ul>
<li>å¿½ç•¥è¯åºï¼Œä»…ç»Ÿè®¡æ¯ä¸ªè¯å‡ºç°æ¬¡æ•°</li>
<li>æ¯ä¸ªæ–‡æ¡£è¡¨ç¤ºä¸º â€œè¯é¢‘åˆ†å¸ƒâ€</li>
</ul>
<p>ä¾‹å¦‚ï¼Œè¯­æ–™ä¸ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Doc1: æˆ‘ çˆ± è‡ªç„¶ è¯­è¨€</span><br><span class="line">Doc2: æˆ‘ çˆ± å¤„ç†</span><br></pre></td></tr></table></figure>
<p>åˆ™è¯è¡¨ä¸º [æˆ‘, çˆ±, è‡ªç„¶è¯­è¨€, å¤„ç†] è¡¨ç¤ºä¸ºï¼š</p>
<table>
<thead>
<tr>
<th>æ–‡æ¡£</th>
<th>æˆ‘</th>
<th>çˆ±</th>
<th>è‡ªç„¶</th>
<th>è¯­è¨€</th>
<th>å¤„ç†</th>
</tr>
</thead>
<tbody>
<tr>
<td>Doc1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>Doc2</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>è¿™å°±æ˜¯æœ€åŸå§‹çš„ BoWã€‚</p>
<h4 id="n-gram">2.2 N-gram</h4>
<ul>
<li><strong>æ€æƒ³ï¼š</strong> å¯¹ BoW
æ¨¡å‹çš„<strong>è¯åºç›²ç‚¹</strong>è¿›è¡Œä¼˜åŒ–ï¼Œå°†è¿ç»­çš„ <span class="math inline"><em>N</em></span> ä¸ªè¯ä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼ˆä¸€ä¸ª
Tokenï¼‰è¿›è¡Œè®¡æ•°ã€‚</li>
<li><strong>åŸç†ï¼š</strong> å½“ <span class="math inline"><em>N</em>â€„=â€„2</span> æ—¶ï¼Œç§°ä¸º Bi-gramï¼Œä¾‹å¦‚å¥å­ â€œæˆ‘
çˆ± NLPâ€
ä¼šè¢«çœ‹ä½œä¸‰ä¸ªå•å…ƒï¼š<code>æˆ‘</code>ã€<code>çˆ±</code>ã€<code>NLP</code>ã€<code>æˆ‘ çˆ±</code>ã€<code>çˆ± NLP</code>ã€‚å®ƒéƒ¨åˆ†åœ°ä¿ç•™äº†å±€éƒ¨è¯åºä¿¡æ¯ã€‚</li>
</ul>
<p>ä¾‹å¦‚ç¬¬ä¸€ä¸ªæ–‡æ¡£ä¸ºï¼šâ€œæˆ‘ çˆ± è‡ªç„¶ è¯­è¨€ å¤„ç†â€ï¼Œé‚£å…¶å¯¹åº”çš„è¯è¡¨å¦‚ä¸‹</p>
<table>
<thead>
<tr>
<th>n</th>
<th>n-gram ç¤ºä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>æˆ‘, çˆ±, è‡ªç„¶, è¯­è¨€, å¤„ç†</td>
</tr>
<tr>
<td>2</td>
<td>æˆ‘çˆ±, çˆ±è‡ªç„¶, è‡ªç„¶è¯­è¨€, è¯­è¨€å¤„ç†</td>
</tr>
<tr>
<td>3</td>
<td>æˆ‘çˆ±è‡ªç„¶, çˆ±è‡ªç„¶è¯­è¨€, è‡ªç„¶è¯­è¨€å¤„ç†</td>
</tr>
</tbody>
</table>
<p>å‡è®¾ç¬¬äºŒä¸ªæ–‡æ¡£æ˜¯ï¼šâ€œæˆ‘ çˆ± æœºå™¨ å­¦ä¹ â€</p>
<p>å®ƒçš„ bigram ç‰¹å¾ä¸ºï¼š<span class="math inline">æˆ‘çˆ±,â€†çˆ±æœºå™¨,â€†æœºå™¨å­¦ä¹ </span></p>
<p>åˆå¹¶æ•´ä¸ªè¯­æ–™çš„ 2-gram è¯è¡¨ï¼š<span class="math inline"><em>V</em>â€„=â€„æˆ‘çˆ±,â€†çˆ±è‡ªç„¶,â€†è‡ªç„¶è¯­è¨€,â€†è¯­è¨€å¤„ç†,â€†çˆ±æœºå™¨,â€†æœºå™¨å­¦ä¹ </span></p>
<p>å¯¹åº”çš„ BoW çŸ©é˜µä¸ºï¼š</p>
<table style="width:100%;">
<colgroup>
<col style="width: 45%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 10%">
</colgroup>
<thead>
<tr>
<th>doc</th>
<th>æˆ‘çˆ±</th>
<th>çˆ±è‡ªç„¶</th>
<th>è‡ªç„¶è¯­è¨€</th>
<th>è¯­è¨€å¤„ç†</th>
<th>çˆ±æœºå™¨</th>
<th>æœºå™¨å­¦ä¹ </th>
</tr>
</thead>
<tbody>
<tr>
<td>doc1 (â€œæˆ‘çˆ±è‡ªç„¶è¯­è¨€å¤„ç†â€)</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>doc2 (â€œæˆ‘çˆ±æœºå™¨å­¦ä¹ â€)</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>
<h4 id="tf-idf">2.3 TF-IDF</h4>
<p>BoW
åªçœ‹è¯é¢‘ï¼Œä¸è€ƒè™‘è¯çš„é‡è¦æ€§ã€‚ä¸€äº›é«˜é¢‘çš„åŠŸèƒ½è¯ï¼ˆå¦‚â€œæˆ‘â€â€œæ˜¯â€â€œçš„â€ï¼‰åœ¨å‡ ä¹æ‰€æœ‰æ–‡æ¡£ä¸­éƒ½ä¼šå‡ºç°ï¼Œä½†å®ƒä»¬<strong>å¹¶ä¸èƒ½åŒºåˆ†è¯­ä¹‰</strong>ã€‚BoW
å› æ­¤ä¼šè®©æ— ä¿¡æ¯çš„å¸¸è§è¯å æ®è¾ƒå¤§æƒé‡ï¼Œå¯¼è‡´æ–‡æœ¬ç›¸ä¼¼åº¦è®¡ç®—æˆ–åˆ†ç±»æ€§èƒ½ä¸‹é™ã€‚</p>
<p>TF-IDFä¸­æ¯ä¸ªæ–‡æ¡£è¢«è¡¨ç¤ºä¸ºä¸€ä¸ªå‘é‡ï¼Œå…¶æ¯ä¸€ç»´å¯¹åº”è¯­æ–™åº“ä¸­çš„ä¸€ä¸ªè¯ï¼Œå€¼ä¸ºè¯¥è¯åœ¨è¯¥æ–‡æ¡£ä¸­çš„
TF-IDF æƒé‡ã€‚</p>
<ul>
<li><strong>æ€æƒ³ï¼š</strong> æå‡ BoW
æ¨¡å‹ä¸­å¯¹è¯è¯­é‡è¦æ€§çš„åˆ¤æ–­ã€‚ä¸€ä¸ªè¯çš„é‡è¦æ€§ä¸å®ƒåœ¨æ–‡æ¡£ä¸­å‡ºç°çš„é¢‘ç‡æˆ<strong>æ­£æ¯”</strong>ï¼ˆ<span class="math inline"><em>T</em><em>F</em></span>ï¼‰ï¼Œä¸å®ƒåœ¨æ•´ä¸ªè¯­æ–™åº“ä¸­å‡ºç°çš„é¢‘ç‡æˆ<strong>åæ¯”</strong>ï¼ˆ<span class="math inline"><em>I</em><em>D</em><em>F</em></span>ï¼‰ã€‚</li>
<li><strong>åŸç†ï¼š</strong>
<ul>
<li><strong>è¯é¢‘ (TF)ï¼š</strong> <span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -1.158ex;" xmlns="http://www.w3.org/2000/svg" width="28.623ex" height="3.447ex" role="img" focusable="false" viewBox="0 -1011.8 12651.5 1523.5"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mi" transform="translate(704,0)"><path data-c="1D439" d="M48 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H742Q749 676 749 669Q749 664 736 557T722 447Q720 440 702 440H690Q683 445 683 453Q683 454 686 477T689 530Q689 560 682 579T663 610T626 626T575 633T503 634H480Q398 633 393 631Q388 629 386 623Q385 622 352 492L320 363H375Q378 363 398 363T426 364T448 367T472 374T489 386Q502 398 511 419T524 457T529 475Q532 480 548 480H560Q567 475 567 470Q567 467 536 339T502 207Q500 200 482 200H470Q463 206 463 212Q463 215 468 234T473 274Q473 303 453 310T364 317H309L277 190Q245 66 245 60Q245 46 334 46H359Q365 40 365 39T363 19Q359 6 353 0H336Q295 2 185 2Q120 2 86 2T48 1Z"></path></g><g data-mml-node="mo" transform="translate(1453,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1842,0)"><path data-c="1D464" d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z"></path></g><g data-mml-node="mo" transform="translate(2558,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(3224.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mfrac" transform="translate(4280.6,0)"><g data-mml-node="mrow" transform="translate(220,481.4) scale(0.707)"><g data-mml-node="mtext"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">è¯</text><path data-c="A0" d="" transform="translate(1000,0)"></path></g><g data-mml-node="mi" transform="translate(1250,0)"><path data-c="1D464" d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z"></path></g><g data-mml-node="mtext" transform="translate(1966,0)"><path data-c="A0" d=""></path><text data-variant="normal" transform="translate(250,0) scale(1,-1)" font-size="884px" font-family="serif">åœ¨</text><text data-variant="normal" transform="translate(1250,0) scale(1,-1)" font-size="884px" font-family="serif">æ–‡</text><text data-variant="normal" transform="translate(2250,0) scale(1,-1)" font-size="884px" font-family="serif">æ¡£</text><text data-variant="normal" transform="translate(3250,0) scale(1,-1)" font-size="884px" font-family="serif">ä¸­</text><text data-variant="normal" transform="translate(4250,0) scale(1,-1)" font-size="884px" font-family="serif">å‡º</text><text data-variant="normal" transform="translate(5250,0) scale(1,-1)" font-size="884px" font-family="serif">ç°</text><text data-variant="normal" transform="translate(6250,0) scale(1,-1)" font-size="884px" font-family="serif">çš„</text><text data-variant="normal" transform="translate(7250,0) scale(1,-1)" font-size="884px" font-family="serif">æ¬¡</text><text data-variant="normal" transform="translate(8250,0) scale(1,-1)" font-size="884px" font-family="serif">æ•°</text></g></g><g data-mml-node="mtext" transform="translate(2417.7,-370.3) scale(0.707)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">æ–‡</text><text data-variant="normal" transform="translate(1000,0) scale(1,-1)" font-size="884px" font-family="serif">æ¡£</text><text data-variant="normal" transform="translate(2000,0) scale(1,-1)" font-size="884px" font-family="serif">æ€»</text><text data-variant="normal" transform="translate(3000,0) scale(1,-1)" font-size="884px" font-family="serif">è¯</text><text data-variant="normal" transform="translate(4000,0) scale(1,-1)" font-size="884px" font-family="serif">æ•°</text></g><rect width="8130.9" height="60" x="120" y="220"></rect></g></g></g></svg></mjx-container></span></li>
<li><strong>é€†æ–‡æ¡£é¢‘ç‡ (IDF)ï¼š</strong> <span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -1.469ex;" xmlns="http://www.w3.org/2000/svg" width="33.259ex" height="4.07ex" role="img" focusable="false" viewBox="0 -1149.5 14700.5 1799"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D43C" d="M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z"></path></g><g data-mml-node="mi" transform="translate(504,0)"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mi" transform="translate(1332,0)"><path data-c="1D439" d="M48 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H742Q749 676 749 669Q749 664 736 557T722 447Q720 440 702 440H690Q683 445 683 453Q683 454 686 477T689 530Q689 560 682 579T663 610T626 626T575 633T503 634H480Q398 633 393 631Q388 629 386 623Q385 622 352 492L320 363H375Q378 363 398 363T426 364T448 367T472 374T489 386Q502 398 511 419T524 457T529 475Q532 480 548 480H560Q567 475 567 470Q567 467 536 339T502 207Q500 200 482 200H470Q463 206 463 212Q463 215 468 234T473 274Q473 303 453 310T364 317H309L277 190Q245 66 245 60Q245 46 334 46H359Q365 40 365 39T363 19Q359 6 353 0H336Q295 2 185 2Q120 2 86 2T48 1Z"></path></g><g data-mml-node="mo" transform="translate(2081,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(2470,0)"><path data-c="1D464" d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z"></path></g><g data-mml-node="mo" transform="translate(3186,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(3852.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(4908.6,0)"><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z"></path><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" transform="translate(278,0)"></path><path data-c="67" d="M329 409Q373 453 429 453Q459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390Q410 404 415 411Q415 412 416 414V415Q388 412 363 393Q355 388 355 386Q355 385 359 381T368 369T379 351T388 325T392 292Q392 230 343 187T222 143Q172 143 123 171Q112 153 112 133Q112 98 138 81Q147 75 155 75T227 73Q311 72 335 67Q396 58 431 26Q470 -13 470 -72Q470 -139 392 -175Q332 -206 250 -206Q167 -206 107 -175Q29 -140 29 -75Q29 -39 50 -15T92 18L103 24Q67 55 67 108Q67 155 96 193Q52 237 52 292Q52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292Q142 248 149 227T179 192Q196 182 222 182Q244 182 260 189T283 207T294 227T299 242Q302 258 302 292T299 343ZM403 -75Q403 -50 389 -34T348 -11T299 -2T245 0H218Q151 0 138 -6Q118 -15 107 -34T95 -74Q95 -84 101 -97T122 -127T170 -155T250 -167Q319 -167 361 -139T403 -75Z" transform="translate(778,0)"></path></g><g data-mml-node="mo" transform="translate(6186.6,0)"><path data-c="2061" d=""></path></g><g data-mml-node="mrow" transform="translate(6353.2,0)"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="28" d="M180 96T180 250T205 541T266 770T353 944T444 1069T527 1150H555Q561 1144 561 1141Q561 1137 545 1120T504 1072T447 995T386 878T330 721T288 513T272 251Q272 133 280 56Q293 -87 326 -209T399 -405T475 -531T536 -609T561 -640Q561 -643 555 -649H527Q483 -612 443 -568T353 -443T266 -270T205 -41Z"></path></g><g data-mml-node="mfrac" transform="translate(597,0)"><g data-mml-node="mtext" transform="translate(2162.4,481.4) scale(0.707)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">æ–‡</text><text data-variant="normal" transform="translate(1000,0) scale(1,-1)" font-size="884px" font-family="serif">æ¡£</text><text data-variant="normal" transform="translate(2000,0) scale(1,-1)" font-size="884px" font-family="serif">æ€»</text><text data-variant="normal" transform="translate(3000,0) scale(1,-1)" font-size="884px" font-family="serif">æ•°</text></g><g data-mml-node="mrow" transform="translate(220,-370.3) scale(0.707)"><g data-mml-node="mtext"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">åŒ…</text><text data-variant="normal" transform="translate(1000,0) scale(1,-1)" font-size="884px" font-family="serif">å«</text><text data-variant="normal" transform="translate(2000,0) scale(1,-1)" font-size="884px" font-family="serif">è¯</text><path data-c="A0" d="" transform="translate(3000,0)"></path></g><g data-mml-node="mi" transform="translate(3250,0)"><path data-c="1D464" d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z"></path></g><g data-mml-node="mtext" transform="translate(3966,0)"><path data-c="A0" d=""></path><text data-variant="normal" transform="translate(250,0) scale(1,-1)" font-size="884px" font-family="serif">çš„</text><text data-variant="normal" transform="translate(1250,0) scale(1,-1)" font-size="884px" font-family="serif">æ–‡</text><text data-variant="normal" transform="translate(2250,0) scale(1,-1)" font-size="884px" font-family="serif">æ¡£</text><text data-variant="normal" transform="translate(3250,0) scale(1,-1)" font-size="884px" font-family="serif">æ•°</text></g><g data-mml-node="mo" transform="translate(8216,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mn" transform="translate(8994,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g><rect width="6913.3" height="60" x="120" y="220"></rect></g><g data-mml-node="mo" transform="translate(7750.3,0) translate(0 -0.5)"><path data-c="29" d="M35 1138Q35 1150 51 1150H56H69Q113 1113 153 1069T243 944T330 771T391 541T416 250T391 -40T330 -270T243 -443T152 -568T69 -649H56Q43 -649 39 -647T35 -637Q65 -607 110 -548Q283 -316 316 56Q324 133 324 251Q324 368 316 445Q278 877 48 1123Q36 1137 35 1138Z"></path></g></g></g></g></svg></mjx-container></span></li>
<li><strong>TF-IDFï¼š</strong> <span class="math inline"><em>T</em><em>F</em><em>I</em><em>D</em><em>F</em>(<em>w</em>)â€„=â€„<em>T</em><em>F</em>(<em>w</em>)â€…Ã—â€…<em>I</em><em>D</em><em>F</em>(<em>w</em>)</span></li>
<li>é«˜ <span class="math inline"><em>T</em><em>F</em></span> ä¸”é«˜ <span class="math inline"><em>I</em><em>D</em><em>F</em></span>
çš„è¯ï¼ˆå³åœ¨å½“å‰æ–‡æ¡£å¸¸å‡ºç°ï¼Œä½†åœ¨å…¶ä»–æ–‡æ¡£å°‘å‡ºç°ï¼‰è¢«è®¤ä¸ºæ˜¯æœ€å…·åŒºåˆ†åº¦çš„å…³é”®è¯ã€‚</li>
</ul></li>
</ul>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>ç®€å•æœ‰æ•ˆï¼Œä¸éœ€è¦è¯­ä¹‰æ¨¡å‹ï¼Œä¹Ÿèƒ½å¾ˆå¥½åŒºåˆ†æ–‡æ¡£ç‰¹å¾</li>
<li>æŠ‘åˆ¶æ— ç”¨è¯ï¼Œè‡ªåŠ¨é™ä½â€œæˆ‘â€â€œæ˜¯â€â€œçš„â€ç­‰åœç”¨è¯çš„æƒé‡</li>
</ul>
<p>ç¼ºç‚¹<strong>ï¼ˆä¹Ÿæ˜¯BoWå’Œn-gramçš„ç¼ºç‚¹ï¼‰</strong>ï¼š</p>
<ul>
<li>æ— æ³•æ•æ‰è¯­åºï¼šâ€œè¯­è¨€ è‡ªç„¶â€ä¸â€œè‡ªç„¶ è¯­è¨€â€åŒæ ·å¤„ç†</li>
<li>å¿½ç•¥è¯ä¹‰ç›¸ä¼¼ï¼šâ€œå­¦ä¹ â€ä¸â€œç ”ç©¶â€è§†ä¸ºå®Œå…¨ä¸åŒ</li>
<li>é™æ€æƒé‡ï¼šä¸èƒ½æ ¹æ®ä¸Šä¸‹æ–‡åŠ¨æ€è°ƒæ•´ï¼Œå³ä¸€ä¸ªè¯åœ¨ä¸åŒä¸Šä¸‹æ–‡é‡Œè¡¨è¾¾çš„æ„æ€å¯èƒ½æ˜¯å®Œå…¨ä¸åŒçš„</li>
<li>ç¨€ç–é«˜ç»´ï¼šå¤§è¯­æ–™ä¸‹å‘é‡ç»´åº¦æå¤§ï¼Œè®¡ç®—è€—æ—¶é«˜</li>
</ul>
<h3 id="ç¤ºä¾‹scikit-learn-å®ç°-bow-n-gram-tf-idf">ğŸ’» ç¤ºä¾‹ï¼ˆScikit-learn
å®ç° BoW, N-gram, TF-IDFï¼‰</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.feature_extraction.text <span class="keyword">import</span> CountVectorizer, TfidfVectorizer</span><br><span class="line"><span class="keyword">import</span> jieba</span><br><span class="line"></span><br><span class="line">documents = [</span><br><span class="line">    <span class="string">"The quick brown fox jumps over the lazy dog."</span>,</span><br><span class="line">    <span class="string">"A quick brown fox is better than a lazy dog."</span>,</span><br><span class="line">    <span class="string">"The lowest lower technologies are amazing and counterproductive."</span>,</span><br><span class="line">    <span class="string">"æˆ‘çˆ±è‡ªç„¶è¯­è¨€å¤„ç†ï¼Œå¹¶ä¸”æ˜å¤©æ—©ä¸Šåƒä»€ä¹ˆï¼Ÿ æˆ‘çˆ±åƒæ‡æ·ï¼"</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"--- åŸå§‹æ–‡æ¡£ ---"</span>)</span><br><span class="line"><span class="keyword">for</span> doc <span class="keyword">in</span> documents:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"- <span class="subst">{doc}</span>"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. BoW (è¯è¢‹æ¨¡å‹)</span></span><br><span class="line"><span class="comment"># token_pattern ä¿æŒäº†å•è¯ä¹‹é—´çš„ç©ºæ ¼</span></span><br><span class="line">count_vectorizer = CountVectorizer(token_pattern=<span class="string">r'(?u)\b\w\w+\b'</span>)</span><br><span class="line">X_bow = count_vectorizer.fit_transform(documents)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"\n--- 1. BoW è¯é¢‘çŸ©é˜µ (CountVectorizer) ---"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"è¯æ±‡è¡¨:"</span>, count_vectorizer.get_feature_names_out())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Doc å‘é‡è¡¨ç¤º:"</span>)</span><br><span class="line"><span class="built_in">print</span>(X_bow.toarray())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. N-gram (ä½¿ç”¨ Bi-gram, å³ n-gram=2)</span></span><br><span class="line">ngram_vectorizer = CountVectorizer(ngram_range=(<span class="number">2</span>, <span class="number">2</span>))</span><br><span class="line">X_ngram = ngram_vectorizer.fit_transform(documents)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"\n--- 2. N-gram (Bi-gram) è¯æ±‡è¡¨ ---"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"è¯æ±‡è¡¨:"</span>, ngram_vectorizer.get_feature_names_out())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Doc å‘é‡è¡¨ç¤º:"</span>)</span><br><span class="line"><span class="built_in">print</span>(X_ngram.toarray())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. TF-IDF</span></span><br><span class="line">tfidf_vectorizer = TfidfVectorizer()</span><br><span class="line">X_tfidf = tfidf_vectorizer.fit_transform(documents)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"\n--- 3. TF-IDF çŸ©é˜µ ---"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"è¯æ±‡è¡¨:"</span>, tfidf_vectorizer.get_feature_names_out())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Doc å‘é‡è¡¨ç¤º:"</span>)</span><br><span class="line"><span class="built_in">print</span>(X_tfidf.toarray())</span><br><span class="line">feature_names = tfidf_vectorizer.get_feature_names_out()</span><br><span class="line"><span class="keyword">for</span> idx, doc_vec <span class="keyword">in</span> <span class="built_in">enumerate</span>(X_tfidf.toarray()):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"\n--- æ–‡æ¡£ <span class="subst">{idx}</span> çš„ TF-IDF ç‰¹å¾ ---"</span>)</span><br><span class="line">    <span class="comment"># åªæ‰“å°éé›¶çš„ (value, word)</span></span><br><span class="line">    <span class="keyword">for</span> value, word <span class="keyword">in</span> <span class="built_in">sorted</span>(<span class="built_in">zip</span>(doc_vec, feature_names), reverse=<span class="literal">True</span>):</span><br><span class="line">        <span class="keyword">if</span> value &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f"(<span class="subst">{value:<span class="number">.4</span>f}</span>, '<span class="subst">{word}</span>')"</span>)</span><br></pre></td></tr></table></figure>
<h4 id="bowè¡¨ç¤ºç»“æœ">BoWè¡¨ç¤ºç»“æœ</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">--- 1. BoW è¯é¢‘çŸ©é˜µ (CountVectorizer) ---</span><br><span class="line">è¯æ±‡è¡¨: ['amazing' 'and' 'are' 'better' 'brown' 'counterproductive' 'dog' 'fox'</span><br><span class="line"> 'is' 'jumps' 'lazy' 'lower' 'lowest' 'over' 'quick' 'technologies' 'than'</span><br><span class="line"> 'the' 'å¹¶ä¸”æ˜å¤©æ—©ä¸Šåƒä»€ä¹ˆ' 'æˆ‘çˆ±åƒæ‡æ·' 'æˆ‘çˆ±è‡ªç„¶è¯­è¨€å¤„ç†']</span><br><span class="line">Doc å‘é‡è¡¨ç¤º:</span><br><span class="line">[[0 0 0 0 1 0 1 1 0 1 1 0 0 1 1 0 0 2 0 0 0]</span><br><span class="line"> [0 0 0 1 1 0 1 1 1 0 1 0 0 0 1 0 1 0 0 0 0]</span><br><span class="line"> [1 1 1 0 0 1 0 0 0 0 0 1 1 0 0 1 0 1 0 0 0]</span><br><span class="line"> [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1]]</span><br></pre></td></tr></table></figure>
<p>å°±æ˜¯ç»Ÿè®¡æ¯ä¸ªDocä¸­å„ä¸ªå‡ºç°åœ¨è¯è¡¨é‡Œçš„å•è¯çš„é¢‘ç‡ã€‚</p>
<p>ä¾‹å¦‚ç¬¬ä¸€å¥è¯ â€œThe quick brown fox jumps over the lazy
dog.â€ä¸­ï¼Œå•è¯â€Theâ€å‡ºç°2æ¬¡ï¼Œäºæ˜¯è®¡ç®—å‡ºçš„è¡¨ç¤ºå‘é‡ä¸­å€’æ•°ç¬¬å››ä¸ªå€¼å°±æ˜¯2ã€‚</p>
<blockquote>
<p>token_pattern=râ€™(?u)+</p>
<p>è¡¨ç¤ºåˆ†è¯çš„æ–¹æ³•ï¼Œæ ¹æ®æ­£åˆ™è¡¨è¾¾å¼ æ¥åˆ‡ tokenï¼š(?u)è¡¨ç¤ºä½¿ç”¨ Unicode
å­—ç¬¦è§„åˆ™ï¼Œï¼Œ+è¡¨ç¤ºåŒ¹é…è‡³å°‘2ä¸ªå­—æ¯/æ•°å­—/ä¸‹åˆ’çº¿ã€‚ï¼ˆ<strong>å³ä¸åŒ…æ‹¬ä»»ä½•æ ‡ç‚¹ç¬¦å·å’Œç©ºæ ¼</strong>ï¼‰</p>
<p>ä½ ä¹Ÿå¯ä»¥æ›¿æ¢æˆå…¶ä»–æ¯”è¾ƒæˆç†Ÿçš„åˆ†è¯æ–¹æ³•ï¼Œåˆ©ç”¨<em>tokenizer</em>å‚æ•°</p>
<p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">count_vectorizer = CountVectorizer(tokenizer=<span class="built_in">list</span>)</span><br></pre></td></tr></table></figure></p>
<p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">è¯æ±‡è¡¨: [' ' '.' 'a' 'b' 'c' 'd' 'e' 'f' 'g' 'h' 'i' 'j' 'k' 'l' 'm' 'n' 'o' 'p'</span><br><span class="line"> 'q' 'r' 's' 't' 'u' 'v' 'w' 'x' 'y' 'z' 'ä¸Š' 'ä¸”' 'ä¹ˆ' 'ä»€' 'åƒ' 'å¤„' 'å¤©' 'å¹¶'</span><br><span class="line"> 'æˆ‘' 'æ—©' 'æ˜' 'æ·' 'æ‡' 'ç„¶' 'çˆ±' 'ç†' 'è‡ª' 'è¨€' 'è¯­' 'ï¼' 'ï¼Œ' 'ï¼Ÿ']</span><br><span class="line">Doc å‘é‡è¡¨ç¤º:</span><br><span class="line">[[8 1 1 1 1 1 3 1 1 2 1 1 1 1 1 1 4 1 1 2 1 2 2 1 1 1 1 1 0 0 0 0 0 0 0 0</span><br><span class="line">  0 0 0 0 0 0 0 0 0 0 0 0 0 0]</span><br><span class="line"> [9 1 4 2 1 1 2 1 1 1 2 0 1 1 0 2 3 0 1 2 1 3 1 0 1 1 1 1 0 0 0 0 0 0 0 0</span><br><span class="line">  0 0 0 0 0 0 0 0 0 0 0 0 0 0]</span><br><span class="line"> [7 1 4 0 3 2 8 0 2 2 3 0 0 3 1 4 6 1 0 4 2 5 2 1 2 0 0 1 0 0 0 0 0 0 0 0</span><br><span class="line">  0 0 0 0 0 0 0 0 0 0 0 0 0 0]</span><br><span class="line"> [1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 2 1 1 1</span><br><span class="line">  2 1 1 1 1 1 2 1 1 1 1 1 1 1]]</span><br></pre></td></tr></table></figure></p>
<p><code>tokenizer=list</code>æ„æ€æ˜¯æŒ‰ç…§æ‰€æœ‰å­—ç¬¦åˆ‡åˆ†ï¼Œæ‰€ä»¥è¯è¡¨å°±æ˜¯æ‰€æœ‰Docä¸­å‡ºç°è¿‡çš„å­—ç¬¦</p>
</blockquote>
<h4 id="n-gramè¡¨ç¤ºç»“æœ">n-gramè¡¨ç¤ºç»“æœ</h4>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">--- <span class="number">2.</span> N-<span class="built_in">gram</span> (Bi-gram) è¯æ±‡è¡¨ ---</span><br><span class="line">è¯æ±‡è¡¨: [<span class="string">'amazing and'</span> <span class="string">'and counterproductive'</span> <span class="string">'are amazing'</span> <span class="string">'better than'</span></span><br><span class="line"> <span class="string">'brown fox'</span> <span class="string">'fox is'</span> <span class="string">'fox jumps'</span> <span class="string">'is better'</span> <span class="string">'jumps over'</span> <span class="string">'lazy dog'</span></span><br><span class="line"> <span class="string">'lower technologies'</span> <span class="string">'lowest lower'</span> <span class="string">'over the'</span> <span class="string">'quick brown'</span></span><br><span class="line"> <span class="string">'technologies are'</span> <span class="string">'than lazy'</span> <span class="string">'the lazy'</span> <span class="string">'the lowest'</span> <span class="string">'the quick'</span></span><br><span class="line"> <span class="string">'å¹¶ä¸”æ˜å¤©æ—©ä¸Šåƒä»€ä¹ˆ æˆ‘çˆ±åƒæ‡æ·'</span> <span class="string">'æˆ‘çˆ±è‡ªç„¶è¯­è¨€å¤„ç† å¹¶ä¸”æ˜å¤©æ—©ä¸Šåƒä»€ä¹ˆ'</span>]</span><br><span class="line">Doc å‘é‡è¡¨ç¤º:</span><br><span class="line">[[<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span>]</span><br><span class="line"> [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>]</span><br><span class="line"> [<span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>]</span><br><span class="line"> [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span>]]</span><br></pre></td></tr></table></figure>
<p>å› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ngram_range=(2,
2)ï¼Œå³å°†ç›¸é‚»çš„ä¸¤ä¸ªè¯ä½œä¸ºä¸€ä¸ªTokenè¿›è¡Œå¤„ç†ï¼Œæ‰€ä»¥è¯è¡¨ä¸­éƒ½æ˜¯ä¸¤ä¸ªå•è¯ç»„åˆï¼ˆä¸­æ–‡é»˜è®¤æ˜¯ä¸¤ä¸ªå­å¥ç»„åˆï¼Œå› ä¸ºåœ¨å¤§éƒ¨åˆ†åˆ†è¯å™¨ä¸­ï¼Œå¯¹ä¸­æ–‡æ²¡æœ‰ç»†ç²’åº¦çš„åˆ†è¯è€ƒè™‘ï¼‰</p>
<h4 id="tf-idfè¡¨ç¤ºç»“æœ">TF-IDFè¡¨ç¤ºç»“æœ</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">è¯æ±‡è¡¨: ['amazing' 'and' 'are' 'better' 'brown' 'counterproductive' 'dog' 'fox'</span><br><span class="line"> 'is' 'jumps' 'lazy' 'lower' 'lowest' 'over' 'quick' 'technologies' 'than'</span><br><span class="line"> 'the' 'å¹¶ä¸”æ˜å¤©æ—©ä¸Šåƒä»€ä¹ˆ' 'æˆ‘çˆ±åƒæ‡æ·' 'æˆ‘çˆ±è‡ªç„¶è¯­è¨€å¤„ç†']</span><br><span class="line">Doc å‘é‡è¡¨ç¤º:</span><br><span class="line">[[0.         0.         0.         0.         0.28609357 0.</span><br><span class="line">  0.28609357 0.28609357 0.         0.36287342 0.28609357 0.</span><br><span class="line">  0.         0.36287342 0.28609357 0.         0.         0.57218714</span><br><span class="line">  0.         0.         0.        ]</span><br><span class="line"> [0.         0.         0.         0.40462414 0.31901032 0.</span><br><span class="line">  0.31901032 0.31901032 0.40462414 0.         0.31901032 0.</span><br><span class="line">  0.         0.         0.31901032 0.         0.40462414 0.</span><br><span class="line">  0.         0.         0.        ]</span><br><span class="line"> [0.36222393 0.36222393 0.36222393 0.         0.         0.36222393</span><br><span class="line">  0.         0.         0.         0.         0.         0.36222393</span><br><span class="line">  0.36222393 0.         0.         0.36222393 0.         0.2855815</span><br><span class="line">  0.         0.         0.        ]</span><br><span class="line"> [0.         0.         0.         0.         0.         0.</span><br><span class="line">  0.         0.         0.         0.         0.         0.</span><br><span class="line">  0.         0.         0.         0.         0.         0.</span><br><span class="line">  0.57735027 0.57735027 0.57735027]]</span><br><span class="line"></span><br><span class="line">--- æ–‡æ¡£ 0 çš„ TF-IDF ç‰¹å¾ ---</span><br><span class="line">(0.5722, 'the')</span><br><span class="line">(0.3629, 'over')</span><br><span class="line">(0.3629, 'jumps')</span><br><span class="line">(0.2861, 'quick')</span><br><span class="line">(0.2861, 'lazy')</span><br><span class="line">(0.2861, 'fox')</span><br><span class="line">(0.2861, 'dog')</span><br><span class="line">(0.2861, 'brown')</span><br><span class="line"></span><br><span class="line">--- æ–‡æ¡£ 1 çš„ TF-IDF ç‰¹å¾ ---</span><br><span class="line">(0.4046, 'than')</span><br><span class="line">(0.4046, 'is')</span><br><span class="line">(0.4046, 'better')</span><br><span class="line">(0.3190, 'quick')</span><br><span class="line">(0.3190, 'lazy')</span><br><span class="line">(0.3190, 'fox')</span><br><span class="line">(0.3190, 'dog')</span><br><span class="line">(0.3190, 'brown')</span><br><span class="line"></span><br><span class="line">--- æ–‡æ¡£ 2 çš„ TF-IDF ç‰¹å¾ ---</span><br><span class="line">(0.3622, 'technologies')</span><br><span class="line">(0.3622, 'lowest')</span><br><span class="line">(0.3622, 'lower')</span><br><span class="line">(0.3622, 'counterproductive')</span><br><span class="line">(0.3622, 'are')</span><br><span class="line">(0.3622, 'and')</span><br><span class="line">(0.3622, 'amazing')</span><br><span class="line">(0.2856, 'the')</span><br><span class="line"></span><br><span class="line">--- æ–‡æ¡£ 3 çš„ TF-IDF ç‰¹å¾ ---</span><br><span class="line">(0.5774, 'æˆ‘çˆ±è‡ªç„¶è¯­è¨€å¤„ç†')</span><br><span class="line">(0.5774, 'æˆ‘çˆ±åƒæ‡æ·')</span><br><span class="line">(0.5774, 'å¹¶ä¸”æ˜å¤©æ—©ä¸Šåƒä»€ä¹ˆ')</span><br></pre></td></tr></table></figure>
<p>TF-IDFæ˜¯åˆ©ç”¨TF-IDFæŒ‡æ ‡è¿›è¡Œè¡¨ç¤ºçš„ï¼Œæ‰€ä»¥å‘é‡é‡Œçš„æ•°å€¼ä¸å†æ˜¯æ•´æ•°äº†ã€‚</p>
<p>å¯ä»¥ä»”ç»†çœ‹ä¸€ä¸‹æ–‡æ¡£ 2 çš„ TF-IDF
ç‰¹å¾ï¼Œé™¤äº†å•è¯â€Theâ€ï¼Œå…¶ä»–è¯çš„TF-IDFæ•°å€¼éƒ½ä¸€æ ·ã€‚è¿™æ˜¯å› ä¸ºæ‰€æœ‰è¯åœ¨Doc2ä¸­éƒ½å‡ºç°äº†ä¸€æ¬¡ï¼Œå³TF=1ï¼›ä½†å¯¹äºå…¶ä»–å•è¯ï¼Œåœ¨è¯­æ–™ä¸­å…¶ä»–Docä¸­éƒ½æ²¡æœ‰å‡ºç°è¿‡ï¼Œåªæœ‰â€Theâ€é™¤å¤–ï¼Œæ‰€ä»¥å…¶å¯¹åº”çš„IDFå°±å°ï¼Œæ„æ€æ˜¯â€Theâ€è¿™ä¸ªè¯æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„è¯ï¼Œè¯­ä¹‰åœ¨è¿™ä¸ªæ–‡æ¡£é‡Œä¸æ˜¯å¾ˆé‡è¦ã€‚</p>
<blockquote>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶ä»–å¯¹ä¸­æ–‡æ¯”è¾ƒå‹å¥½çš„åˆ†è¯å™¨çœ‹çœ‹æ•ˆæœï¼š<code>tfidf_vectorizer = TfidfVectorizer(*tokenizer*=jieba.lcut)</code></p>
<p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">--- 3. TF-IDF çŸ©é˜µ ---</span><br><span class="line">è¯æ±‡è¡¨: [' ' '.' 'a' 'amazing' 'and' 'are' 'better' 'brown' 'counterproductive'</span><br><span class="line"> 'dog' 'fox' 'is' 'jumps' 'lazy' 'lower' 'lowest' 'over' 'quick'</span><br><span class="line"> 'technologies' 'than' 'the' 'ä»€ä¹ˆ' 'åƒ' 'å¤„ç†' 'å¹¶ä¸”' 'æˆ‘' 'æ—©ä¸Š' 'æ˜å¤©' 'æ‡æ·' 'çˆ±'</span><br><span class="line"> 'è‡ªç„¶è¯­è¨€' 'ï¼' 'ï¼Œ' 'ï¼Ÿ']</span><br><span class="line"></span><br><span class="line">--- æ–‡æ¡£ 0 çš„ TF-IDF ç‰¹å¾ ---</span><br><span class="line">(0.8279, ' ')</span><br><span class="line">(0.3127, 'the')</span><br><span class="line">(0.1983, 'over')</span><br><span class="line">(0.1983, 'jumps')</span><br><span class="line">(0.1563, 'quick')</span><br><span class="line">(0.1563, 'lazy')</span><br><span class="line">(0.1563, 'fox')</span><br><span class="line">(0.1563, 'dog')</span><br><span class="line">(0.1563, 'brown')</span><br><span class="line">(0.1266, '.')</span><br><span class="line"></span><br><span class="line">--- æ–‡æ¡£ 1 çš„ TF-IDF ç‰¹å¾ ---</span><br><span class="line">(0.8229, ' ')</span><br><span class="line">(0.3504, 'a')</span><br><span class="line">(0.1752, 'than')</span><br><span class="line">(0.1752, 'is')</span><br><span class="line">(0.1752, 'better')</span><br><span class="line">(0.1381, 'quick')</span><br><span class="line">(0.1381, 'lazy')</span><br><span class="line">(0.1381, 'fox')</span><br><span class="line">(0.1381, 'dog')</span><br><span class="line">(0.1381, 'brown')</span><br><span class="line">(0.1118, '.')</span><br><span class="line"></span><br><span class="line">--- æ–‡æ¡£ 2 çš„ TF-IDF ç‰¹å¾ ---</span><br><span class="line">(0.7901, ' ')</span><br><span class="line">(0.2163, 'technologies')</span><br><span class="line">(0.2163, 'lowest')</span><br><span class="line">(0.2163, 'lower')</span><br><span class="line">(0.2163, 'counterproductive')</span><br><span class="line">(0.2163, 'are')</span><br><span class="line">(0.2163, 'and')</span><br><span class="line">(0.2163, 'amazing')</span><br><span class="line">(0.1705, 'the')</span><br><span class="line">(0.1381, '.')</span><br><span class="line"></span><br><span class="line">--- æ–‡æ¡£ 3 çš„ TF-IDF ç‰¹å¾ ---</span><br><span class="line">(0.4238, 'çˆ±')</span><br><span class="line">(0.4238, 'æˆ‘')</span><br><span class="line">(0.4238, 'åƒ')</span><br><span class="line">(0.2119, 'ï¼Ÿ')</span><br><span class="line">(0.2119, 'ï¼Œ')</span><br><span class="line">(0.2119, 'ï¼')</span><br><span class="line">(0.2119, 'è‡ªç„¶è¯­è¨€')</span><br><span class="line">(0.2119, 'æ‡æ·')</span><br><span class="line">(0.2119, 'æ˜å¤©')</span><br><span class="line">(0.2119, 'æ—©ä¸Š')</span><br><span class="line">(0.2119, 'å¹¶ä¸”')</span><br><span class="line">(0.2119, 'å¤„ç†')</span><br><span class="line">(0.2119, 'ä»€ä¹ˆ')</span><br><span class="line">(0.1106, ' ')</span><br></pre></td></tr></table></figure></p>
<p>jiebaåˆ†è¯å™¨é»˜è®¤ä¹Ÿä¼šè€ƒè™‘æ‰€æœ‰æ ‡ç‚¹ç¬¦å·å’Œç©ºæ ¼ï¼Œæ‰€ä»¥è¯è¡¨é‡Œä¹Ÿä¼šæœ‰è¿™äº›å†…å®¹ã€‚</p>
<p>å¹¶ä¸”å¯¹äºä¸­æ–‡åˆ†è¯ä¹Ÿæ›´åŠ åœ°åˆç†ã€‚</p>
</blockquote>
<hr>
<h2 id="è¯å‘é‡word-embedding">3. è¯å‘é‡ï¼ˆWord Embeddingï¼‰</h2>
<h3 id="ä¸»è¦æ€æƒ³ä¸åŸç†-2">ğŸŒˆ ä¸»è¦æ€æƒ³ä¸åŸç†</h3>
<p>BoW/TF-IDF æ˜¯<strong>ç¨€ç–ã€é«˜ç»´ã€æ— è¯­ä¹‰</strong>çš„ï¼›è¯å‘é‡ï¼ˆWord
Embeddingï¼‰æ˜¯<strong>ä½ç»´ã€ç¨ å¯†ã€è¿ç»­</strong>çš„å‘é‡è¡¨ç¤ºæ–¹æ³•</p>
<ul>
<li><strong>æ€æƒ³ï¼š</strong> éµå¾ªâ€œ<strong>åˆ†å¸ƒå‡è¯´ (Distributional
Hypothesis)</strong>â€ï¼Œå³<strong>ä¸Šä¸‹æ–‡ç›¸ä¼¼çš„è¯ï¼Œå®ƒä»¬çš„è¯­ä¹‰ä¹Ÿç›¸ä¼¼</strong>ã€‚é€šè¿‡å¤§è§„æ¨¡è¯­æ–™çš„è®­ç»ƒï¼Œè®©æ¨¡å‹è‡ªåŠ¨å­¦ä¹ è¯è¯­çš„è¯­ä¹‰è¡¨ç¤ºã€‚</li>
<li><strong>åŸç†ï¼š</strong>
<ul>
<li>å°†æ¯ä¸ªè¯æ˜ å°„åˆ°ä¸€ä¸ªå›ºå®šé•¿åº¦çš„å®æ•°å‘é‡ï¼ˆå¦‚ 100 ç»´ã€300 ç»´ï¼‰ã€‚</li>
<li>å‘é‡çš„æ¯ä¸ªç»´åº¦æ²¡æœ‰æ˜ç¡®å«ä¹‰ï¼Œä½†æ•´ä¸ªå‘é‡ç©ºé—´èƒ½å¤Ÿæ•æ‰è¯è¯­ä¹‹é—´çš„è¯­ä¹‰å…³ç³»ã€‚ä¾‹å¦‚ï¼Œåœ¨å‘é‡ç©ºé—´ä¸­ï¼Œ<span class="math inline">vec(å›½ç‹)â€…âˆ’â€…vec(ç”·äºº)â€…+â€…vec(å¥³äºº)â€„â‰ˆâ€„vec(ç‹å)</span>ã€‚</li>
</ul></li>
</ul>
<h4 id="å¸¸è§æ–¹æ³•word2vec">å¸¸è§æ–¹æ³•ï¼šWord2Vec</h4>
<p>Word2Vec æ˜¯æœ€ç»å…¸çš„è¯å‘é‡ç”Ÿæˆæ¨¡å‹ï¼ŒåŒ…å«ä¸¤ç§ç»“æ„ï¼š</p>
<ol type="1">
<li>CBOW (Continuous Bag-of-Words)ï¼š ç”¨ä¸Šä¸‹æ–‡è¯è¯­é¢„æµ‹å½“å‰è¯è¯­ã€‚</li>
<li>Skip-gramï¼š ç”¨å½“å‰è¯è¯­é¢„æµ‹ä¸Šä¸‹æ–‡è¯è¯­ã€‚</li>
</ol>
<blockquote>
<p>è¿™é‡Œå¹¶ä¸è®² Word2Vec æ¨¡å‹çš„åŸç†å’Œå®ç°ï¼Œæƒ³çŸ¥é“çš„è¯»è€…å¯ä»¥è‡ªè¡Œæœç´¢</p>
</blockquote>
<p>Word2Vec å¹¶ä¸æ˜¯ç”¨æ¥ç›´æ¥é¢„æµ‹ä¸‹ä¸€ä¸ªè¯çš„è¯­è¨€æ¨¡å‹ï¼ˆé‚£æ˜¯ GPT
çš„æ–¹å‘ï¼‰ã€‚</p>
<p>å®ƒçš„ç›®æ ‡æ˜¯ï¼š<strong>é€šè¿‡ä¸Šä¸‹æ–‡é¢„æµ‹ä»»åŠ¡ï¼Œå­¦ä¹ ä¸€ä¸ªèƒ½å¤Ÿæ•æ‰è¯­ä¹‰çš„è¯å‘é‡ç©ºé—´ã€‚</strong></p>
<p>æ¢å¥è¯è¯´ï¼š</p>
<ul>
<li>æˆ‘ä»¬å¹¶ä¸å…³å¿ƒé¢„æµ‹ç»“æœæœ¬èº«å¯¹ä¸å¯¹ï¼›</li>
<li>æˆ‘ä»¬å…³å¿ƒçš„æ˜¯ï¼šä¸ºäº†é¢„æµ‹æ­£ç¡®ï¼Œæ¨¡å‹å¿…é¡»æŠŠè¯­ä¹‰ç›¸ä¼¼çš„è¯æ”¾å¾—æ›´è¿‘ï¼›</li>
<li>è€Œæ¨¡å‹å†…éƒ¨<strong>æƒé‡çŸ©é˜µï¼ˆembeddingï¼‰å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„è¯å‘é‡è¡¨ç¤ºï¼ˆword
embeddingsï¼‰</strong>ã€‚</li>
</ul>
<p>å‡è®¾è¯è¡¨å¤§å°ä¸º <span class="math inline"><em>V</em></span>ï¼Œæ¯ä¸ªè¯å¯¹åº”ä¸€ä¸ª one-hot å‘é‡ <span class="math inline"><strong>x</strong>â€„âˆˆâ€„â„<sup><em>V</em></sup></span>ã€‚
æ¨¡å‹å¸Œæœ›é€šè¿‡ä¸€ä¸ªåµŒå…¥çŸ©é˜µ <span class="math inline"><em>W</em>â€„âˆˆâ€„â„<sup><em>V</em>â€…Ã—â€…<em>d</em></sup></span>
æŠŠç¦»æ•£çš„ one-hot å‘é‡å˜æˆç¨ å¯†å‘é‡ï¼š <span class="math display"><strong>v</strong><sub><em>w</em></sub>â€„=â€„<em>W</em><sup><em>T</em></sup><strong>x</strong></span>
ç„¶åæˆ‘ä»¬ç”¨å®ƒå»å®Œæˆä¸€ä¸ªâ€œé¢„æµ‹ä»»åŠ¡â€æ¥è®­ç»ƒ (W)ã€‚</p>
<h5 id="cbow-è®­ç»ƒæ–¹æ³•">CBOW è®­ç»ƒæ–¹æ³•</h5>
<p>å¥å­ï¼šã€Œæˆ‘ çˆ± è‡ªç„¶ è¯­è¨€ å¤„ç†ã€
ç›®æ ‡ä¸­å¿ƒè¯æ˜¯ã€Œè‡ªç„¶ã€ï¼Œçª—å£å¤§å°=2ï¼Œåˆ™ä¸Šä¸‹æ–‡ä¸ºã€Œæˆ‘, çˆ±, è¯­è¨€, å¤„ç†ã€ã€‚
è®­ç»ƒç›®æ ‡ï¼šå¦‚æœä¸Šä¸‹æ–‡æ˜¯â€œæˆ‘çˆ±è¯­è¨€å¤„ç†â€ï¼Œé‚£â€œè‡ªç„¶â€çš„è¯å‘é‡åº”è¯¥æ›´é è¿‘è¿™ä¸€ä¸Šä¸‹æ–‡çš„å¹³å‡è¡¨ç¤ºã€‚</p>
<h5 id="skip-gram-è®­ç»ƒæ–¹æ³•">Skip-gram è®­ç»ƒæ–¹æ³•</h5>
<p>åŒæ ·ä¸€å¥è¯ï¼Œã€Œè‡ªç„¶ã€æ˜¯ä¸­å¿ƒè¯ï¼Œå®ƒçš„ä¸Šä¸‹æ–‡æ˜¯ã€Œæˆ‘, çˆ±, è¯­è¨€, å¤„ç†ã€ã€‚
è®­ç»ƒç›®æ ‡ï¼šå¦‚æœå½“å‰è¯æ˜¯â€œè‡ªç„¶â€ï¼Œæ¨¡å‹å¸Œæœ›å®ƒçš„è¯å‘é‡èƒ½å¤Ÿé¢„æµ‹å‡ºä¸Šä¸‹æ–‡ä¸­çš„æ¯ä¸€ä¸ªè¯ï¼Œä¹Ÿå°±æ˜¯â€œæˆ‘â€â€œçˆ±â€â€œè¯­è¨€â€â€œå¤„ç†â€ã€‚</p>
<p>æ¢å¥è¯è¯´ï¼Œæ¨¡å‹é€šè¿‡è®©â€œè‡ªç„¶â€çš„å‘é‡å°½å¯èƒ½é è¿‘å®ƒç»å¸¸å‡ºç°çš„ä¸Šä¸‹æ–‡è¯å‘é‡ï¼Œä»è€Œæ•æ‰â€œè‡ªç„¶â€çš„è¯­ä¹‰ä¿¡æ¯ã€‚è®­ç»ƒå®Œæˆåï¼Œâ€œè‡ªç„¶â€çš„è¯å‘é‡å°±è‡ªç„¶å½¢æˆäº†ï¼Œå¹¶ä¸”è¯­ä¹‰ä¸Šä¼šé è¿‘ç±»ä¼¼çš„è¯ï¼Œä¾‹å¦‚â€œè¯­è¨€â€ã€â€œæ–‡æœ¬â€ç­‰ã€‚</p>
<h4 id="ä¸ºä»€ä¹ˆé¢„æµ‹ä»»åŠ¡èƒ½å­¦å‡ºè¯­ä¹‰">ä¸ºä»€ä¹ˆâ€œé¢„æµ‹ä»»åŠ¡â€èƒ½å­¦å‡ºè¯­ä¹‰ï¼Ÿ</h4>
<p>Word2Vec çš„æ ¸å¿ƒå‡è®¾æ˜¯ï¼š
<strong>ä¸Šä¸‹æ–‡ç›¸ä¼¼çš„è¯ï¼Œå…¶è¯­ä¹‰ä¹Ÿç›¸ä¼¼ã€‚</strong></p>
<p>åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼š</p>
<ul>
<li>ç‹—å’ŒçŒ«ç»å¸¸å‡ºç°åœ¨ç›¸ä¼¼çš„ä¸Šä¸‹æ–‡ï¼ˆä¾‹å¦‚â€™å–‚..â€™ï¼Œâ€˜å® ç‰©..â€™ï¼‰</li>
<li>æ¨¡å‹ä¼šè®©å®ƒä»¬çš„è¯å‘é‡éƒ½é è¿‘è¿™äº›ä¸Šä¸‹æ–‡å‘é‡ï¼›</li>
<li>æœ€ç»ˆå®ƒä»¬çš„è¯å‘é‡ä¹Ÿå°±é è¿‘äº†ã€‚</li>
</ul>
<h3 id="åº”ç”¨åœºæ™¯">ğŸ“¦ åº”ç”¨åœºæ™¯</h3>
<ul>
<li><strong>é¢„è®­ç»ƒç‰¹å¾ï¼š</strong> ä½œä¸ºæ‰€æœ‰ä¸‹æ¸¸ NLP
ä»»åŠ¡ï¼ˆåˆ†ç±»ã€å‘½åå®ä½“è¯†åˆ«ã€ç¿»è¯‘ç­‰ï¼‰çš„è¾“å…¥ç‰¹å¾ã€‚</li>
<li><strong>è¯­ä¹‰ç›¸ä¼¼åº¦è®¡ç®—ï¼š</strong> ç›´æ¥è®¡ç®—è¯å‘é‡çš„ä½™å¼¦ç›¸ä¼¼åº¦ã€‚</li>
<li><strong>è¯è¯­ç±»æ¯”ï¼š</strong> è¿›è¡Œå‘é‡ä»£æ•°è¿ç®—æ¥å‘ç°è¯­ä¹‰å…³ç³»ã€‚</li>
</ul>
<h3 id="ç¤ºä¾‹gensim-word2vec-skip-gram-å®ç°">ğŸ’» ç¤ºä¾‹ï¼ˆGensim Word2Vec
Skip-gram å®ç°ï¼‰</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gensim.models <span class="keyword">import</span> Word2Vec</span><br><span class="line"><span class="keyword">import</span> jieba</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸­æ–‡æ–‡æœ¬è¯­æ–™(ä½¿ç”¨è¾ƒå¤§çš„è¯­æ–™ä»¥è·å¾—æ›´å¥½çš„è¯å‘é‡)</span></span><br><span class="line">corpus_text = <span class="string">"""</span></span><br><span class="line"><span class="string">è‡ªç„¶è¯­è¨€å¤„ç†æ˜¯äººå·¥æ™ºèƒ½çš„é‡è¦åˆ†æ”¯ã€‚æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ æ˜¯äººå·¥æ™ºèƒ½çš„æ ¸å¿ƒæŠ€æœ¯ã€‚</span></span><br><span class="line"><span class="string">è¯å‘é‡æ˜¯è‡ªç„¶è¯­è¨€å¤„ç†çš„åŸºç¡€ã€‚è¯å‘é‡å¯ä»¥è¡¨ç¤ºè¯è¯­çš„è¯­ä¹‰ä¿¡æ¯ã€‚</span></span><br><span class="line"><span class="string">å›½ç‹æ˜¯ç”·æ€§ç»Ÿæ²»è€…,ç‹åæ˜¯å¥³æ€§ç»Ÿæ²»è€…ã€‚ç”·äººå’Œå¥³äººæœ‰ä¸åŒçš„æ€§åˆ«ç‰¹å¾ã€‚</span></span><br><span class="line"><span class="string">ç‹—æ˜¯äººç±»çš„å¥½æœ‹å‹ã€‚çŒ«ä¹Ÿæ˜¯å¸¸è§çš„å® ç‰©ã€‚äººä»¬å–œæ¬¢å…»ç‹—å’ŒçŒ«ä½œä¸ºå® ç‰©ã€‚</span></span><br><span class="line"><span class="string">æœºå™¨å­¦ä¹ åŒ…æ‹¬ç›‘ç£å­¦ä¹ å’Œæ— ç›‘ç£å­¦ä¹ ã€‚æ·±åº¦å­¦ä¹ æ˜¯æœºå™¨å­¦ä¹ çš„ä¸€ä¸ªé‡è¦æ–¹å‘ã€‚</span></span><br><span class="line"><span class="string">è‡ªç„¶è¯­è¨€å¤„ç†åº”ç”¨å¹¿æ³›,åŒ…æ‹¬æœºå™¨ç¿»è¯‘ã€æ–‡æœ¬åˆ†ç±»ã€æƒ…æ„Ÿåˆ†æç­‰ä»»åŠ¡ã€‚</span></span><br><span class="line"><span class="string">Pythonæ˜¯æµè¡Œçš„ç¼–ç¨‹è¯­è¨€ã€‚Javaä¹Ÿæ˜¯å¸¸ç”¨çš„ç¼–ç¨‹è¯­è¨€ã€‚ç¼–ç¨‹è¯­è¨€ç”¨äºè½¯ä»¶å¼€å‘ã€‚</span></span><br><span class="line"><span class="string">åŒ—äº¬æ˜¯ä¸­å›½çš„é¦–éƒ½ã€‚ä¸Šæµ·æ˜¯ä¸­å›½çš„ç»æµä¸­å¿ƒã€‚ä¸­å›½æœ‰å¾ˆå¤šå¤§åŸå¸‚ã€‚</span></span><br><span class="line"><span class="string">è‹¹æœæ˜¯å¥åº·çš„æ°´æœã€‚é¦™è•‰ä¹Ÿæ˜¯è¥å…»ä¸°å¯Œçš„æ°´æœã€‚æ°´æœå¯Œå«ç»´ç”Ÿç´ ã€‚</span></span><br><span class="line"><span class="string">è¶³çƒæ˜¯æµè¡Œçš„è¿åŠ¨ã€‚ç¯®çƒä¹Ÿæ˜¯å—æ¬¢è¿çš„è¿åŠ¨ã€‚è¿åŠ¨æœ‰ç›Šäºèº«ä½“å¥åº·ã€‚</span></span><br><span class="line"><span class="string">ç”µå½±æ˜¯å¨±ä¹æ–¹å¼ã€‚éŸ³ä¹ä¹Ÿæ˜¯å¸¸è§çš„å¨±ä¹ã€‚äººä»¬é€šè¿‡å¨±ä¹æ”¾æ¾èº«å¿ƒã€‚</span></span><br><span class="line"><span class="string">å­¦ä¹ éœ€è¦åŠªåŠ›å’ŒåšæŒã€‚åŠªåŠ›å·¥ä½œæ‰èƒ½æˆåŠŸã€‚æˆåŠŸéœ€è¦åšæŒä¸æ‡ˆã€‚</span></span><br><span class="line"><span class="string">è®¡ç®—æœºç§‘å­¦æ˜¯é‡è¦å­¦ç§‘ã€‚æ•°å­¦æ˜¯ç§‘å­¦çš„åŸºç¡€ã€‚ç‰©ç†å­¦ç ”ç©¶è‡ªç„¶è§„å¾‹ã€‚</span></span><br><span class="line"><span class="string">åŒ»ç”Ÿæ²»ç—…æ•‘äººã€‚æ•™å¸ˆæ•™ä¹¦è‚²äººã€‚å·¥ç¨‹å¸ˆè®¾è®¡å’Œå»ºé€ ã€‚</span></span><br><span class="line"><span class="string">æ˜¥å¤©æ¸©æš–å®œäººã€‚å¤å¤©ç‚çƒ­å¤šé›¨ã€‚ç§‹å¤©å‡‰çˆ½èˆ’é€‚ã€‚å†¬å¤©å¯’å†·å¹²ç‡¥ã€‚</span></span><br><span class="line"><span class="string">é˜…è¯»å¯ä»¥å¢é•¿çŸ¥è¯†ã€‚å†™ä½œèƒ½å¤Ÿè¡¨è¾¾æ€æƒ³ã€‚æ€è€ƒå¸®åŠ©ç†è§£é—®é¢˜ã€‚</span></span><br><span class="line"><span class="string">ç¾é£Ÿä»¤äººæ„‰æ‚¦ã€‚çƒ¹é¥ªæ˜¯ä¸€é—¨è‰ºæœ¯ã€‚é¤å…æä¾›å„ç§ç¾é£Ÿã€‚</span></span><br><span class="line"><span class="string">æ±½è½¦æ˜¯äº¤é€šå·¥å…·ã€‚é£æœºé€Ÿåº¦æ›´å¿«ã€‚ç«è½¦é€‚åˆé•¿é€”æ—…è¡Œã€‚</span></span><br><span class="line"><span class="string">æ‰‹æœºæ˜¯é€šè®¯è®¾å¤‡ã€‚ç”µè„‘ç”¨äºåŠå…¬å­¦ä¹ ã€‚äº’è”ç½‘è¿æ¥ä¸–ç•Œã€‚</span></span><br><span class="line"><span class="string">éŸ³ä¹èƒ½å¤Ÿé™¶å†¶æƒ…æ“ã€‚ç»˜ç”»å±•ç°è‰ºæœ¯ä¹‹ç¾ã€‚èˆè¹ˆè¡¨è¾¾èº«ä½“è¯­è¨€ã€‚</span></span><br><span class="line"><span class="string">"""</span> * <span class="number">5</span>  <span class="comment"># é‡å¤å¤šæ¬¡ä»¥å¢åŠ è®­ç»ƒæ•°æ®</span></span><br><span class="line"></span><br><span class="line">sentences = [</span><br><span class="line">    [<span class="string">"æˆ‘"</span>, <span class="string">"çˆ±"</span>, <span class="string">"è‡ªç„¶"</span>, <span class="string">"è¯­è¨€å¤„ç†"</span>, <span class="string">"æŠ€æœ¯"</span>],</span><br><span class="line">    [<span class="string">"è¯å‘é‡"</span>, <span class="string">"æ˜¯"</span>, <span class="string">"è‡ªç„¶"</span>, <span class="string">"è¯­è¨€å¤„ç†"</span>, <span class="string">"çš„"</span>, <span class="string">"åŸºçŸ³"</span>],</span><br><span class="line">    [<span class="string">"æœºå™¨å­¦ä¹ "</span>, <span class="string">"å’Œ"</span>, <span class="string">"æ·±åº¦å­¦ä¹ "</span>, <span class="string">"æ˜¯"</span>, <span class="string">"ä¸»æµ"</span>, <span class="string">"æ–¹æ³•"</span>],</span><br><span class="line">    [<span class="string">"å›½ç‹"</span>, <span class="string">"ç”·äºº"</span>, <span class="string">"å¥³äºº"</span>, <span class="string">"ç‹å"</span>],</span><br><span class="line">    [<span class="string">"çˆ±"</span>, <span class="string">"å’Œ"</span>, <span class="string">"å’Œå¹³"</span>, <span class="string">"æ˜¯"</span>, <span class="string">"æ°¸æ’"</span>, <span class="string">"çš„ä¸»é¢˜"</span>],</span><br><span class="line">]</span><br><span class="line"><span class="comment"># ä½¿ç”¨ jieba è¿›è¡Œä¸­æ–‡åˆ†è¯</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> corpus_text.strip().split(<span class="string">'\n'</span>):</span><br><span class="line">    <span class="keyword">if</span> line.strip():</span><br><span class="line">        words = <span class="built_in">list</span>(jieba.cut(line.strip()))</span><br><span class="line">        <span class="comment"># è¿‡æ»¤æ ‡ç‚¹ç¬¦å·å’Œå•å­—ç¬¦</span></span><br><span class="line">        words = [w <span class="keyword">for</span> w <span class="keyword">in</span> words <span class="keyword">if</span> <span class="built_in">len</span>(w) &gt; <span class="number">0</span> <span class="keyword">and</span> w <span class="keyword">not</span> <span class="keyword">in</span> <span class="string">',.ã€‚,ã€;:!?!?""'</span><span class="string">'ã€Šã€‹()ã€ã€‘'</span>]</span><br><span class="line">        <span class="keyword">if</span> words:</span><br><span class="line">            sentences.append(words)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®­ç»ƒ Word2Vec æ¨¡å‹</span></span><br><span class="line">model = Word2Vec(</span><br><span class="line">    sentences,            <span class="comment"># è¯­æ–™</span></span><br><span class="line">    vector_size=<span class="number">32</span>,        <span class="comment"># å‘é‡ç»´åº¦</span></span><br><span class="line">    window=<span class="number">4</span>,             <span class="comment"># ä¸Šä¸‹æ–‡çª—å£å¤§å°</span></span><br><span class="line">    min_count=<span class="number">0</span>,          <span class="comment"># å¿½ç•¥å‡ºç°æ¬¡æ•°å°äº1çš„è¯</span></span><br><span class="line">    sg=<span class="number">1</span>,                 <span class="comment"># sg=1 ä»£è¡¨ Skip-gramï¼Œsg=0 ä»£è¡¨ CBOW</span></span><br><span class="line">    epochs=<span class="number">500</span>            <span class="comment"># è¿­ä»£æ¬¡æ•°</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–è¯å‘é‡</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"--- è¯å‘é‡æ¨¡å‹è®­ç»ƒç»“æœ ---"</span>)</span><br><span class="line">word_love = <span class="string">'çˆ±'</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"'<span class="subst">{word_love}</span>' çš„è¯å‘é‡: <span class="subst">{model.wv[word_love]}</span>"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯è¯­ç›¸ä¼¼åº¦è®¡ç®—</span></span><br><span class="line">similar_words = model.wv.most_similar(<span class="string">'å¤„ç†'</span>, topn=<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"\nä¸ 'å¤„ç†' æœ€ç›¸ä¼¼çš„è¯ (Top 3): <span class="subst">{similar_words}</span>"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯è¯­ç±»æ¯” (å¦‚æœæ•°æ®é‡è¶³å¤Ÿå¤§ï¼Œæ•ˆæœä¼šå¾ˆå¥½)</span></span><br><span class="line">analogy = model.wv.most_similar(positive=[<span class="string">'ç‹å'</span>, <span class="string">'ç”·äºº'</span>], negative=[<span class="string">'å¥³äºº'</span>], topn=<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"\n'ç‹å' + 'ç”·äºº' - 'å¥³äºº' çº¦ç­‰äº: <span class="subst">{analogy}</span>"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">--- è¯å‘é‡æ¨¡å‹è®­ç»ƒç»“æœ ---</span><br><span class="line">'çˆ±' çš„è¯å‘é‡: [ 1.0664989  -0.5794411  -0.16871376 -0.13184728  0.48283565 -0.354865</span><br><span class="line">  1.3210454  -0.1693582  -0.72543424 -0.2901834   0.21910937 -0.37224293</span><br><span class="line"> -0.06491608 -0.8655389   0.39459693  0.8997167   0.24972028 -0.860483</span><br><span class="line">  0.76891196  0.03923182 -0.3576591   1.2710804   0.1804323   0.5814926</span><br><span class="line">  0.6470771   0.6128785  -1.227191    0.8472333  -1.32114    -0.2857696</span><br><span class="line"> -0.04215891  0.9688248 ]</span><br><span class="line"></span><br><span class="line">ä¸ 'å¤„ç†' æœ€ç›¸ä¼¼çš„è¯ (Top 3): [('è‡ªç„¶è¯­è¨€', 0.8251885175704956), ('æ ¸å¿ƒæŠ€æœ¯', 0.707213819026947), ('å‘é‡', 0.6756125688552856)]</span><br><span class="line"></span><br><span class="line">'ç‹å' + 'ç”·äºº' - 'å¥³äºº' çº¦ç­‰äº: [('å›½ç‹', 0.8771973848342896), ('ç»Ÿæ²»è€…', 0.8529900908470154), ('å¥³æ€§', 0.8453759551048279)]</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å‘ç°ï¼ŒWord2Vec ä¼šå°†æ¯ä¸€ä¸ª <strong>Tokenï¼ˆè¯ï¼‰</strong>
è½¬æ¢ä¸ºä¸€ä¸ª<strong>å›ºå®šé•¿åº¦çš„ç¨ å¯†å‘é‡</strong>ï¼Œè¿™äº›å‘é‡ç”±æ­£è´Ÿæµ®ç‚¹æ•°æ„æˆï¼Œèƒ½å¤Ÿ<strong>æ•æ‰è¯è¯­çš„è¯­ä¹‰ä¿¡æ¯</strong>ã€‚ä¾‹å¦‚
<code>å¤„ç†</code> çš„æœ€ç›¸ä¼¼è¯åŒ…æ‹¬
<code>è‡ªç„¶è¯­è¨€</code>ã€<code>æ ¸å¿ƒæŠ€æœ¯</code>ã€<code>å‘é‡</code>ï¼Œå®ƒä»¬åœ¨è¯­ä¹‰ä¸Šéƒ½ä¸â€œå¤„ç†â€ç›¸å…³ã€‚è¿™è¯´æ˜è®­ç»ƒå¥½çš„å‘é‡ç©ºé—´èƒ½å¤Ÿå°†è¯­ä¹‰ç›¸å…³çš„è¯æ˜ å°„åˆ°ç›¸è¿‘çš„åŒºåŸŸã€‚</p>
<p>æ­¤å¤–ï¼Œå®éªŒ <code>'ç‹å' + 'ç”·äºº' - 'å¥³äºº' â‰ˆ 'å›½ç‹'</code>
æˆåŠŸæ•æ‰äº†æ€§åˆ«å…³ç³»å’Œè§’è‰²å¯¹åº”å…³ç³»ã€‚è¿™ä½“ç°äº† Word2Vec
çš„æ ¸å¿ƒä¼˜åŠ¿ï¼š<strong>ä¸ä»…è¡¨ç¤ºå•ä¸ªè¯è¯­ï¼Œè¿˜èƒ½éšå«è¯­ä¹‰å…³ç³»ï¼Œæ”¯æŒç®€å•çš„å‘é‡è¿ç®—</strong>ã€‚</p>
<p>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹æ¥æµ‹è¯•ï¼Œè¿™ä¼šæ¯”æˆ‘ä»¬è‡ªå·±è®­ç»ƒçš„æ•ˆæœè¦å¥½å¾ˆå¤šï¼š</p>
<blockquote>
<p><a class="link" target="_blank" rel="noopener" href="https://code.google.com/archive/p/word2vec/">æ¨¡å‹äºŒè¿›åˆ¶æ–‡ä»¶ä¸‹è½½é“¾æ¥<i class="fas fa-external-link-alt"></i></a></p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">from gensim.models <span class="keyword">import</span> KeyedVectors</span><br><span class="line"></span><br><span class="line">model = KeyedVectors.<span class="built_in">load_word2vec_format</span>(<span class="string">"GoogleNews-vectors-negative300.bin"</span>, binary=True)</span><br><span class="line"></span><br><span class="line"># è·å–è¯å‘é‡</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"--- è¯å‘é‡æ¨¡å‹è®­ç»ƒç»“æœ ---"</span>)</span><br><span class="line">word_love = <span class="string">'çˆ±'</span></span><br><span class="line"><span class="built_in">print</span>(f<span class="string">"'{word_love}' çš„è¯å‘é‡é•¿åº¦: {model[word_love].shape}"</span>)</span><br><span class="line"></span><br><span class="line"># è¯è¯­ç›¸ä¼¼åº¦è®¡ç®—</span><br><span class="line">similar_words = model.<span class="built_in">most_similar</span>(<span class="string">'å¤„ç†'</span>, topn=<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(f<span class="string">"\nä¸ 'å¤„ç†' æœ€ç›¸ä¼¼çš„è¯ (Top 3): {similar_words}"</span>)</span><br><span class="line">similar_words = model.<span class="built_in">most_similar</span>(<span class="string">"king"</span>, topn=<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"king çš„ç›¸ä¼¼è¯:"</span>, similar_words)</span><br><span class="line"></span><br><span class="line"># è¯è¯­ç±»æ¯”</span><br><span class="line">analogy = model.<span class="built_in">most_similar</span>(positive=[<span class="string">'queen'</span>, <span class="string">'man'</span>], negative=[<span class="string">'women'</span>], topn=<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(f<span class="string">"\n'queen' + 'man' - 'women' çº¦ç­‰äº: {analogy}"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">--- è¯å‘é‡æ¨¡å‹è®­ç»ƒç»“æœ ---</span><br><span class="line"><span class="string">'çˆ±'</span> çš„è¯å‘é‡é•¿åº¦: (<span class="number">300</span>,)</span><br><span class="line"></span><br><span class="line">ä¸ <span class="string">'å¤„ç†'</span> æœ€ç›¸ä¼¼çš„è¯ (Top <span class="number">3</span>): [(<span class="string">'èµ„æ–™'</span>, <span class="number">0.8521135449409485</span>), (<span class="string">'ä¸ªäºº'</span>, <span class="number">0.8465384840965271</span>), (<span class="string">'å¦‚ä½•'</span>, <span class="number">0.8432191610336304</span>)]</span><br><span class="line">king çš„ç›¸ä¼¼è¯: [(<span class="string">'kings'</span>, <span class="number">0.7138045430183411</span>), (<span class="string">'queen'</span>, <span class="number">0.6510956883430481</span>), (<span class="string">'monarch'</span>, <span class="number">0.6413194537162781</span>)]</span><br><span class="line"></span><br><span class="line"><span class="string">'queen'</span> + <span class="string">'man'</span> - <span class="string">'women'</span> çº¦ç­‰äº: [(<span class="string">'king'</span>, <span class="number">0.5553385019302368</span>), (<span class="string">'princess'</span>, <span class="number">0.4909053444862366</span>), (<span class="string">'boy'</span>, <span class="number">0.48070359230041504</span>)]</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆï¼Œè¯¥æ¨¡å‹ä¸­è¯æ±‡çš„å‘é‡ç»´åº¦æ˜¯ 300
ç»´ï¼Œè¿™è¿œå¤§äºæˆ‘ä»¬åœ¨å°è§„æ¨¡ç¤ºä¾‹ä¸­è®¾ç½®çš„ç»´åº¦ã€‚åœ¨æµ·é‡è¯­æ–™ä¸Šè®­ç»ƒçš„é«˜ç»´å‘é‡é€šå¸¸èƒ½å¤Ÿæ•æ‰åˆ°æ›´ä¸°å¯Œã€æ›´ç»†è‡´çš„è¯­ä¹‰ä¿¡æ¯ã€‚å…¶æ¬¡ï¼Œå¯¹äºè¯­ä¹‰ç›¸ä¼¼åº¦è®¡ç®—ï¼Œæ¨¡å‹è¡¨ç°å‡ºè‰²ï¼Œå¯ä»¥å¾ˆç²¾å‡†åœ°æ‰¾å‡ºç›¸ä¼¼è¯ã€‚</p>
<p>ä½†æ˜¯ï¼Œæœ€åè¿™é‡Œä¹‹æ‰€ä»¥æ²¡æœ‰ä½¿ç”¨â€™ç‹åâ€™ + â€˜ç”·äººâ€™ - â€˜å¥³äººâ€™
çš„ä¾‹å­ï¼Œæ˜¯å› ä¸ºè¿™ä¸ªè®­ç»ƒåçš„è¯è¡¨ä¸­æ²¡æœ‰â€™ç‹åâ€™è¿™ä¸ªè¯ï¼Œè¿™ä¹Ÿæ˜¯è¿™ç±»è¯åµŒå…¥æ–¹æ³•çš„å›ºæœ‰å±€é™æ€§ï¼šå®ƒä»¬å®Œå…¨ä¾èµ–äºé¢„è®¾çš„<strong>å›ºå®šè¯æ±‡è¡¨</strong>ï¼Œå¯¹äºè¯è¡¨ä¸­ä¸å­˜åœ¨çš„è¯ï¼ˆOOVï¼‰ï¼Œå¦‚æ–°è¯æˆ–è·¨è¯­è¨€è¯æ±‡ï¼Œå®ƒä»¬<strong>æ— æ³•ç”Ÿæˆæœ‰æ•ˆçš„å‘é‡</strong>ã€‚</p>
<hr>
<h2 id="ä¸Šä¸‹æ–‡åµŒå…¥contextual-embedding">4. ä¸Šä¸‹æ–‡åµŒå…¥ï¼ˆContextual
Embeddingï¼‰</h2>
<h3 id="ä¸»è¦æ€æƒ³ä¸åŸç†-3">ğŸš€ ä¸»è¦æ€æƒ³ä¸åŸç†</h3>
<p>ä¸Šä¸‹æ–‡åµŒå…¥æ˜¯æ·±åº¦å­¦ä¹ æ—¶ä»£çš„æ ¸å¿ƒæŠ€æœ¯ï¼Œå®ƒè§£å†³äº†ä¼ ç»Ÿè¯å‘é‡ï¼ˆå¦‚
Word2Vecï¼‰ä¸­<strong>ä¸€è¯å¤šä¹‰</strong>çš„é—®é¢˜ã€‚</p>
<ul>
<li><strong>æ€æƒ³ï¼š</strong>
ä¸€ä¸ªè¯çš„å‘é‡è¡¨ç¤º<strong>ä¸å†æ˜¯å›ºå®šä¸å˜çš„</strong>ï¼Œè€Œæ˜¯æ ¹æ®å®ƒåœ¨<strong>å½“å‰å¥å­ä¸­çš„ä¸Šä¸‹æ–‡</strong>åŠ¨æ€ç”Ÿæˆçš„ã€‚</li>
<li><strong>åŸç†ï¼š</strong>
<ul>
<li>ä¸Šä¸‹æ–‡æ„ŸçŸ¥ï¼š ä½¿ç”¨å¤æ‚çš„ç¥ç»ç½‘ç»œç»“æ„ï¼ˆä¸»è¦æ˜¯
<strong>Transformer</strong> çš„ <strong>Attention
æœºåˆ¶</strong>ï¼‰æ¥å¤„ç†æ•´ä¸ªè¾“å…¥åºåˆ—ã€‚</li>
<li>æ¨¡å‹åœ¨ç¼–ç ä¸€ä¸ªè¯æ—¶ï¼Œä¼š<strong>åŒæ—¶å…³æ³¨</strong>å¥å­ä¸­çš„å…¶ä»–æ‰€æœ‰è¯ï¼Œå¹¶æ ¹æ®è¿™äº›è¯çš„è¯­ä¹‰ä¿¡æ¯æ¥è°ƒæ•´å½“å‰è¯çš„å‘é‡è¡¨ç¤ºã€‚</li>
<li>ä¾‹å¦‚ï¼Œåœ¨ â€œæˆ‘å–œæ¬¢åƒ <strong>è‹¹æœ</strong>â€ å’Œ â€œæˆ‘ç”¨
<strong>è‹¹æœ</strong> ç”µè„‘â€ ä¸­ï¼ŒTransformer ä¼šç»™ä¸¤ä¸ª
â€œ<strong>è‹¹æœ</strong>â€
ç”Ÿæˆæˆªç„¶ä¸åŒçš„å‘é‡ï¼Œåˆ†åˆ«å¯¹åº”â€œæ°´æœâ€å’Œâ€œå“ç‰Œâ€çš„è¯­ä¹‰ã€‚</li>
</ul></li>
</ul>
<h4 id="å¸¸è§æ¨¡å‹bert-gpt">å¸¸è§æ¨¡å‹ï¼šBERT &amp; GPT</h4>
<ol type="1">
<li>BERT (Bidirectional Encoder Representations from Transformers)ï¼š
åŒå‘ç¼–ç å™¨ï¼ŒåŒæ—¶è€ƒè™‘ä¸€ä¸ªè¯çš„å·¦ä¾§å’Œå³ä¾§ä¸Šä¸‹æ–‡ã€‚
<ul>
<li>é¢„è®­ç»ƒä»»åŠ¡ï¼š æ©ç è¯­è¨€æ¨¡å‹ï¼ˆMLMï¼‰å’Œä¸‹ä¸€å¥é¢„æµ‹ï¼ˆNSPï¼‰ã€‚</li>
</ul></li>
<li>GPT (Generative Pre-trained Transformer)ï¼š
å•å‘è§£ç å™¨ï¼Œåªä¾èµ–å·¦ä¾§ä¸Šä¸‹æ–‡ï¼Œæ“…é•¿ç”Ÿæˆä»»åŠ¡ã€‚
<ul>
<li>é¢„è®­ç»ƒä»»åŠ¡ï¼šä¸‹ä¸€ä¸ªè¯é¢„æµ‹ (Next Token Prediction)ã€‚</li>
</ul></li>
</ol>
<h3 id="åº”ç”¨åœºæ™¯-1">ğŸ“¦ åº”ç”¨åœºæ™¯</h3>
<ul>
<li><strong>æ‰€æœ‰ SOTA (State-of-the-Art) NLP ä»»åŠ¡ï¼š</strong>
æœºå™¨ç¿»è¯‘ã€é—®ç­”ç³»ç»Ÿã€æ–‡æœ¬æ‘˜è¦ã€å‘½åå®ä½“è¯†åˆ«ç­‰ã€‚</li>
<li><strong>é›¶æ ·æœ¬/å°‘æ ·æœ¬å­¦ä¹  (Zero/Few-shot Learning)ï¼š</strong>
å¤§è¯­è¨€æ¨¡å‹çš„åŸºç¡€ã€‚</li>
</ul>
<h3 id="ç¤ºä¾‹hugging-face-transformers-bert-è·å–tokenè¡¨ç¤ºå‘é‡">ğŸ’»
ç¤ºä¾‹ï¼ˆHugging Face Transformers BERT è·å–Tokenè¡¨ç¤ºå‘é‡ï¼‰</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> BertModel, BertTokenizer</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½é¢„è®­ç»ƒæ¨¡å‹å’Œåˆ†è¯å™¨</span></span><br><span class="line">tokenizer = BertTokenizer.from_pretrained(<span class="string">'bert-base-uncased'</span>)</span><br><span class="line">model = BertModel.from_pretrained(<span class="string">'bert-base-uncased'</span>)</span><br><span class="line"></span><br><span class="line">sentence = <span class="string">"The bank is on the river bank."</span></span><br><span class="line"><span class="comment"># åˆ†è¯</span></span><br><span class="line">inputs = tokenizer(sentence, return_tensors=<span class="string">"pt"</span>)</span><br><span class="line"><span class="built_in">print</span>(inputs)</span><br><span class="line"><span class="keyword">with</span> torch.no_grad():</span><br><span class="line">    outputs = model(**inputs)</span><br><span class="line">    <span class="built_in">print</span>(outputs.keys())</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"last_hidden_state shape:"</span>, outputs.last_hidden_state.shape)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"pooler_output shape:"</span>, outputs.pooler_output.shape)</span><br><span class="line">    last_hidden_state = outputs.last_hidden_state</span><br><span class="line">    </span><br><span class="line"><span class="comment"># æå–å…³é”®è¯çš„å‘é‡</span></span><br><span class="line"><span class="comment"># è¯å…¸: ['[CLS]', 'the', 'bank', 'is', 'on', 'the', 'river', 'bank', '.', '[SEP]']</span></span><br><span class="line"><span class="comment"># 'bank' (é‡‘èæœºæ„): ç´¢å¼• 2</span></span><br><span class="line"><span class="comment"># 'bank' (æ²³å²¸): ç´¢å¼• 7</span></span><br><span class="line">vector_bank_finance = last_hidden_state[<span class="number">0</span>][<span class="number">2</span>]</span><br><span class="line">vector_bank_river = last_hidden_state[<span class="number">0</span>][<span class="number">7</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—ä¸¤ä¸ª 'bank' å‘é‡çš„ä½™å¼¦ç›¸ä¼¼åº¦</span></span><br><span class="line"><span class="comment"># ä½¿ç”¨ PyTorch çš„ç›¸ä¼¼åº¦è®¡ç®—</span></span><br><span class="line">cos_sim = torch.nn.functional.cosine_similarity(</span><br><span class="line">    vector_bank_finance.unsqueeze(<span class="number">0</span>), </span><br><span class="line">    vector_bank_river.unsqueeze(<span class="number">0</span>)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"Tokens: <span class="subst">{tokenizer.convert_ids_to_tokens(inputs[<span class="string">'input_ids'</span>][<span class="number">0</span>])}</span>"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"BERT å‘é‡ç»´åº¦: <span class="subst">{vector_bank_finance.shape[<span class="number">0</span>]}</span>"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"--- ä¸¤ä¸ª 'bank' çš„å‘é‡è¡¨ç¤ºï¼ˆå‰ 5 ç»´ï¼‰ ---"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"Bank (é‡‘è): <span class="subst">{vector_bank_finance[:<span class="number">5</span>]}</span>"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"Bank (æ²³å²¸): <span class="subst">{vector_bank_river[:<span class="number">5</span>]}</span>"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"\nä¸¤ä¸ª 'bank' çš„ä¸Šä¸‹æ–‡ç›¸ä¼¼åº¦: <span class="subst">{cos_sim.item()}</span>"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">{'input_ids': tensor([[ 101, 1996, 2924, 2003, 2006, 1996, 2314, 2924, 1012,  102]]), 'token_type_ids': tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]), 'attention_mask': tensor([[1, 1, 1, 1, 1, 1, 1, 1, 1, 1]])}</span><br><span class="line">odict_keys(['last_hidden_state', 'pooler_output'])</span><br><span class="line">last_hidden_state shape: torch.Size([1, 10, 768])</span><br><span class="line">pooler_output shape: torch.Size([1, 768])</span><br><span class="line">Tokens: ['[CLS]', 'the', 'bank', 'is', 'on', 'the', 'river', 'bank', '.', '[SEP]']</span><br><span class="line">BERT å‘é‡ç»´åº¦: 768</span><br><span class="line">--- ä¸¤ä¸ª 'bank' çš„å‘é‡è¡¨ç¤ºï¼ˆå‰ 5 ç»´ï¼‰ ---</span><br><span class="line">Bank (é‡‘è): tensor([-0.4117, -0.2152, -0.0635, -0.0978,  0.5961])</span><br><span class="line">Bank (æ²³å²¸): tensor([-0.1720, -0.2786, -0.0828, -0.4458,  0.2067])</span><br><span class="line"></span><br><span class="line">ä¸¤ä¸ª 'bank' çš„ä¸Šä¸‹æ–‡ç›¸ä¼¼åº¦: 0.7106703519821167</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºBERTä¸­æ¯ä¸ªtokenéƒ½æ˜¯ç”¨ä¸€ä¸ª768ç»´çš„å‘é‡æ¥è¡¨å¾çš„ã€‚</p>
<p>BERTçš„è¾“å‡ºä¸­last_hidden_stateæ˜¯æ¨¡å‹å¯¹æ¯ä¸ª token è¾“å‡ºçš„éšè—å‘é‡ï¼Œå½¢çŠ¶
<code>[batch_size, seq_len, hidden_dim]</code>ã€‚è¿™é‡Œæ˜¯
<code>[1, 10, 768]</code>ï¼Œè¡¨ç¤º 1 ä¸ªå¥å­ã€10 ä¸ª tokenã€æ¯ä¸ª token
çš„å‘é‡ç»´åº¦ 768ã€‚</p>
<ul>
<li><code>last_hidden_state[0][i]</code> å°±æ˜¯ç¬¬ i ä¸ª token
çš„è¡¨ç¤ºå‘é‡ã€‚</li>
</ul>
<p>å¯¹äºå¥å­ä¸­çš„ä¸¤ä¸ªâ€œbankâ€çš„è¡¨ç¤ºå‘é‡ï¼Œå¯ä»¥çœ‹åˆ°æ¯ä¸€ç»´çš„æ•°å€¼ä¸å®Œå…¨ç›¸åŒï¼Œè¯´æ˜ä¸¤è€…åœ¨è¡¨ç¤ºä¸Šæœ‰å·®å¼‚ï¼ˆæ¨¡å‹è°ƒæ•´äº†è¡¨ç¤ºä»¥åæ˜ ä¸åŒä¸Šä¸‹æ–‡ï¼‰ã€‚ä½™å¼¦ç›¸ä¼¼åº¦ä¸º
<code>0.7107</code>ï¼Œè¿™æ˜¯
<strong>ä¸­ç­‰åé«˜çš„ç›¸ä¼¼åº¦</strong>ã€‚ä¸ºä»€ä¹ˆä¸æ˜¯æ¥è¿‘ 0ï¼ˆå®Œå…¨ä¸åŒï¼‰æˆ–
1ï¼ˆå‡ ä¹ç›¸åŒï¼‰ï¼Ÿ</p>
<ul>
<li>ä¸¤ä¸ª <code>bank</code>
çš„è¯å½¢ç›¸åŒã€è¯æ€§ç›¸åŒï¼ˆåè¯ï¼‰ï¼Œä¸”å¥å­é‡Œå®ƒä»¬éƒ½å¤„åœ¨ç›¸å¯¹ç›¸ä¼¼çš„è¯­è¨€ç»“æ„ï¼ˆâ€œthe
bank â€¦â€ã€â€œâ€¦ river bankâ€ï¼‰ï¼Œå› æ­¤æ¨¡å‹åœ¨æŸäº›ç»´åº¦ä¸Šä»ä¿ç•™äº†å…±åŒä¿¡æ¯ï¼ˆä¾‹å¦‚
â€œåè¯/åœ°å/æœºæ„â€ çš„é€šç”¨ç‰¹å¾ï¼‰ï¼Œå¯¼è‡´ç›¸ä¼¼åº¦åé«˜ã€‚</li>
<li>åŒæ—¶ï¼Œå› ä¸ºå·¦å³ä¸Šä¸‹æ–‡ä¸åŒï¼ˆä¸€ä¸ªåæ¥ <code>is</code>ï¼Œä¸€ä¸ªå‰æ¥
<code>river</code>ï¼‰ï¼Œæ¨¡å‹åœ¨è‹¥å¹²è¯­ä¹‰ç»´åº¦ä¸Šä½œäº†åŒºåˆ†ï¼Œä½™å¼¦ä¸ä¼šæ˜¯ 1ã€‚</li>
<li>BERT æ˜¯
<strong>ä¸Šä¸‹æ–‡ä¾èµ–çš„åµŒå…¥</strong>ï¼Œä½†å¹¶éæ€»èƒ½æŠŠå¤šä¹‰è¯å®Œå…¨åŒºåˆ†å¼€ï¼Œç‰¹åˆ«æ˜¯åœ¨å•å¥ä¸­åŒæ—¶å‡ºç°ä¸¤ä¸ª
sense æ—¶ï¼Œæ¨¡å‹å¯èƒ½ä¼šæœ‰ä¸€å®šâ€œè¡¨ç¤ºæ··åˆâ€ã€‚</li>
</ul>
<h3 id="é™„æ³¨">é™„æ³¨</h3>
<p>BERTä¸­è¾“å‡ºè¿˜æœ‰ä¸€é¡¹ä¸ºpooler_outputï¼šé€šå¸¸æ˜¯æŠŠ <code>[CLS]</code>
çš„éšè—å‘é‡åšä¸€ä¸ªçº¿æ€§ + tanh å˜æ¢å¾—åˆ°çš„å¥å­çº§å‘é‡ï¼Œå½¢çŠ¶
<code>[batch_size, hidden_dim]</code>ã€‚æ³¨æ„ï¼šå¾ˆå¤šä¸‹æ¸¸ä»»åŠ¡æˆ–è€…è¯„ä»·å¥å­è¯­ä¹‰æ—¶ï¼Œä¸ä¸€å®šæ¨èç›´æ¥ç”¨
<code>pooler_output</code>ï¼Œæ›´ç¨³å¦¥çš„åšæ³•æ˜¯å¯¹
<code>last_hidden_state</code> åšå¹³å‡æ± åŒ–æˆ–ç”¨ä¸“é—¨çš„å¥å‘é‡æ¨¡å‹ï¼ˆå¦‚
Sentence-BERTï¼‰ã€‚</p>
<p>ç¤ºä¾‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> BertTokenizer, BertModel, AutoTokenizer, AutoModel</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸¤ä¸ªè¯­ä¹‰ç›¸ä¼¼å¥</span></span><br><span class="line">sentences = [</span><br><span class="line">    [<span class="string">"A man is playing guitar."</span>,</span><br><span class="line">    <span class="string">"There is a man playing a musical instrument, which likes a guitar"</span>],</span><br><span class="line">    [<span class="string">"A women is playing violin."</span>,</span><br><span class="line">    <span class="string">"The capital of France is Paris"</span>],</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ================================</span></span><br><span class="line"><span class="comment"># 1ï¸âƒ£ æ™®é€š BERT </span></span><br><span class="line"><span class="comment"># ================================</span></span><br><span class="line">bert_name = <span class="string">"bert-base-uncased"</span></span><br><span class="line">bert_tokenizer = BertTokenizer.from_pretrained(bert_name)</span><br><span class="line">bert_model = BertModel.from_pretrained(bert_name)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ================================</span></span><br><span class="line"><span class="comment"># 2ï¸âƒ£ Sentence-BERT </span></span><br><span class="line"><span class="comment"># ================================</span></span><br><span class="line">sbert_name = <span class="string">"sentence-transformers/all-MiniLM-L6-v2"</span></span><br><span class="line">sbert_tokenizer = AutoTokenizer.from_pretrained(sbert_name)</span><br><span class="line">sbert_model = AutoModel.from_pretrained(sbert_name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_bert_sentence_embedding</span>(<span class="params">sentence</span>):</span><br><span class="line">    inputs = bert_tokenizer(sentence, return_tensors=<span class="string">"pt"</span>, truncation=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        outputs = bert_model(**inputs)</span><br><span class="line">        <span class="comment"># mean poolingï¼šå–æ‰€æœ‰tokençš„å¹³å‡è¡¨ç¤º</span></span><br><span class="line">        embeddings = outputs.last_hidden_state</span><br><span class="line">        mask = inputs[<span class="string">'attention_mask'</span>].unsqueeze(-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> (embeddings * mask).<span class="built_in">sum</span>(<span class="number">1</span>) / mask.<span class="built_in">sum</span>(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_sbert_sentence_embedding</span>(<span class="params">sentence</span>):</span><br><span class="line">    inputs = sbert_tokenizer(sentence, return_tensors=<span class="string">"pt"</span>, truncation=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        outputs = sbert_model(**inputs)</span><br><span class="line">        <span class="comment"># mean poolingï¼šå–æ‰€æœ‰tokençš„å¹³å‡è¡¨ç¤º</span></span><br><span class="line">        embeddings = outputs.last_hidden_state</span><br><span class="line">        mask = inputs[<span class="string">'attention_mask'</span>].unsqueeze(-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> (embeddings * mask).<span class="built_in">sum</span>(<span class="number">1</span>) / mask.<span class="built_in">sum</span>(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ss <span class="keyword">in</span> sentences:</span><br><span class="line">    <span class="built_in">print</span>(ss)</span><br><span class="line">    embeddings_bert = [get_bert_sentence_embedding(s) <span class="keyword">for</span> s <span class="keyword">in</span> ss]</span><br><span class="line">    cos_sim_bert = F.cosine_similarity(embeddings_bert[<span class="number">0</span>],</span><br><span class="line">                                    embeddings_bert[<span class="number">1</span>]).item()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"ğŸ”¹ BERT pooler_output ç›¸ä¼¼åº¦:"</span>, <span class="built_in">round</span>(cos_sim_bert, <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">    embeddings_sbert = [get_sbert_sentence_embedding(s) <span class="keyword">for</span> s <span class="keyword">in</span> ss]</span><br><span class="line">    cos_sim_sbert = F.cosine_similarity(embeddings_sbert[<span class="number">0</span>],</span><br><span class="line">                                        embeddings_sbert[<span class="number">1</span>]).item()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"ğŸ”¹ Sentence-BERT ç›¸ä¼¼åº¦:"</span>, <span class="built_in">round</span>(cos_sim_sbert, <span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">['A man is playing guitar.', 'There is a man playing a musical instrument, which likes a guitar']</span><br><span class="line">ğŸ”¹ BERT pooler_output ç›¸ä¼¼åº¦: 0.787</span><br><span class="line">ğŸ”¹ Sentence-BERT ç›¸ä¼¼åº¦: 0.877</span><br><span class="line">['A women is playing violin.', 'The capital of France is Paris']</span><br><span class="line">ğŸ”¹ BERT pooler_output ç›¸ä¼¼åº¦: 0.46</span><br><span class="line">ğŸ”¹ Sentence-BERT ç›¸ä¼¼åº¦: 0.015</span><br></pre></td></tr></table></figure>

                    
                </div>

                
                        
<div class="post-copyright-info-container border-box">
    <div class="copyright-info-content border-box">
        <div class="copyright-info-top border-box">
            <div class="copyright-post-title border-box text-ellipsis">
                å¸¸è§çš„ LLM æ–‡æœ¬åµŒå…¥ï¼ˆEmbeddingï¼‰æ–¹æ³•è§£æ
            </div>

            <div class="copyright-post-link border-box text-ellipsis">
                2025/11/03/LLM-3-Embedding/
            </div>
        </div>

        <div class="copyright-info-bottom border-box">
            <div class="copyright-post-author bottom-item">
                <div class="type">
                    Author
                </div>
                <div class="content">Zhongjun Qiu</div>
            </div>

            <div class="post-time bottom-item">
                <div class="type">
                    Published
                </div>
                <div class="content">2025-11-03 20:40</div>
            </div>


            <div class="post-license bottom-item">
                <div class="type">
                    License
                </div>
                <div class="content tooltip" data-tooltip-content="CC BY-NC-SA 4.0">
                    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed" target="_blank">
                        
                            <i class="fa-brands fa-creative-commons"></i>
                            <i class="fa-brands fa-creative-commons-by"></i>
                            <i class="fa-brands fa-creative-commons-nc"></i>
                            <i class="fa-brands fa-creative-commons-sa"></i>
                        
                    </a>
                </div>
            </div>
        </div>

        <i class="copyright-bg fa-solid fa-copyright"></i>
    </div>
    <div class="copy-copyright-info flex-center tooltip" data-tooltip-content="Copy copyright info" data-tooltip-offset-y="-2px">
        <i class="fa-solid fa-copy"></i>
    </div>
</div>

                

                <div class="post-bottom-tags-and-share border-box">
                    <div>
                        
                            <ul class="post-tags-box border-box">
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/Embedding/">Embedding</a>
                                    </li>
                                
                            </ul>
                        
                    </div>
                    <div>
                        
                            <div class="post-share-container border-box">
    <ul class="share-list-wrap border-box">
        <li class="qq share-item border-box flex-center tooltip"
            data-tooltip-content="Share to QQ"
        >
            <i class="fa-brands fa-qq"></i>
        </li>
        <li class="wechat share-item border-box flex-center tooltip tooltip-img"
            data-tooltip-content="Share to WeChat"
            data-tooltip-img-tip="Scan by WeChat"
            data-tooltip-img-style="background-color: #fff; top: -10px; padding: 0.6rem 0.6rem 0.1rem 0.6rem;"
        >
            <i class="fa-brands fa-weixin"></i>
        </li>
        <li class="weibo share-item border-box flex-center tooltip"
            data-tooltip-content="Share to WeiBo"
        >
            <i class="fa-brands fa-weibo"></i>
        </li>
    </ul>
</div>

                        
                    </div>
                </div>

                
                    

<div class="reward-author-container border-box flex-center">
    <div class="reward-btn border-box flex-center tooltip tooltip-img"
            data-tooltip-img-url="/images/post/payment.jpg"
            data-tooltip-img-trigger="click"
            data-tooltip-img-style="top: -6px;"
    >
        <i class="fa-solid fa-gift"></i>&nbsp;REWARD AUTHOR
    </div>
</div>

                

                
                    <div class="post-nav border-box">
                        
                            <div class="prev-post">
                                <a class="prev"
                                   rel="prev"
                                   href="/2025/11/08/LLM-4-Attention/"
                                   title="Attention is all you need"
                                >
                                    <span class="left arrow-icon flex-center">
                                        <i class="fas fa-chevron-left"></i>
                                    </span>
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">Attention is all you need</span>
                                        <span class="post-nav-item">Prev posts</span>
                                    </span>
                                </a>
                            </div>
                        
                        
                            <div class="next-post">
                                <a class="next"
                                   rel="next"
                                   href="/2025/11/03/LLM-2-Tokenizer/"
                                   title="å¸¸è§çš„ LLM åˆ†è¯å™¨ï¼ˆTokenizerï¼‰"
                                >
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">å¸¸è§çš„ LLM åˆ†è¯å™¨ï¼ˆTokenizerï¼‰</span>
                                        <span class="post-nav-item">Next posts</span>
                                    </span>
                                    <span class="right arrow-icon flex-center">
                                        <i class="fas fa-chevron-right"></i>
                                    </span>
                                </a>
                            </div>
                        
                    </div>
                

                
                    


    <div class="comments-container border-box">
        <div id="comments-anchor" class="comment-area-title border-box">
            <i class="fas fa-comments"></i>&nbsp;Comments
        </div>
        <div class="comment-plugin-fail border-box">
    <span class="fail-tip">Comment plugin failed to load</span>
    <button class="reload keep-button">Click to reload</button>
</div>
<div class="comment-plugin-loading flex-center border-box">
    <i class="loading-icon fa-solid fa-spinner fa-spin"></i>
    <span class="load-tip">Loading comment plugin</span>
</div>
<script data-pjax>
  window.KeepCommentPlugin = {}
  window.KeepCommentPlugin.hideLoading = () => {
    const cplDom = document.querySelector('.comments-container .comment-plugin-loading')
    cplDom.style.display = 'none'
  }
  window.KeepCommentPlugin.loadFailHandle = () => {
    window.KeepCommentPlugin.hideLoading()
    const cpfDom = document.querySelector('.comments-container .comment-plugin-fail')
    cpfDom.style.display = 'flex'
    cpfDom.querySelector('.reload').addEventListener('click', () => {
      window.location.reload()
    })
  }
</script>

        
            

    <div class="waline-comment-container">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/waline/3.3.2/waline.css"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/waline/3.3.2/waline-meta.css"/>
        <div id="waline-comment"></div>
        <script data-pjax>
          window.KeepCommentPlugin.walineOptions = JSON.parse('{}'.replace(/&#34;/g, '"'))
          window.KeepCommentPlugin.walineOptions.el = '#waline-comment'
          window.KeepCommentPlugin.walineOptions.comment = '.post-comments-count'
          window.KeepCommentPlugin.walineOptions.serverURL = 'https://waline-vercel-two-rho.vercel.app/'
          window.KeepCommentPlugin.walineOptions.lang = 'en' || 'zh-CN'
          window.KeepCommentPlugin.walineOptions.reaction = 'true' === 'true'
        </script>

        

        
            <script 
                    async
                    type="module"
            >
              import { init } from 'https://cdnjs.cloudflare.com/ajax/libs/waline/3.3.2/waline.js'
              window.KeepCommentPlugin.initWaline = () => {
                if (init) {
                  init(window.KeepCommentPlugin.walineOptions)
                  window.KeepCommentPlugin.hideLoading()
                } else {
                  setTimeout(() => {
                    window.KeepCommentPlugin.initWaline()
                  }, 1000)
                }
              }

              if ('false' === 'true') {
                setTimeout(() => {
                  window.KeepCommentPlugin.initWaline()
                }, 1200)
              } else {
                window.addEventListener('DOMContentLoaded', window.KeepCommentPlugin.initWaline)
              }
            </script>
        
    </div>


        
    </div>





                
            </div>
        </div>

        
            <div class="pc-post-toc right-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%95%E8%A8%80%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8Bllm%E7%9A%84%E7%AC%AC%E4%BA%8C%E5%9D%97%E5%9F%BA%E7%9F%B3embedding"><span class="nav-text">ğŸ’¡
å¼•è¨€ï¼šå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„ç¬¬äºŒå—åŸºçŸ³â€”â€”Embedding</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88-embedding-%E6%98%AF-llm-%E7%9A%84%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6"><span class="nav-text">ä¸ºä»€ä¹ˆ Embedding æ˜¯ LLM
çš„æ ¸å¿ƒç»„ä»¶ï¼Ÿ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#one-hot-%E7%BC%96%E7%A0%81%E7%8B%AC%E7%83%AD%E8%A1%A8%E7%A4%BA"><span class="nav-text">1. One-Hot ç¼–ç ï¼ˆç‹¬çƒ­è¡¨ç¤ºï¼‰</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BB%E8%A6%81%E6%80%9D%E6%83%B3%E4%B8%8E%E5%8E%9F%E7%90%86"><span class="nav-text">ğŸ’¡ ä¸»è¦æ€æƒ³ä¸åŸç†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%BA%E7%82%B9%E5%88%86%E6%9E%90"><span class="nav-text">ğŸ§ ç¼ºç‚¹åˆ†æ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8Bpython-%E5%AE%9E%E7%8E%B0"><span class="nav-text">ğŸ’» ç¤ºä¾‹ï¼ˆPython å®ç°ï¼‰</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%8D%E8%A2%8B%E7%BC%96%E7%A0%81%E5%8F%8A%E4%BC%98%E5%8C%96bow-n-gram-tf-idf"><span class="nav-text">2. è¯è¢‹ç¼–ç åŠä¼˜åŒ–ï¼ˆBoW, N-gram,
TF-IDFï¼‰</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BB%E8%A6%81%E6%80%9D%E6%83%B3%E4%B8%8E%E5%8E%9F%E7%90%86-1"><span class="nav-text">ğŸ§  ä¸»è¦æ€æƒ³ä¸åŸç†</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%8D%E8%A2%8B%E6%A8%A1%E5%9E%8B-bag-of-words-bow"><span class="nav-text">2.1 è¯è¢‹æ¨¡å‹ (Bag-of-Words, BoW)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#n-gram"><span class="nav-text">2.2 N-gram</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#tf-idf"><span class="nav-text">2.3 TF-IDF</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8Bscikit-learn-%E5%AE%9E%E7%8E%B0-bow-n-gram-tf-idf"><span class="nav-text">ğŸ’» ç¤ºä¾‹ï¼ˆScikit-learn
å®ç° BoW, N-gram, TF-IDFï¼‰</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#bow%E8%A1%A8%E7%A4%BA%E7%BB%93%E6%9E%9C"><span class="nav-text">BoWè¡¨ç¤ºç»“æœ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#n-gram%E8%A1%A8%E7%A4%BA%E7%BB%93%E6%9E%9C"><span class="nav-text">n-gramè¡¨ç¤ºç»“æœ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#tf-idf%E8%A1%A8%E7%A4%BA%E7%BB%93%E6%9E%9C"><span class="nav-text">TF-IDFè¡¨ç¤ºç»“æœ</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%8D%E5%90%91%E9%87%8Fword-embedding"><span class="nav-text">3. è¯å‘é‡ï¼ˆWord Embeddingï¼‰</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BB%E8%A6%81%E6%80%9D%E6%83%B3%E4%B8%8E%E5%8E%9F%E7%90%86-2"><span class="nav-text">ğŸŒˆ ä¸»è¦æ€æƒ³ä¸åŸç†</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E6%96%B9%E6%B3%95word2vec"><span class="nav-text">å¸¸è§æ–¹æ³•ï¼šWord2Vec</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#cbow-%E8%AE%AD%E7%BB%83%E6%96%B9%E6%B3%95"><span class="nav-text">CBOW è®­ç»ƒæ–¹æ³•</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#skip-gram-%E8%AE%AD%E7%BB%83%E6%96%B9%E6%B3%95"><span class="nav-text">Skip-gram è®­ç»ƒæ–¹æ³•</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%A2%84%E6%B5%8B%E4%BB%BB%E5%8A%A1%E8%83%BD%E5%AD%A6%E5%87%BA%E8%AF%AD%E4%B9%89"><span class="nav-text">ä¸ºä»€ä¹ˆâ€œé¢„æµ‹ä»»åŠ¡â€èƒ½å­¦å‡ºè¯­ä¹‰ï¼Ÿ</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-text">ğŸ“¦ åº”ç”¨åœºæ™¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8Bgensim-word2vec-skip-gram-%E5%AE%9E%E7%8E%B0"><span class="nav-text">ğŸ’» ç¤ºä¾‹ï¼ˆGensim Word2Vec
Skip-gram å®ç°ï¼‰</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%8A%E4%B8%8B%E6%96%87%E5%B5%8C%E5%85%A5contextual-embedding"><span class="nav-text">4. ä¸Šä¸‹æ–‡åµŒå…¥ï¼ˆContextual
Embeddingï¼‰</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BB%E8%A6%81%E6%80%9D%E6%83%B3%E4%B8%8E%E5%8E%9F%E7%90%86-3"><span class="nav-text">ğŸš€ ä¸»è¦æ€æƒ³ä¸åŸç†</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E6%A8%A1%E5%9E%8Bbert-gpt"><span class="nav-text">å¸¸è§æ¨¡å‹ï¼šBERT &amp; GPT</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-1"><span class="nav-text">ğŸ“¦ åº”ç”¨åœºæ™¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8Bhugging-face-transformers-bert-%E8%8E%B7%E5%8F%96token%E8%A1%A8%E7%A4%BA%E5%90%91%E9%87%8F"><span class="nav-text">ğŸ’»
ç¤ºä¾‹ï¼ˆHugging Face Transformers BERT è·å–Tokenè¡¨ç¤ºå‘é‡ï¼‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%99%84%E6%B3%A8"><span class="nav-text">é™„æ³¨</span></a></li></ol></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>
        </div>

        <div class="page-main-content-bottom border-box">
            
<footer class="footer border-box">
    <div class="copyright-info info-item">
    &copy;&nbsp;<span>2020</span>&nbsp;-&nbsp;2026
    
            &nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;&nbsp;<a href="/">Zhongjun Qiu</a>
        
    </div>

    <div class="theme-info info-item">
        Powered by&nbsp;<a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;&&nbsp;Theme&nbsp;<a class="keep-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep</a>
    </div>

    
        
        <div class="deploy-info info-item">
            
                <a target="_blank" rel="nofollow" href="https://github.com">
            
            This site is deployed on <span class="tooltip" data-tooltip-content="GitHub Pages"><img src="/images/brands/github.png"></span>
            
                </a>
            
        </div>
    

    
        <div class="count-info info-item">
            
                <span class="count-item border-box word">
                    <span class="item-type border-box">Total words</span>
                    <span class="item-value border-box word">482.9k</span>
                </span>
            

            

            
                <span class="count-item border-box pv">
                    <span class="item-type border-box">Page View</span>
                    <span class="item-value border-box pv" id="busuanzi_value_site_pv"></span>
                </span>
            
        </div>
    

    
</footer>

        </div>
    </div>

    <!-- post tools -->
    
        <div class="post-tools right-toc">
            <div class="post-tools-container border-box">
    <ul class="post-tools-list border-box">
        <!-- PC encrypt again -->
        

        <!-- PC TOC show toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- PC go comment -->
        
            <li class="tools-item flex-center go-to-comments">
                <i class="fas fa-comment"></i>
                <span class="post-comments-count"></span>
            </li>
        

        <!-- PC full screen -->
        <li class="tools-item flex-center full-screen">
            <i class="fa-solid fa-expand"></i>
        </li>
    </ul>
</div>

        </div>
    

    <!-- side tools -->
    <div class="side-tools">
        <div class="side-tools-container border-box ">
    <ul class="side-tools-list side-tools-show-handle border-box">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <!-- toggle mode -->
        
            <li class="tools-item tool-toggle-theme-mode flex-center">
                <i class="fas fa-moon"></i>
            </li>
        

        <!-- rss -->
        

        <!-- to bottom -->
        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list border-box">
        
            <li class="tools-item toggle-show-toc-tablet flex-center">
                <i class="fas fa-list"></i>
            </li>
        

        
            <li class="tools-item go-to-comments-tablet flex-center">
                <i class="fas fa-comment"></i>
            </li>
        

        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>

        <li class="tools-item tool-scroll-to-top flex-center show-arrow">
            <i class="arrow fas fa-arrow-up"></i>
            <span class="percent"></span>
        </li>
    </ul>
</div>

    </div>

    <!-- image mask -->
    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    <!-- local search -->
    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

    <!-- tablet toc -->
    
        <div class="tablet-post-toc-mask">
            <div class="tablet-post-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%95%E8%A8%80%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8Bllm%E7%9A%84%E7%AC%AC%E4%BA%8C%E5%9D%97%E5%9F%BA%E7%9F%B3embedding"><span class="nav-text">ğŸ’¡
å¼•è¨€ï¼šå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„ç¬¬äºŒå—åŸºçŸ³â€”â€”Embedding</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88-embedding-%E6%98%AF-llm-%E7%9A%84%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6"><span class="nav-text">ä¸ºä»€ä¹ˆ Embedding æ˜¯ LLM
çš„æ ¸å¿ƒç»„ä»¶ï¼Ÿ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#one-hot-%E7%BC%96%E7%A0%81%E7%8B%AC%E7%83%AD%E8%A1%A8%E7%A4%BA"><span class="nav-text">1. One-Hot ç¼–ç ï¼ˆç‹¬çƒ­è¡¨ç¤ºï¼‰</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BB%E8%A6%81%E6%80%9D%E6%83%B3%E4%B8%8E%E5%8E%9F%E7%90%86"><span class="nav-text">ğŸ’¡ ä¸»è¦æ€æƒ³ä¸åŸç†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%BA%E7%82%B9%E5%88%86%E6%9E%90"><span class="nav-text">ğŸ§ ç¼ºç‚¹åˆ†æ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8Bpython-%E5%AE%9E%E7%8E%B0"><span class="nav-text">ğŸ’» ç¤ºä¾‹ï¼ˆPython å®ç°ï¼‰</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%8D%E8%A2%8B%E7%BC%96%E7%A0%81%E5%8F%8A%E4%BC%98%E5%8C%96bow-n-gram-tf-idf"><span class="nav-text">2. è¯è¢‹ç¼–ç åŠä¼˜åŒ–ï¼ˆBoW, N-gram,
TF-IDFï¼‰</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BB%E8%A6%81%E6%80%9D%E6%83%B3%E4%B8%8E%E5%8E%9F%E7%90%86-1"><span class="nav-text">ğŸ§  ä¸»è¦æ€æƒ³ä¸åŸç†</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%8D%E8%A2%8B%E6%A8%A1%E5%9E%8B-bag-of-words-bow"><span class="nav-text">2.1 è¯è¢‹æ¨¡å‹ (Bag-of-Words, BoW)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#n-gram"><span class="nav-text">2.2 N-gram</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#tf-idf"><span class="nav-text">2.3 TF-IDF</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8Bscikit-learn-%E5%AE%9E%E7%8E%B0-bow-n-gram-tf-idf"><span class="nav-text">ğŸ’» ç¤ºä¾‹ï¼ˆScikit-learn
å®ç° BoW, N-gram, TF-IDFï¼‰</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#bow%E8%A1%A8%E7%A4%BA%E7%BB%93%E6%9E%9C"><span class="nav-text">BoWè¡¨ç¤ºç»“æœ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#n-gram%E8%A1%A8%E7%A4%BA%E7%BB%93%E6%9E%9C"><span class="nav-text">n-gramè¡¨ç¤ºç»“æœ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#tf-idf%E8%A1%A8%E7%A4%BA%E7%BB%93%E6%9E%9C"><span class="nav-text">TF-IDFè¡¨ç¤ºç»“æœ</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%8D%E5%90%91%E9%87%8Fword-embedding"><span class="nav-text">3. è¯å‘é‡ï¼ˆWord Embeddingï¼‰</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BB%E8%A6%81%E6%80%9D%E6%83%B3%E4%B8%8E%E5%8E%9F%E7%90%86-2"><span class="nav-text">ğŸŒˆ ä¸»è¦æ€æƒ³ä¸åŸç†</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E6%96%B9%E6%B3%95word2vec"><span class="nav-text">å¸¸è§æ–¹æ³•ï¼šWord2Vec</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#cbow-%E8%AE%AD%E7%BB%83%E6%96%B9%E6%B3%95"><span class="nav-text">CBOW è®­ç»ƒæ–¹æ³•</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#skip-gram-%E8%AE%AD%E7%BB%83%E6%96%B9%E6%B3%95"><span class="nav-text">Skip-gram è®­ç»ƒæ–¹æ³•</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%A2%84%E6%B5%8B%E4%BB%BB%E5%8A%A1%E8%83%BD%E5%AD%A6%E5%87%BA%E8%AF%AD%E4%B9%89"><span class="nav-text">ä¸ºä»€ä¹ˆâ€œé¢„æµ‹ä»»åŠ¡â€èƒ½å­¦å‡ºè¯­ä¹‰ï¼Ÿ</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-text">ğŸ“¦ åº”ç”¨åœºæ™¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8Bgensim-word2vec-skip-gram-%E5%AE%9E%E7%8E%B0"><span class="nav-text">ğŸ’» ç¤ºä¾‹ï¼ˆGensim Word2Vec
Skip-gram å®ç°ï¼‰</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%8A%E4%B8%8B%E6%96%87%E5%B5%8C%E5%85%A5contextual-embedding"><span class="nav-text">4. ä¸Šä¸‹æ–‡åµŒå…¥ï¼ˆContextual
Embeddingï¼‰</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BB%E8%A6%81%E6%80%9D%E6%83%B3%E4%B8%8E%E5%8E%9F%E7%90%86-3"><span class="nav-text">ğŸš€ ä¸»è¦æ€æƒ³ä¸åŸç†</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E6%A8%A1%E5%9E%8Bbert-gpt"><span class="nav-text">å¸¸è§æ¨¡å‹ï¼šBERT &amp; GPT</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-1"><span class="nav-text">ğŸ“¦ åº”ç”¨åœºæ™¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8Bhugging-face-transformers-bert-%E8%8E%B7%E5%8F%96token%E8%A1%A8%E7%A4%BA%E5%90%91%E9%87%8F"><span class="nav-text">ğŸ’»
ç¤ºä¾‹ï¼ˆHugging Face Transformers BERT è·å–Tokenè¡¨ç¤ºå‘é‡ï¼‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%99%84%E6%B3%A8"><span class="nav-text">é™„æ³¨</span></a></li></ol></li></ol>
    </div>
</div>

            </div>
        </div>
    
</main>





<!-- common js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/utils.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/header-shrink.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/back2top.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/toggle-theme.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/code-block.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/main.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/libs/anime.min.js"></script>

<!-- local search -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/local-search.min.js"></script>


<!-- lazyload -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/lazyload.min.js"></script>


<div class="">
    <!-- home page -->
    

    <!-- post page -->
    
        <!-- post-helper -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/post/post-helper.min.js"></script>

        <!-- toc -->
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/post/toc.min.js"></script>
        

        <!-- copyright-info -->
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/post/copyright-info.min.js"></script>
        

        <!-- share -->
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/post/share.min.js"></script>
        
    

    <!-- categories page -->
    

    <!-- links page -->
    

    <!-- photos page -->
    

    <!-- tools page -->
    
</div>

<!-- mermaid -->


<!-- pjax -->



    
        
    
        
            
<script class="custom-inject-js" src="/js/custom_code_block.js" data-pjax></script>

        
    

</body>
</html>
