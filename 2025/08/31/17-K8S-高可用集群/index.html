<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="blog, decade, lucky">
    <meta name="description" content="Decade&#39;s lucky blog">
    <meta name="author" content="Zhongjun Qiu">
    
    <title>
        
            Kubernete é«˜å¯ç”¨é›†ç¾¤ |
        
        Decade
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
        <link rel="shortcut icon" href="https://decade.net.cn/images/logo.ico">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/font/css/fontawesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/font/css/regular.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/font/css/solid.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/font/css/brands.min.css">
    
        
            
        
            
                
<link rel="stylesheet" href="/css/custom.css">

            
        
    
    <script class="keep-theme-configurations">
    const KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"decade.net.cn","root":"/","language":"en","path":"search.json"}
    KEEP.theme_config = {"base_info":{"primary_color":"#0066cc","title":"Decade","author":"Zhongjun Qiu","avatar":"/images/avatar.ico","logo":"/images/avatar.ico","favicon":"https://decade.net.cn/images/logo.ico"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","tags":"/tags || fa-solid fa-tags","categories":"/categories || fa-solid fa-layer-group","more":{"icon":"fa-solid fa-circle-user","children":[{"tool":"/tools || fa-solid fa-tools"},{"life":"/photos || fa-solid fa-image"},{"me":"/about || fa-solid fa-user-graduate"},{"Git":"/custom/index.html || fa-solid fa-user"}]}},"first_screen":{"enable":true,"background_img":"/images/bg.svg","background_img_dark":"/images/bg.svg","description":"The Steadfast Determination of An Ordinary Soul.","hitokoto":false},"social_contact":{"enable":true,"links":{"github":"https://github.com/Decade-qiu","weixin":"img | /images/social/weixin.jpg","qq":null,"weibo":null,"zhihu":null,"twitter":null,"x":null,"facebook":null,"email":"qiuyu6021@gmail.com"}},"scroll":{"progress_bar":true,"percent":true,"hide_header":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-history","post_datetime_format":"ago"},"post":{"author_badge":{"enable":true,"level_badge":false,"custom_badge":"å…ƒå©´å¼€å‘è€…"},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":true,"reward":{"enable":true,"img_link":"/images/post/payment.jpg","text":null,"icon":null},"created_datetime_icon":"fa-solid fa-calendar-plus","updated_datetime_icon":"fa-solid fa-arrows-rotate"},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":false,"init_open":false,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":false,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":true},"comment":{"enable":true,"use":"waline","valine":{"appid":null,"appkey":null,"server_urls":null,"placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.39"},"waline":{"server_url":"https://waline-vercel-two-rho.vercel.app/","reaction":true,"version":"3.3.2"},"giscus":{"repo":null,"repo_id":null,"category":"Announcements","category_id":null,"reactions_enabled":false},"artalk":{"server":null},"disqus":{"shortname":null}},"rss":{"enable":false},"lazyload":{"enable":true},"cdn":{"enable":true,"provider":"cdnjs"},"pjax":{"enable":false},"footer":{"since":2020,"word_count":true,"site_deploy":{"enable":true,"provider":"github","url":"https://github.com"},"record":{"enable":false,"list":[{"code":null,"link":null}]}},"inject":{"enable":true,"css":[null,"/css/custom.css"],"js":[null,"/js/custom_code_block.js"]},"root":"","source_data":{"photos":[{"url":"/images/post/ã€å“²é£å£çº¸ã€‘æ—¥æœ¬åŠ¨æ¼«-ç”µé”¯äºº.webp","name":"ç”µé”¯äºº"},{"url":"/images/post/Quicker_20250428_193139.webp","name":"kowayia"},{"url":"/images/post/Quicker_20250428_233349.webp","name":"ä¸–ç•Œåœ°å›¾"},{"url":"/images/post/tmpFE1E.tmp.webp","name":"æ–½çº¢"},{"url":"/images/post/result-1745849388402.webp","name":"ä»‡å¿ éª.åŠ¨æ¼«ç‰ˆ"},{"url":"/images/photos/çŒ«çŒ«å›°äº†PNG.png","name":"çŒ«çŒ«å›°äº†PNG"},{"url":"/images/photos/å®é™çš„æš´é›¨å¤©.png","name":"å®é™çš„æš´é›¨å¤©"},{"url":"/images/photos/æˆ‘åœ¨æ‰¬å·å¥½æƒ³ä½ .png","name":"æˆ‘åœ¨æ‰¬å·å¥½æƒ³ä½ "},{"url":"/images/photos/ä¿¡é¸½.png","name":"ä¿¡é¸½"},{"url":"/images/photos/å•¤é…’çƒ§çƒ¤.png","name":"å•¤é…’çƒ§çƒ¤"},{"url":"/images/photos/éšæ‰‹æ‹.png","name":"éšæ‰‹æ‹"},{"url":"/images/photos/ç³–æ²¹æ··åˆç‚¸å¼¹.png","name":"ç³–æ²¹æ··åˆç‚¸å¼¹"},{"url":"/images/photos/é¦™é¦™çš„.png","name":"é¦™é¦™çš„"},{"url":"/images/photos/èå­è±è±.png","name":"èå­è±è±"},{"url":"/images/post/æŒ‡Cä¸ºpython.png","name":"æŒ‡Cä¸ºpython"},{"url":"/images/photos/YangZhou_Station.png","name":"YangZhou Station"},{"url":"/images/photos/GBC.jpg","name":"Girls Band Cry"},{"url":"/images/photos/bocchi.webp","name":"Bocchi the Rock!"}],"tools":[{"category":"AIGC","anchorId":"QUlHQw0"},{"name":"ChatGPT","link":"https://chat.openai.com/","description":"OpenAI æ——ä¸‹ AI èŠå¤©å¯¹è¯å·¥å…·","image":"/images/tools/chatgpt.svg"},{"name":"Gemini","link":"https://gemini.google.com/app","description":"Google æ——ä¸‹ AI èŠå¤©å¯¹è¯å·¥å…·","image":"/images/tools/gemini.svg"},{"name":"Copilot","link":"https://copilot.microsoft.com/","description":"Microsoft æ——ä¸‹ AI èŠå¤©å¯¹è¯å·¥å…·","image":"/images/tools/copilot.png"},{"name":"Deepseek","link":"https://chat.deepseek.com/","description":"Deepseek æ——ä¸‹ AI èŠå¤©å¯¹è¯å·¥å…·","image":"/images/tools/deepseek.jpg"},{"name":"Qwen","link":"https://chat.qwen.ai/","description":"Alibaba æ——ä¸‹ AI èŠå¤©å¯¹è¯å·¥å…·","image":"/images/tools/tongyiqianwen.svg"},{"name":"å³æ¢¦AI","link":"https://jimeng.jianying.com/ai-tool/home","description":"Dreamina å›¾åƒç”Ÿæˆå·¥å…·","image":"/images/tools/dream.png"},{"name":"komiko","link":"https://komiko.app/home","description":"Komiko åŠ¨æ¼«åŒ–AIå·¥å…·","image":"/images/tools/komiko.webp"},{"name":"InsMind","link":"https://www.insmind.com/zh-cn/workspace/","description":"AIå›¾ç‰‡ç¼–è¾‘å·¥å…·","image":"/images/tools/insmind.svg"},{"name":"Raphael","link":"https://raphael.app/zh","description":"AIå›¾ç‰‡ç”Ÿæˆå·¥å…·","image":"/images/tools/rap.png"},{"name":"è…¾è®¯å…ƒå®","link":"https://yuanbao.tencent.com/chat/","description":"Tencent æ——ä¸‹ AI èŠå¤©å¯¹è¯å·¥å…·","image":"/images/tools/tencent.jpg"},{"name":"è±†åŒ…","link":"https://www.doubao.com/chat/","description":"å­—èŠ‚è·³åŠ¨ å›¾ç‰‡ç”Ÿæˆå·¥å…·","image":"/images/tools/dn.jpg"},{"category":"Airport","anchorId":"QWlycG9ydA12"},{"name":"ç‹¬è§’å…½","link":"https://91unicorn.cloud/","description":"ååˆ†ç¨³å®š","image":"/images/tools/dujiaoshou.ico"},{"name":"æé€Ÿæœºåœº","link":"https://xn--mes358acgm99l.com/","description":"ä¾¿å®œå¥½ç”¨","image":"/images/tools/jisu.ico"},{"name":"iKuuu","link":"https://ikuuu.org/user","description":"ä»¥å¤‡ä¸æ—¶ä¹‹éœ€","image":"/images/tools/ikuu.ico"},{"category":"File Converter","anchorId":"RmlsZSUyMENvbnZlcnRlcg16"},{"name":"Online Image Tool","link":"https://www.onlineimagetool.com/zh/","description":"åœ¨çº¿å‹ç¼©å’Œè½¬æ¢å›¾ç‰‡","image":"/images/tools/oit.png"},{"name":"Vector Magic","link":"https://zh.vectormagic.com/","description":"æ–‡ä»¶çŸ¢é‡åŒ–","image":"/images/tools/apple-touch-icon-180_97956a9f5fbf6a767de100280d78c1f8.png"},{"name":"TinyPNG","link":"https://tinypng.com/","description":"Smart AVIF, WebP, PNG and JPEG Compression for Faster Websites","image":"/images/tools/tiny.ico"},{"name":"è¸å¾—","link":"https://techbrood.com/tool","description":"HTML5åœ¨çº¿å·¥å…·","image":"/images/tools/td.ico"},{"name":"UUåœ¨çº¿å·¥å…·","link":"https://uutool.cn/base64/","description":"base64å·¥å…·åŒ…","image":"/images/tools/uu.png"},{"name":"I Love PDF","link":"https://www.ilovepdf.com/","description":"PDFå·¥å…·åŒ…","image":"/images/tools/ilovepdf.svg"},{"category":"Free GPT API","anchorId":"RnJlZSUyMEdQVCUyMEFQSQ23"},{"name":"Gemini API","link":"https://ai.google.dev/gemini-api/docs/quickstart?lang=python","description":"Google Gemini API","image":"/images/tools/touchicon-180-new.png"},{"name":"SiliconCloud","link":"https://cloud.siliconflow.cn/models","description":"å„ç§æ¨¡å‹API"},{"name":"Cloudflare Workers AI","link":"https://developers.cloudflare.com/workers-ai/configuration/open-ai-compatibility/","description":"OpenAI compatible API endpoints","image":"/images/tools/logo.p_ySeMR1.svg"},{"name":"ç®—äº†ä¹ˆ","link":"https://api.suanli.cn/","description":"å…±äº«ç®—åŠ›API","image":"/images/tools/suanlm.svg"},{"category":"Resource Explorer","anchorId":"UmVzb3VyY2UlMjBFeHBsb3Jlcg28"},{"name":"Free for Developers","link":"https://free-for.dev/","description":"A list of SaaS, PaaS and IaaS offerings that have free tiers of interest to devops and infradev","image":"/images/tools/freefd.webp"},{"name":"zlibrary","link":"https://zh.z-library.sk/","description":"åœ¨çº¿å›¾ä¹¦é¦†","image":"/images/tools/logo.zlibrary.svg"},{"name":"PicX","link":"https://picx.xpoet.cn/","description":"åŸºäºGithubçš„å›¾åºŠ","image":"/images/tools/logo.ffee4291.png"},{"name":"HaoWallpaper","link":"https://haowallpaper.com/","description":"å“²é£å£çº¸","image":"/images/tools/haowall.ico"},{"name":"Awesome","link":"https://wallhaven.cc/","description":"WallHaven","image":"/images/tools/wallheaven.ico"},{"name":"WallHere","link":"https://wallhere.com/","description":"WallHere"},{"name":"SnapAny","link":"https://snapany.com/zh","description":"ä¸‡èƒ½è§†é¢‘å›¾ç‰‡è§£æä¸‹è½½"},{"name":"Ã˜Magnet","link":"https://0cili.org/","description":"ç§å­ä¸‹è½½"},{"name":"twitter","link":"https://snapvid.net/zh-cn/twitter-downloader","description":"æ¨ç‰¹è§†é¢‘ä¸‹è½½å™¨","image":"/images/tools/apple-touch-icon.png"},{"name":"youtube","link":"https://www.y2mate.com/en949","description":"Youtubeè§†é¢‘ä¸‹è½½å™¨","image":"/images/tools/y2mate.webp"},{"name":"Icons8","link":"https://icons8.com/icons","description":"å…è´¹å›¾æ ‡ä¸‹è½½","image":"/images/tools/logo-icons8.svg"},{"name":"å…¨èƒ½emoji","link":"https://www.emojiall.com/zh-hans","description":"emojiåˆ¶ä½œ","image":"/images/tools/emoji.ico"},{"name":"emojidb","link":"https://emojidb.org/","description":"å…è´¹è¡¨æƒ…åŒ…ä¸‹è½½","image":"/images/tools/emojidb.png"},{"name":"Flaticon","link":"https://www.flaticon.com/","description":"å…è´¹å›¾æ ‡ä¸‹è½½","image":"/images/tools/logo-flaticon.svg"},{"name":"IconFinder","link":"https://www.iconfinder.com/","description":"å…è´¹å›¾æ ‡ä¸‹è½½","image":"/images/tools/logo-iconfinder.svg"}]},"version":"4.2.5"}
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"}
    KEEP.language_code_block = {"copy":"Copy code","copied":"Copied","fold":"Fold code block","folded":"Folded"}
    KEEP.language_copy_copyright = {"copy":"Copy copyright info","copied":"Copied","title":"Original post title","author":"Original post author","link":"Original post link"}
  </script>
<meta name="generator" content="Hexo 7.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
</div>



<main class="page-container border-box">
    <!-- home first screen  -->
    

    <!-- page content -->
    <div class="page-main-content border-box">
        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="border-box header-content">
        <div class="left flex-start border-box">
            
                <a class="logo-image border-box" href="/">
                    <img src="/images/avatar.ico">
                </a>
            
            <a class="site-name border-box" href="/">
               Decade
            </a>
        </div>

        <div class="right border-box">
            <div class="pc border-box">
                <ul class="menu-list border-box">
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-home"></i>
                                
                                HOME
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/archives">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-box-archive"></i>
                                
                                ARCHIVES
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/tags">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-tags"></i>
                                
                                TAGS
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/categories">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-layer-group"></i>
                                
                                CATEGORIES
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box has-sub-menu">
                            <a class="menu-text-color border-box" href="javascript:void(0);">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-circle-user"></i>
                                
                                MORE
                                
                                    <i class="menu-text-color collapse-icon fa-solid fa-angle-down"></i>
                                
                            </a>
                            
                                <ul class="sub-menu-list border-box">
                                    
                                        
                                        <li class="sub-menu-item border-box ">
                                            <a class="menu-text-color border-box flex-start" href="/tools">
                                                
                                                    <i class="menu-text-color sub-menu-icon fa-solid fa-tools"></i>
                                                
                                                TOOL
                                            </a>
                                        </li>
                                    
                                        
                                        <li class="sub-menu-item border-box ">
                                            <a class="menu-text-color border-box flex-start" href="/photos">
                                                
                                                    <i class="menu-text-color sub-menu-icon fa-solid fa-image"></i>
                                                
                                                LIFE
                                            </a>
                                        </li>
                                    
                                        
                                        <li class="sub-menu-item border-box ">
                                            <a class="menu-text-color border-box flex-start" href="/about">
                                                
                                                    <i class="menu-text-color sub-menu-icon fa-solid fa-user-graduate"></i>
                                                
                                                ME
                                            </a>
                                        </li>
                                    
                                        
                                        <li class="sub-menu-item border-box ">
                                            <a class="menu-text-color border-box flex-start" href="/custom/">
                                                
                                                    <i class="menu-text-color sub-menu-icon fa-solid fa-user"></i>
                                                
                                                GIT
                                            </a>
                                        </li>
                                    
                                </ul>
                            
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="menu-text-color fas search fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile border-box flex-start">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list border-box">
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-home"></i>
                                </span>
                            
                            HOME
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/archives">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-box-archive"></i>
                                </span>
                            
                            ARCHIVES
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/tags">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-tags"></i>
                                </span>
                            
                            TAGS
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/categories">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-layer-group"></i>
                                </span>
                            
                            CATEGORIES
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box has-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="javascript:void(0);">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-circle-user"></i>
                                </span>
                            
                            MORE
                        </a>
                        
                            <i class="right-side collapse-icon fa-solid fa-angle-left"></i>
                        
                    </label>
                    
                        <ul class="drawer-sub-menu-list border-box">
                            
                                
                                <li class="sub-menu-item border-box">
                                    <a class="drawer-menu-text-color border-box flex-start" href="/tools">
                                        
                                            <span class="sub-menu-icon-wrap border-box flex-center">
                                                <i class="drawer-menu-text-color sub-menu-icon fa-solid fa-tools"></i>
                                            </span>
                                        
                                        TOOL
                                    </a>
                                </li>
                            
                                
                                <li class="sub-menu-item border-box">
                                    <a class="drawer-menu-text-color border-box flex-start" href="/photos">
                                        
                                            <span class="sub-menu-icon-wrap border-box flex-center">
                                                <i class="drawer-menu-text-color sub-menu-icon fa-solid fa-image"></i>
                                            </span>
                                        
                                        LIFE
                                    </a>
                                </li>
                            
                                
                                <li class="sub-menu-item border-box">
                                    <a class="drawer-menu-text-color border-box flex-start" href="/about">
                                        
                                            <span class="sub-menu-icon-wrap border-box flex-center">
                                                <i class="drawer-menu-text-color sub-menu-icon fa-solid fa-user-graduate"></i>
                                            </span>
                                        
                                        ME
                                    </a>
                                </li>
                            
                                
                                <li class="sub-menu-item border-box">
                                    <a class="drawer-menu-text-color border-box flex-start" href="/custom/">
                                        
                                            <span class="sub-menu-icon-wrap border-box flex-center">
                                                <i class="drawer-menu-text-color sub-menu-icon fa-solid fa-user"></i>
                                            </span>
                                        
                                        GIT
                                    </a>
                                </li>
                            
                        </ul>
                    
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle border-box">

            <div class="main-content border-box">
                

                    
<div class="fade-in-down-animation">
    <div class="post-page-container border-box">
        <div class="post-content-container border-box">
            

            <div class="post-content-bottom border-box">
                
                    <div class="post-title">
                        Kubernete é«˜å¯ç”¨é›†ç¾¤
                    </div>
                

                
                    <div class="post-header border-box">
                        
                            <div class="avatar-box border-box">
                                <img src="/images/avatar.ico">
                            </div>
                        
                        <div class="info-box">
                            <div class="author border-box">
                                <span class="name">Zhongjun Qiu</span>
                                
                                    <span class="author-badge">å…ƒå©´å¼€å‘è€…</span>
                                
                            </div>
                            <div class="meta-info border-box">
                                

<div class="post-meta-info-container border-box post">
    <div class="post-meta-info border-box">
        

        
            <span class="meta-info-item post-create-date">
                <i class="icon fa-solid fa-calendar-plus"></i>&nbsp;
                <span class="datetime">2025-08-31 20:23:26</span>
            </span>

            
                <span class="meta-info-item post-update-date">
                    <i class="icon fa-solid fa-arrows-rotate"></i>&nbsp;
                    <span class="datetime" data-updated="Fri Sep 05 2025 16:38:13 GMT+0800">2025-09-05 16:38:13</span>
                </span>
            
        

        
            <span class="meta-info-item post-category border-box"><i class="icon fas fa-folder"></i>&nbsp;
                <ul class="post-category-ul">
                    
                            <li class="category-item"><a href="/categories/K8S/">K8S</a></li>
                        
                    
                            <li class="category-item">&nbsp;<i class="icon fas fa-angle-right"></i>&nbsp;<a href="/categories/K8S/HA/">HA</a></li>
                        
                    
                </ul>
            </span>
        

        
            <span class="post-tag meta-info-item border-box">
                <ul class="post-tag-ul">
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/K8S/">K8S</a></li>
                        
                    
                </ul>
            </span>
        

        
        
            <span class="meta-info-item post-wordcount">
                <i class="icon fas fa-file-word"></i>&nbsp;<span>5.1k Words</span>
            </span>
        
        
            <span class="meta-info-item post-min2read">
                <i class="icon fas fa-clock"></i>&nbsp;<span>17 Mins</span>
            </span>
        
        
            <span class="meta-info-item post-pv">
                <i class="icon fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
            </span>
        
    </div>

    
</div>

                            </div>
                        </div>
                    </div>
                

                <div class="post-content keep-markdown-body ">
                    

                    
                         <p>Kubernetes çš„é«˜å¯ç”¨ï¼ˆHigh Availability,
HAï¼‰é›†ç¾¤è®¾è®¡æ—¨åœ¨ç¡®ä¿é›†ç¾¤åœ¨é¢å¯¹èŠ‚ç‚¹æ•…éšœã€ç½‘ç»œåˆ†åŒºæˆ–å…¶ä»–æ„å¤–æƒ…å†µæ—¶ï¼Œä»èƒ½æŒç»­æä¾›æœåŠ¡ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»
K8S çš„æ ¸å¿ƒç»„ä»¶åŠå…¶é«˜å¯ç”¨å®ç°æ–¹å¼ã€‚</p>
<span id="more"></span>
<h2 id="k8sæ ¸å¿ƒç»„ä»¶">K8Sæ ¸å¿ƒç»„ä»¶</h2>
<figure>
<img lazyload="" alt="image-20250830215147462" data-src="/Users/qzj/Desktop/Development/Hexo-blog-source/source/_posts/pictures/17-K8S-é«˜å¯ç”¨é›†ç¾¤/image-20250830215147462.png">
<figcaption aria-hidden="true">image-20250830215147462</figcaption>
</figure>
<h3 id="k8s-api-server">K8S API Server</h3>
<p>K8S æ§åˆ¶å¹³é¢çš„æ ¸å¿ƒç»„ä»¶ï¼Œè¿è¡Œåœ¨ Master
èŠ‚ç‚¹ä¸Šï¼Œè´Ÿè´£æ¥æ”¶å’Œå¤„ç†æ‰€æœ‰é’ˆå¯¹é›†ç¾¤çš„ REST API è°ƒç”¨ã€‚</p>
<ul>
<li>ä¸ºç”¨æˆ·ã€æ§åˆ¶å¹³é¢ç»„ä»¶ä»¥åŠå¤–éƒ¨ç³»ç»Ÿæä¾›ç»Ÿä¸€çš„è®¿é—®å…¥å£ã€‚</li>
<li>æ‰€æœ‰æ¨¡å—é€šè¿‡ API Server å°†æ•°æ®å†™å…¥
etcdï¼›å½“éœ€è¦è·å–æˆ–æ“ä½œæ•°æ®æ—¶ï¼Œä¹Ÿé€šè¿‡ API Server æä¾›çš„ REST æ¥å£ï¼ˆå¦‚
GET/LIST/WATCHï¼‰è¿›è¡Œäº¤äº’ã€‚</li>
<li>ç”¨æˆ·é€šå¸¸é€šè¿‡ kubectl/kubeadm ç­‰å·¥å…·é—´æ¥è®¿é—® API
Serverï¼Œä¹Ÿå¯ä»¥ç›´æ¥å‘é€ REST è¯·æ±‚ã€‚</li>
</ul>
<p>ğŸ‘‰
æ¥æ”¶æµé‡å¯¹è±¡ï¼šSchedulerã€Controllerã€Kubeletã€Kube-Proxyã€kubectl/å¤–éƒ¨å®¢æˆ·ç«¯
ğŸ‘‰ å‘é€æµé‡å¯¹è±¡ï¼šetcd</p>
<h3 id="k8s-scheduler">K8S Scheduler</h3>
<p>K8S çš„è°ƒåº¦å™¨ï¼Œè¿è¡Œåœ¨ Master èŠ‚ç‚¹ä¸Šã€‚</p>
<ul>
<li>æŒç»­ç›‘å¬ API Serverï¼Œå‘ç°å¤„äº <strong>å¾…è°ƒåº¦çŠ¶æ€</strong> çš„ Podï¼ˆå³
PodSpec.NodeName ä¸ºç©ºï¼‰ã€‚</li>
<li>æ ¹æ®èµ„æºéœ€æ±‚ã€èŠ‚ç‚¹è´Ÿè½½ã€äº²å’Œ/åäº²å’Œç­–ç•¥ç­‰æ¡ä»¶ç­›é€‰å€™é€‰èŠ‚ç‚¹ï¼ˆé¢„é€‰ï¼‰ã€‚</li>
<li>å¯¹å€™é€‰èŠ‚ç‚¹è¿›è¡Œæ‰“åˆ†æ’åºï¼Œé€‰å‡ºæœ€ä¼˜èŠ‚ç‚¹ï¼ˆä¼˜é€‰ï¼‰ï¼Œå¹¶é€šè¿‡ <strong>Binding
å¯¹è±¡</strong> å°†è°ƒåº¦ç»“æœå†™å› API Serverã€‚</li>
</ul>
<p>ğŸ‘‰ å‘é€æµé‡å¯¹è±¡ï¼šAPI Server</p>
<h3 id="k8s-controller">K8S Controller</h3>
<p>æ§åˆ¶å™¨ç®¡ç†å™¨ï¼Œè¿è¡Œåœ¨ Master
èŠ‚ç‚¹ä¸Šï¼Œè´Ÿè´£è¿è¡Œå¤šä¸ªæ§åˆ¶å¾ªç¯ï¼ˆControllerï¼‰ã€‚</p>
<ul>
<li><p>æ¯ä¸ª Controller è´Ÿè´£ç»´æŒæŸç±»èµ„æºçš„æœŸæœ›çŠ¶æ€ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>NodeControllerï¼šæ£€æµ‹å’Œç®¡ç†èŠ‚ç‚¹å¥åº·ï¼›</li>
<li>ReplicaSetControllerï¼šç¡®ä¿å‰¯æœ¬æ•°ä¸æœŸæœ›ä¸€è‡´ï¼›</li>
<li>EndpointControllerï¼šç»´æŠ¤ Service ä¸ Endpoint çš„å¯¹åº”å…³ç³»ï¼›</li>
<li>å…¶ä»–æ§åˆ¶å™¨ï¼šNamespaceControllerã€ServiceAccountController ç­‰ã€‚</li>
</ul></li>
<li><p>é€šè¿‡ç›‘å¬ API Server
è·å–èµ„æºçš„å½“å‰çŠ¶æ€ï¼Œå½“å‘ç°ä¸æœŸæœ›çŠ¶æ€ä¸ç¬¦æ—¶ï¼Œè§¦å‘ç›¸åº”çš„ä¿®å¤æ“ä½œã€‚</p></li>
</ul>
<p>ğŸ‘‰ å‘é€æµé‡å¯¹è±¡ï¼šAPI Serverï¼ˆæ‰€æœ‰çŠ¶æ€ç›‘æ§ä¸ä¿®å¤æ“ä½œå‡ç»ç”± API
Serverï¼‰</p>
<h3 id="etcd">etcd</h3>
<p>K8S çš„åˆ†å¸ƒå¼é”®å€¼å­˜å‚¨ï¼Œæä¾›å¼ºä¸€è‡´æ€§å’Œé«˜å¯ç”¨æ€§ã€‚</p>
<ul>
<li>ä¿å­˜ K8S çš„ <strong>å®Œæ•´é›†ç¾¤çŠ¶æ€æ•°æ®</strong>ï¼ˆå¦‚
Podã€Serviceã€Secretsã€ConfigMap ç­‰ï¼‰ã€‚</li>
<li><strong>ä»…æœ‰ API Server å¯ä»¥ç›´æ¥è¯»å†™ etcd</strong>ï¼Œå…¶ä»–ç»„ä»¶å¿…é¡»é€šè¿‡
API Server è¿›è¡Œè®¿é—®ã€‚</li>
</ul>
<p>ğŸ‘‰ æ¥æ”¶æµé‡å¯¹è±¡ï¼šAPI Server</p>
<h3 id="kubelet">Kubelet</h3>
<p>è¿è¡Œåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„èŠ‚ç‚¹ä»£ç†ã€‚</p>
<ul>
<li>æ¥æ”¶æ¥è‡ª API Server çš„ PodSpecï¼Œç¡®ä¿å®¹å™¨æŒ‰è§„èŒƒè¿è¡Œã€‚</li>
<li>å®šæœŸä¸ŠæŠ¥èŠ‚ç‚¹ä¸ Pod çš„çŠ¶æ€ä¿¡æ¯ã€‚</li>
<li>ä¸å®¹å™¨è¿è¡Œæ—¶ï¼ˆå¦‚
Dockerã€containerdã€CRI-Oï¼‰äº¤äº’ï¼Œè´Ÿè´£é•œåƒæ‹‰å–ã€å®¹å™¨åˆ›å»ºä¸é”€æ¯ã€‚</li>
<li>æ‰§è¡Œå­˜æ´»æ¢é’ˆï¼ˆlivenessï¼‰ä¸å°±ç»ªæ¢é’ˆï¼ˆreadinessï¼‰ï¼Œå¹¶ä¸ŠæŠ¥å®¹å™¨å¥åº·çŠ¶æ€ã€‚</li>
</ul>
<p>ğŸ‘‰ å‘é€æµé‡å¯¹è±¡ï¼šAPI Serverï¼ˆè·å– PodSpecã€ä¸ŠæŠ¥çŠ¶æ€ï¼‰</p>
<h3 id="kube-proxy">Kube-Proxy</h3>
<p>è¿è¡Œåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„ç½‘ç»œä»£ç†ç»„ä»¶ã€‚</p>
<ul>
<li>ç»´æŠ¤ iptables/ipvs è§„åˆ™ï¼Œç¡®ä¿ Service çš„æµé‡èƒ½æ­£ç¡®åˆ†å‘è‡³å¯¹åº”çš„
Podã€‚</li>
<li>ä¿éšœé›†ç¾¤å†…éƒ¨ Pod ä¸ Service çš„ç½‘ç»œé€šä¿¡ã€‚</li>
<li>åœ¨æŸäº›ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå¯èƒ½è¢« Ingress Controllerã€Nginx æˆ– HAProxy
ç­‰æ–¹æ¡ˆæ›¿ä»£ã€‚</li>
</ul>
<p>ğŸ‘‰ å‘é€æµé‡å¯¹è±¡ï¼šAPI Serverï¼ˆè·å– Service ä¸ Endpoint
ä¿¡æ¯ï¼‰ã€å„èŠ‚ç‚¹çš„ç½‘ç»œæ ˆ</p>
<h2 id="k8sé«˜å¯ç”¨haé›†ç¾¤">K8Sé«˜å¯ç”¨ï¼ˆHAï¼‰é›†ç¾¤</h2>
<table>
<colgroup>
<col style="width: 26%">
<col style="width: 12%">
<col style="width: 30%">
<col style="width: 30%">
</colgroup>
<thead>
<tr>
<th>ç»„ä»¶</th>
<th>HA ç±»å‹</th>
<th>åŸç† / å®ç°æ–¹å¼</th>
<th>å…³é”®è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>etcd</strong></td>
<td>å¤šå‰¯æœ¬ + Raft å•æ´»</td>
<td>éƒ¨ç½²å¥‡æ•°ä¸ªèŠ‚ç‚¹ï¼ŒLeader å¤„ç†å†™æ“ä½œå¹¶é€šè¿‡ Raft æ—¥å¿—å¤åˆ¶åˆ°
Followerï¼Œç¡®ä¿ä¸€è‡´æ€§</td>
<td>æ”¯æŒå¤šæ•°èŠ‚ç‚¹å®¹é”™ï¼Œä¿è¯å·²æäº¤æ—¥å¿—ä¸ä¸¢å¤±ï¼Œæœªæäº¤æ—¥å¿—å¯è¢«è¦†ç›–ï¼›èŠ‚ç‚¹â‰¥3ä¸”ä¸ºå¥‡æ•°æœ€ä¼˜</td>
</tr>
<tr>
<td><strong>API Server</strong></td>
<td>å¤šå‰¯æœ¬ + è´Ÿè½½å‡è¡¡</td>
<td>æ— çŠ¶æ€æœåŠ¡ï¼Œå‰ç½® LBï¼ˆå¦‚ Nginx/LVSï¼‰å®ç°è¯·æ±‚åˆ†å‘</td>
<td>å¯å¤šæ´»ï¼Œä»»ä½•å‰¯æœ¬éƒ½å¯å¤„ç†è¯·æ±‚ï¼Œå®¢æˆ·ç«¯æ— éœ€æ„ŸçŸ¥å‰¯æœ¬åˆ‡æ¢</td>
</tr>
<tr>
<td><strong>Scheduler</strong></td>
<td>å¤šå‰¯æœ¬ + Leader Election</td>
<td>é€šè¿‡ Lease é”å¯¹è±¡é€‰ä¸»ï¼Œåªæœ‰ Leader æ‰§è¡Œä¸šåŠ¡å¾ªç¯</td>
<td>Leader å‡ºæ•…éšœæ—¶å¤‡ç”¨å®ä¾‹è‡ªåŠ¨æ¥ç®¡ï¼›ä¿è¯å•æ´»æ‰§è¡Œé¿å…å†²çª</td>
</tr>
<tr>
<td><strong>Controller Manager</strong></td>
<td>å¤šå‰¯æœ¬ + Leader Election</td>
<td>åŒ Scheduler</td>
<td>Leader æ•…éšœåˆ‡æ¢åŒ Schedulerï¼›ç¡®ä¿èµ„æºçŠ¶æ€ä¸€è‡´æ€§</td>
</tr>
<tr>
<td><strong>èŠ‚ç‚¹çº§ç»„ä»¶ï¼ˆKubeletã€Kube-Proxyã€å®é™…æœåŠ¡
Podï¼‰</strong></td>
<td>æ§åˆ¶å¹³é¢ç®¡ç†</td>
<td>æœ¬è´¨ä¸Šéƒ½æ˜¯è¿è¡Œåœ¨èŠ‚ç‚¹ä¸Šçš„podï¼Œç”± æ§åˆ¶å¹³é¢è°ƒåº¦å’Œç®¡ç†</td>
<td>èŠ‚ç‚¹ä¸Šç‹¬ç«‹è¿è¡Œï¼Œé€šè¿‡æ§åˆ¶å¹³é¢è°ƒåº¦å’Œå‰¯æœ¬ç®¡ç†å®ç°æ•´ä½“é«˜å¯ç”¨ï¼›èŠ‚ç‚¹æ•…éšœæ—¶
Pod ä¼šè¢«é‡æ–°è°ƒåº¦</td>
</tr>
</tbody>
</table>
<p>K8S çš„é«˜å¯ç”¨æœ¬è´¨ä¸Šæ˜¯ä¿è¯é›†ç¾¤ä¸­ Pod çš„é«˜å¯ç”¨ã€‚ç”±äº Pod
çš„é«˜å¯ç”¨å¯ä»¥é€šè¿‡ Deployment ç­‰æ§åˆ¶å™¨æ¥ç®¡ç†å¤šä¸ªå‰¯æœ¬å®ç°ï¼Œå› æ­¤
<strong>é›†ç¾¤é«˜å¯ç”¨çš„æ ¸å¿ƒç›®æ ‡åœ¨äºä¿è¯ K8S
æ§åˆ¶å¹³é¢å…³é”®ç»„ä»¶çš„é«˜å¯ç”¨</strong>ã€‚</p>
<p>æ¥ä¸‹æ¥å¯¹æ¯ä¸€ä¸ªæ§åˆ¶ç»„ä»¶çš„é«˜å¯ç”¨è¿›è¡Œåˆ†æï¼š</p>
<h3 id="etcd-1">etcd</h3>
<p>etcd é€šè¿‡éƒ¨ç½²å¤šä¸ªå®ä¾‹å½¢æˆé›†ç¾¤æ¥å®ç°é«˜å¯ç”¨ã€‚</p>
<ul>
<li>æ¯ä¸ª etcd
èŠ‚ç‚¹éƒ½ç»´æŠ¤ä¸€ä»½çŠ¶æ€æœºï¼Œé›†ç¾¤ä¸­å§‹ç»ˆåªæœ‰ä¸€ä¸ªæœ‰æ•ˆçš„é¢†å¯¼è€…ï¼ˆLeaderï¼‰ã€‚</li>
<li>æ‰€æœ‰å†™æ“ä½œå¿…é¡»ç”± Leader å¤„ç†ï¼Œå¹¶é€šè¿‡ <strong>Raft åè®®</strong>
å°†æ“ä½œæ—¥å¿—åŒæ­¥åˆ°å…¶ä»–èŠ‚ç‚¹ã€‚</li>
<li>Raft
åè®®ç¡®ä¿é›†ç¾¤ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„æ—¥å¿—ä¿æŒä¸€è‡´ï¼Œä»è€Œä¿è¯æœ€ç»ˆå­˜å‚¨çš„é”®å€¼å¯¹æ•°æ®ä¸€è‡´ã€‚</li>
</ul>
<p>Raft é›†ç¾¤ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹åœ¨ä»»æ„æ—¶åˆ»éƒ½å¤„äºä»¥ä¸‹ä¸‰ç§çŠ¶æ€ä¹‹ä¸€ï¼š</p>
<ol type="1">
<li><strong>è·Ÿéšè€…ï¼ˆFollowerï¼‰</strong>ï¼šè¢«åŠ¨è§’è‰²ï¼Œåªå“åº”æ¥è‡ª Leader æˆ–
Candidate çš„è¯·æ±‚ã€‚å¦‚æœé•¿æ—¶é—´æœªæ”¶åˆ° Leader æ¶ˆæ¯ï¼Œä¼šè½¬ä¸ºå€™é€‰è€…ã€‚</li>
<li><strong>å€™é€‰è€…ï¼ˆCandidateï¼‰</strong>ï¼šç”±è·Ÿéšè€…è¶…æ—¶è½¬å˜è€Œæ¥ï¼Œå‘èµ·é€‰ä¸¾è¯·æ±‚ä»¥äº‰å–æˆä¸º
Leaderã€‚</li>
<li><strong>é¢†å¯¼è€…ï¼ˆLeaderï¼‰</strong>ï¼šå”¯ä¸€ä¸»åŠ¨è§’è‰²ï¼Œè´Ÿè´£å¤„ç†æ‰€æœ‰å®¢æˆ·ç«¯è¯·æ±‚å¹¶å°†æ—¥å¿—å¤åˆ¶åˆ°å…¶ä»–èŠ‚ç‚¹ã€‚é›†ç¾¤åœ¨ä»»æ„æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ª
Leaderã€‚</li>
</ol>
<p>å­˜åœ¨ä»¥ä¸‹å‡ ç§çŠ¶æ€è½¬æ¢æ“ä½œï¼š</p>
<h4 id="é¢†å¯¼è€…é€‰ä¸¾leader-election">é¢†å¯¼è€…é€‰ä¸¾ï¼ˆLeader Electionï¼‰</h4>
<p>é¢†å¯¼è€…é€‰ä¸¾æ˜¯Raftåè®®çš„åŸºçŸ³ï¼Œå®ƒç¡®ä¿äº†é›†ç¾¤ä¸­æ€»æœ‰ä¸€ä¸ªé¢†å¯¼è€…æ¥åè°ƒå·¥ä½œã€‚</p>
<ol type="1">
<li><strong>ä»»æœŸï¼ˆTermï¼‰</strong>:
Raftä½¿ç”¨ä¸€ä¸ªé€’å¢çš„æ•´æ•°æ¥è¡¨ç¤ºä»»æœŸã€‚æ¯ä¸ªä»»æœŸéƒ½ä»¥ä¸€æ¬¡é€‰ä¸¾å¼€å§‹ã€‚å½“ä¸€ä¸ªèŠ‚ç‚¹å‘èµ·é€‰ä¸¾æ—¶ï¼Œå®ƒä¼šå¢åŠ è‡ªå·±çš„ä»»æœŸå·ã€‚</li>
<li><strong>è¶…æ—¶ï¼ˆTimeoutï¼‰</strong>:
æ¯ä¸ªè·Ÿéšè€…éƒ½æœ‰ä¸€ä¸ªéšæœºçš„<strong>é€‰ä¸¾è¶…æ—¶æ—¶é—´</strong>ï¼ˆé€šå¸¸åœ¨150-300æ¯«ç§’ä¹‹é—´ï¼‰ã€‚å¦‚æœåœ¨è¶…æ—¶æ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°æ¥è‡ªé¢†å¯¼è€…çš„<strong>å¿ƒè·³æ¶ˆæ¯</strong>ï¼Œè·Ÿéšè€…å°±ä¼šå¼€å§‹ä¸€æ¬¡æ–°çš„é€‰ä¸¾ã€‚</li>
<li>æˆä¸ºå€™é€‰è€…: å½“ä¸€ä¸ªè·Ÿéšè€…è¶…æ—¶åï¼Œå®ƒä¼šï¼š
<ul>
<li>å¢åŠ è‡ªå·±çš„ä»»æœŸå·ã€‚</li>
<li>å°†è‡ªå·±çš„çŠ¶æ€ä»è·Ÿéšè€…è½¬æ¢ä¸ºå€™é€‰è€…ã€‚</li>
<li>ç»™è‡ªå·±æŠ•ä¸€ç¥¨ã€‚</li>
<li>å‘é›†ç¾¤ä¸­çš„å…¶ä»–æ‰€æœ‰èŠ‚ç‚¹å‘é€<strong>RequestVote</strong>ï¼ˆè¯·æ±‚æŠ•ç¥¨ï¼‰RPCã€‚</li>
</ul></li>
<li><strong>æŠ•ç¥¨</strong>:
å…¶ä»–èŠ‚ç‚¹æ”¶åˆ°RequestVoteè¯·æ±‚åï¼Œä¼šæ ¹æ®ä»¥ä¸‹è§„åˆ™è¿›è¡ŒæŠ•ç¥¨ï¼š
<ul>
<li>å®ƒä¼šé¦–å…ˆæ¯”è¾ƒè‡ªå·±çš„ä»»æœŸå·å’Œå€™é€‰è€…çš„ä»»æœŸå·ï¼Œå¦‚æœå€™é€‰è€…çš„ä»»æœŸå·å°äºè‡ªå·±çš„ä»»æœŸå·ï¼Œè¯¥èŠ‚ç‚¹ä¼šç«‹å³æ‹’ç»æŠ•ç¥¨ï¼Œå› ä¸ºå®ƒè®¤ä¸ºå€™é€‰è€…å·²ç»è¿‡æ—¶äº†ã€‚</li>
<li>å¦‚æœå€™é€‰è€…çš„ä»»æœŸå·å¤§äºè‡ªå·±çš„ä»»æœŸå·ï¼Œè¯¥èŠ‚ç‚¹ä¼šæ›´æ–°è‡ªå·±çš„ä»»æœŸå·ä¸ºå€™é€‰è€…çš„ä»»æœŸå·ï¼Œç„¶åå°†è‡ªå·±çš„çŠ¶æ€å˜ä¸ºè·Ÿéšè€…ã€‚</li>
<li>å¦‚æœå€™é€‰è€…çš„ä»»æœŸå·ç­‰äºè‡ªå·±çš„ä»»æœŸå·ï¼Œæ­¤æ—¶éœ€è¦è¿›ä¸€æ­¥æ¯”è¾ƒæ—¥å¿—æ–°æ—§ï¼šç”±äºæ¯æ¡æ—¥å¿—ä¼šè®°å½•ï¼ˆtermï¼Œindexï¼‰ï¼Œæ‰€ä»¥ä»ç„¶å…ˆæ¯”è¾ƒæœ€åä¸€æ¡æ—¥å¿—çš„termï¼Œæ›´æ–°çš„ä¼˜å…ˆï¼›å¦‚æœç›¸ç­‰ï¼Œå†æ¯”è¾ƒindexï¼Œæ›´å¤§çš„ä¼˜å…ˆã€‚</li>
</ul></li>
<li>é€‰ä¸¾ç»“æœ: å€™é€‰è€…ä¼šç­‰å¾…å…¶ä»–èŠ‚ç‚¹çš„å›å¤ï¼Œé€‰ä¸¾æœ‰ä¸‰ç§å¯èƒ½çš„ç»“æœï¼š
<ul>
<li><strong>èµ¢å¾—é€‰ä¸¾</strong>:
å¦‚æœä¸€ä¸ªå€™é€‰è€…ä»é›†ç¾¤ä¸­çš„å¤§å¤šæ•°èŠ‚ç‚¹ï¼ˆè¶…è¿‡ä¸€åŠï¼‰é‚£é‡Œè·å¾—æŠ•ç¥¨ï¼Œå®ƒå°±èµ¢å¾—äº†é€‰ä¸¾ï¼Œæˆä¸ºæ–°çš„é¢†å¯¼è€…ã€‚</li>
<li><strong>åˆ†è£‚æŠ•ç¥¨ï¼ˆSplit Voteï¼‰</strong>:
å¤šä¸ªå€™é€‰è€…åŒæ—¶å‘èµ·é€‰ä¸¾ï¼Œç¥¨æ•°åˆ†æ•£ï¼Œæ²¡æœ‰ä¸€ä¸ªå€™é€‰è€…è·å¾—å¤šæ•°ç¥¨ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå€™é€‰è€…ä¼šç­‰å¾…ä¸€ä¸ªæ–°çš„éšæœºè¶…æ—¶æ—¶é—´ï¼Œç„¶åå†æ¬¡å‘èµ·é€‰ä¸¾ã€‚</li>
<li><strong>è¢«æ–°é¢†å¯¼è€…å–ä»£</strong>:
å¦‚æœåœ¨ç­‰å¾…æŠ•ç¥¨æœŸé—´ï¼Œä¸€ä¸ªèŠ‚ç‚¹å‘ç°å¦ä¸€ä¸ªèŠ‚ç‚¹å‘æ¥çš„RPCçš„ä»»æœŸå·æ¯”è‡ªå·±çš„å¤§ï¼Œå®ƒä¼šç«‹å³æ”¾å¼ƒæˆä¸ºé¢†å¯¼è€…çš„å°è¯•ï¼Œå°†è‡ªå·±çš„çŠ¶æ€è½¬ä¸ºè·Ÿéšè€…ï¼Œå¹¶æ›´æ–°è‡ªå·±çš„ä»»æœŸå·ã€‚</li>
</ul></li>
</ol>
<p>ä¸€æ—¦é€‰ä¸¾å‡ºé¢†å¯¼è€…ï¼Œå®ƒä¼šå‘¨æœŸæ€§åœ°å‘é€<strong>å¿ƒè·³æ¶ˆæ¯</strong>ï¼ˆAppendEntries
RPCï¼Œä¸å¸¦æ—¥å¿—æ¡ç›®ï¼‰ç»™æ‰€æœ‰è·Ÿéšè€…ï¼Œä»¥ç»´æŒè‡ªå·±çš„é¢†å¯¼è€…åœ°ä½ã€‚</p>
<blockquote>
<p>æŠ•ç¥¨æœºåˆ¶ä¸­ä¸€ä¸ªå€™é€‰è€…æˆä¸ºé¢†å¯¼è€…ï¼Œå¿…é¡»å¾—åˆ°åŠæ•°ä»¥ä¸Šçš„ç¥¨æ•°æ‰è¡Œï¼Œæ‰€ä»¥etcdé«˜å¯ç”¨é›†ç¾¤ä¸­èŠ‚ç‚¹æ•°é‡è‡³å°‘æ˜¯å¤§äºç­‰äº3çš„å¥‡æ•°</p>
<ol type="1">
<li>å¦‚æœåªæœ‰ 1 ä¸ªèŠ‚ç‚¹ï¼šæ²¡æœ‰å®¹é”™èƒ½åŠ›ï¼Œä¸€æ—¦å®•æœºæ•´ä¸ªé›†ç¾¤ä¸å¯ç”¨</li>
<li>å¦‚æœåªæœ‰ 2
ä¸ªèŠ‚ç‚¹ï¼šåŠæ•°ä»¥ä¸Š=2ï¼Œä»»æ„ä¸€ä¸ªèŠ‚ç‚¹å®•æœºåï¼Œå¦ä¸€ä¸ªèŠ‚ç‚¹åªèƒ½å¾—åˆ°è‡ªå·±çš„1ç¥¨ï¼Œæ— æ³•é€‰å‡º
Leader</li>
<li>å¯¹äºèŠ‚ç‚¹æ•°å¤§äºç­‰äº3çš„é›†ç¾¤ï¼Œå¶æ•°ä¸ªèŠ‚ç‚¹å¹¶ä¸ä¼šæå‡å®¹é”™èƒ½åŠ›ï¼šä¾‹å¦‚3ä¸ªèŠ‚ç‚¹ï¼Œåªèƒ½å®¹å¿1ä¸ªå‡ºæ•…éšœï¼Œå› ä¸ºæœ€å°‘éœ€è¦å‰©ä¸‹åŠæ•°ä»¥ä¸Šçš„èŠ‚ç‚¹ï¼Œä»–ä»¬è¿™äº›ç¥¨éƒ½æŠ•ç»™åŒä¸€ä¸ªèŠ‚ç‚¹æ‰èƒ½è®©è¿™ä¸ªèŠ‚ç‚¹æˆä¸ºLeaderï¼›ä½†å¯¹äº4ä¸ªèŠ‚ç‚¹ï¼ŒåŠæ•°ä»¥ä¸Š=3ï¼Œæ‰€ä»¥ä¹Ÿæœ€å¤šåªèƒ½å®¹å¿1ä¸ªå‡ºæ•…éšœã€‚</li>
</ol>
</blockquote>
<blockquote>
<p>Raftåè®®ä¸­çš„æ¯ä¸ªè·Ÿéšè€…èŠ‚ç‚¹çš„é€‰ä¸¾è¶…æ—¶æ—¶é—´éƒ½æ˜¯éšæœºä¸”ä¸åŒçš„ï¼Œå¥½å¤„æ˜¯ï¼š</p>
<p>ç”±äºæ¯ä¸ªèŠ‚ç‚¹çš„è¶…æ—¶æ—¶é—´ä¸åŒï¼Œä¸€ä¸ªèŠ‚ç‚¹ï¼ˆæ¯”å¦‚å®ƒçš„è¶…æ—¶æ—¶é—´æœ€çŸ­ï¼‰ä¼šæ¯”å…¶ä»–èŠ‚ç‚¹æ›´æ—©åœ°è½¬æ¢ä¸ºå€™é€‰è€…å¹¶å‘é€æŠ•ç¥¨è¯·æ±‚ã€‚è¿™ä¸ªâ€œå…ˆå‘åˆ¶äººâ€çš„å€™é€‰è€…å¾ˆæœ‰å¯èƒ½åœ¨å…¶ä»–èŠ‚ç‚¹è¶…æ—¶ä¹‹å‰å°±è·å¾—äº†å¤šæ•°ç¥¨ï¼Œä»è€ŒæˆåŠŸå½“é€‰ä¸ºé¢†å¯¼è€…ã€‚ä¸€æ—¦æœ‰é¢†å¯¼è€…äº§ç”Ÿï¼Œå…¶ä»–èŠ‚ç‚¹å°±ä¼šè½¬ä¸ºè·Ÿéšè€…ï¼Œæ¥å—æ–°é¢†å¯¼è€…çš„å¿ƒè·³ï¼Œé¿å…äº†åˆ†è£‚æŠ•ç¥¨çš„ç»“æœï¼ˆé˜²æ­¢ä¸€ç›´è¶…æ—¶ï¼Œä¸€ç›´åœ¨é€‰ä¸¾ï¼‰</p>
</blockquote>
<h4 id="æ—¥å¿—å¤åˆ¶log-replication">æ—¥å¿—å¤åˆ¶ï¼ˆLog Replicationï¼‰</h4>
<p>æ—¥å¿—å¤åˆ¶æ˜¯Raftåè®®çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå®ƒç¡®ä¿äº†é›†ç¾¤ä¸­çš„æ‰€æœ‰çŠ¶æ€æœºéƒ½æ‰§è¡Œç›¸åŒçš„ã€é¡ºåºä¸€è‡´çš„å‘½ä»¤ï¼Œä»¥å®ç°æœ€ç»ˆæ‰€æœ‰æœºå™¨å­˜å‚¨çš„ä¿¡æ¯éƒ½ä¸€æ ·ã€‚</p>
<ol type="1">
<li><p><strong>å®¢æˆ·ç«¯è¯·æ±‚</strong>:
æ‰€æœ‰çš„å®¢æˆ·ç«¯è¯·æ±‚éƒ½å¿…é¡»å…ˆå‘é€ç»™é¢†å¯¼è€…ã€‚</p></li>
<li><p>æ—¥å¿—æ¡ç›®ï¼ˆLog Entryï¼‰:
é¢†å¯¼è€…å°†æ¯ä¸ªå®¢æˆ·ç«¯è¯·æ±‚ä½œä¸ºä¸€ä¸ªæ—¥å¿—æ¡ç›®è¿½åŠ åˆ°è‡ªå·±çš„æ—¥å¿—ä¸­ã€‚æ¯ä¸ªæ¡ç›®åŒ…å«ï¼š</p>
<ul>
<li><strong>å‘½ä»¤</strong>ï¼šè¦æ‰§è¡Œçš„æ“ä½œï¼ˆetcdé‡Œå°±æ˜¯ä¸€ä¸ªé”®å€¼å¯¹å­˜å‚¨ä¿¡æ¯ï¼‰ã€‚</li>
<li><strong>ä»»æœŸå·</strong>ï¼šè¯¥æ—¥å¿—æ¡ç›®åˆ›å»ºæ—¶çš„ä»»æœŸå·ã€‚</li>
<li><strong>ç´¢å¼•</strong>ï¼šæ—¥å¿—æ¡ç›®åœ¨æ—¥å¿—ä¸­çš„ä½ç½®ã€‚</li>
</ul></li>
<li><p>å‘é€AppendEntries:
é¢†å¯¼è€…æ”¶åˆ°æ—¥å¿—æ¡ç›®åï¼Œä¼šå¹¶å‘åœ°å‘æ‰€æœ‰è·Ÿéšè€…å‘é€<strong>AppendEntries</strong>ï¼ˆè¿½åŠ æ—¥å¿—æ¡ç›®ï¼‰RPCã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">AppendEntries(</span><br><span class="line">    term,           # Leader å½“å‰ä»»æœŸ</span><br><span class="line">    leaderId,       </span><br><span class="line">    prevLogIndex,   # æ–°æ—¥å¿—å‰ä¸€æ¡æ—¥å¿—çš„ä¸‹æ ‡</span><br><span class="line">    prevLogTerm,    # è¯¥æ—¥å¿—çš„ä»»æœŸ</span><br><span class="line">    entries[],      # è¦è¿½åŠ çš„æ–°æ—¥å¿—ï¼ˆå¯èƒ½ä¸ºç©ºï¼Œè¡¨ç¤ºå¿ƒè·³ï¼‰</span><br><span class="line">    leaderCommit    # Leader å·²æäº¤çš„ç´¢å¼•</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li>
<li><p>è·Ÿéšè€…å“åº”:</p>
<ul>
<li>å¦‚æœè·Ÿéšè€…çš„æ—¥å¿—å’Œé¢†å¯¼è€…ä¸ä¸€è‡´ï¼Œå®ƒä¼šå›å¤ä¸€ä¸ªå¤±è´¥çš„å“åº”ã€‚é¢†å¯¼è€…ä¼šæ ¹æ®å¤±è´¥ä¿¡æ¯ï¼Œå°è¯•å‘é€ä¸€ä¸ªæ›´æ—§çš„æ—¥å¿—æ¡ç›®ï¼Œç›´åˆ°æ‰¾åˆ°åŒ¹é…çš„ç‚¹ï¼Œç„¶åä»è¯¥ç‚¹å¼€å§‹åŒæ­¥æ—¥å¿—ï¼ˆå‡è®¾æœ€ç»ˆåŒ¹é…åˆ°çš„ç´¢å¼•æ˜¯tï¼Œé‚£ä¹ˆä»£è¡¨ç´¢å¼•tåŠå…¶ä¹‹å‰çš„æ—¥å¿—ä¹Ÿä¸€å®šå’Œé¢†å¯¼è€…æ˜¯ç›¸åŒçš„ï¼‰</li>
<li>å¦‚æœè·Ÿéšè€…æˆåŠŸæ¥æ”¶å¹¶è¿½åŠ æ—¥å¿—æ¡ç›®ï¼Œå®ƒä¼šå›å¤é¢†å¯¼è€…ä¸€ä¸ªæˆåŠŸçš„å“åº”</li>
<li>æœ€ç»ˆç›®çš„æ˜¯<strong>è®©è·Ÿéšè€…çš„æ—¥å¿—å’Œå½“å‰é¢†å¯¼è€…æ—¥å¿—ä¿æŒå¼ºä¸€è‡´</strong></li>
</ul></li>
<li><p><strong>æ—¥å¿—æäº¤ï¼ˆCommitï¼‰</strong>ï¼š</p>
<ul>
<li>å½“æŸæ¡æ—¥å¿—è¢«å¤åˆ¶åˆ°å¤§å¤šæ•°èŠ‚ç‚¹æ—¶ï¼ŒLeader å°†å…¶æ ‡è®°ä¸ºå·²æäº¤ï¼›</li>
<li>Leader å°†å‘½ä»¤åº”ç”¨åˆ°çŠ¶æ€æœºå¹¶è¿”å›å®¢æˆ·ç«¯ç»“æœï¼›</li>
<li>Leader é€šè¿‡å¿ƒè·³é€šçŸ¥ Follower å“ªäº›æ—¥å¿—å·²æäº¤ï¼ŒFollower
éšååº”ç”¨åˆ°çŠ¶æ€æœºã€‚</li>
</ul></li>
</ol>
<h4 id="æ—¥å¿—æäº¤çš„å®‰å…¨æ€§ä¿éšœ">æ—¥å¿—æäº¤çš„å®‰å…¨æ€§ä¿éšœ</h4>
<p><strong>å·²æäº¤æ—¥å¿—çš„å®‰å…¨æ€§</strong></p>
<p>Raftçš„ä¸€ä¸ªæ ¸å¿ƒå®‰å…¨å±æ€§æ˜¯é¢†å¯¼è€…å®Œå…¨æ€§ï¼ˆLeader
Completenessï¼‰ã€‚è¿™ä¸ªå±æ€§ä¿è¯äº†ï¼šå¦‚æœä¸€ä¸ªæ—¥å¿—æ¡ç›®åœ¨ä¸€ä¸ªä»»æœŸå†…è¢«æäº¤äº†ï¼ˆå³è¢«å¤šæ•°èŠ‚ç‚¹å¤åˆ¶æˆåŠŸï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªæ¡ç›®ä¸€å®šä¼šå­˜åœ¨äºåç»­æ‰€æœ‰å½“é€‰çš„é¢†å¯¼è€…çš„æ—¥å¿—ä¸­ã€‚</p>
<ul>
<li>ä¸€ä¸ªæ—¥å¿—æ¡ç›®è¦è¢«æäº¤ï¼Œå¿…é¡»è¢«<strong>å¤šæ•°èŠ‚ç‚¹</strong>æˆåŠŸå¤åˆ¶ã€‚</li>
<li>ä¸€ä¸ªå€™é€‰è€…è¦å½“é€‰ä¸ºé¢†å¯¼è€…ï¼Œä¹Ÿå¿…é¡»è·å¾—<strong>å¤šæ•°èŠ‚ç‚¹</strong>çš„æŠ•ç¥¨ã€‚</li>
<li>è¿™ä¸¤ä¸ªâ€œå¤šæ•°â€é›†åˆä¹‹é—´å¿…ç„¶å­˜åœ¨<strong>é‡å </strong>ã€‚è¿™æ„å‘³ç€ï¼Œä¸€ä¸ªæ–°å½“é€‰çš„é¢†å¯¼è€…ï¼Œå®ƒçš„æ—¥å¿—ä¸­å¿…ç„¶åŒ…å«äº†æ‰€æœ‰åœ¨ä¸Šä¸€ä»»æœŸè¢«æäº¤çš„æ—¥å¿—æ¡ç›®ã€‚</li>
</ul>
<p>æ‰€ä»¥æ— è®ºLeaderè¿˜æ˜¯Followerå®•æœºï¼Œå·²æäº¤æ—¥å¿—éƒ½ä¸ä¼šä¸¢å¤±ï¼Œéƒ½ä¼šè¢«æ…¢æ…¢åŒæ­¥åˆ°æ‰€æœ‰èŠ‚ç‚¹ä¸Šã€‚</p>
<p><strong>æœªæäº¤æ—¥å¿—çš„æ½œåœ¨ä¸¢å¤±</strong></p>
<p>Raft åœ¨å¤„ç†æ—¥å¿—å†²çªæ—¶ï¼Œä¼šå¼ºåˆ¶è¦†ç›–æœªæäº¤çš„æ—¥å¿—ã€‚</p>
<p>è¿™æ ·åšæ˜¯å®‰å…¨çš„ï¼Œå› ä¸ºï¼š</p>
<ul>
<li>æœªæäº¤æ—¥å¿—å°šæœªè·å¾—å¤šæ•°èŠ‚ç‚¹ç¡®è®¤ï¼Œä¸è¢«è§†ä¸ºé›†ç¾¤çš„æœ€ç»ˆçŠ¶æ€ï¼›</li>
<li>å®¢æˆ·ç«¯ä¹Ÿä¸ä¼šæ”¶åˆ°æˆåŠŸå“åº”ï¼Œå› æ­¤å®¢æˆ·ç«¯çŸ¥é“è¯¥æ“ä½œæœªè¢«æŒä¹…åŒ–ï¼Œå¯ä»¥é€‰æ‹©é‡è¯•ï¼›</li>
<li>è¦†ç›–è¿™äº›æ—¥å¿—æ­£æ˜¯ä¸ºäº†ä¿è¯é›†ç¾¤ä¸€è‡´æ€§ã€‚</li>
</ul>
<p>ä¾‹å¦‚ï¼ŒLeader A å†™äº†ä¸€æ¡æ–°æ—¥å¿—ï¼ŒåªæˆåŠŸå‘ç»™äº† 1 ä¸ª
Followerï¼ˆæ²¡åˆ°å¤šæ•°ï¼‰ã€‚è¿™æ—¶å€™ Leader A å®•æœºï¼Œæ–°çš„ Leader B
å½“é€‰ï¼Œå®ƒçš„æ—¥å¿—æ²¡æœ‰è¿™æ¡æœªæäº¤æ—¥å¿—ã€‚é‚£ä¹ˆ A å’Œé‚£ä¸ª Follower
çš„æ—¥å¿—å°±åŒ…å«äº†â€œæœªæäº¤æ¡ç›®â€ï¼Œæ­¤æ—¶Learder
Bä¼šå¼ºåˆ¶è¦†ç›–æ‰æ‰€æœ‰èŠ‚ç‚¹ä¸Šè¿™ä¸ªæ—¥å¿—ã€‚</p>
<p>ä½†ç”±äºæ˜¯æœªæäº¤çš„ï¼ŒLeader
Aå¹¶ä¸ä¼šå‘å®¢æˆ·ç«¯å‘é€æˆåŠŸå“åº”ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯æ˜¯çŸ¥é“è¿™æ¡æ—¥å¿—å¯¹åº”çš„æ“ä½œæ˜¯æ²¡æœ‰è¢«å†™å…¥é›†ç¾¤ä¸­çš„ï¼Œæ‰€ä»¥æ­¤æ—¶å®¢æˆ·ç«¯ä¼šæ ¹æ®è‡ªå·±çš„éœ€è¦åˆ¤æ–­æ˜¯å¦é‡ä¼ è¿™ä¸ªæ“ä½œï¼Œæˆ–è€…æ˜¯æ‰§è¡Œå…¶ä»–æ“ä½œã€‚</p>
<p>å› æ­¤æœªæäº¤æ—¥å¿—å°±æ˜¯é”™è¯¯çš„æ—¥å¿—ï¼Œéœ€è¦ç”¨æ–°æ—¥å¿—è¦†ç›–æ‰ï¼Œåªæœ‰æäº¤çš„æ—¥å¿—æ‰è¢«å®¢æˆ·ç«¯è®¤å¯ã€‚</p>
<h3 id="api-server">API Server</h3>
<p>API Server ä½œä¸ºé›†ç¾¤ä¸­å…¶ä»–ç»„ä»¶ä¸ etcd
ä¹‹é—´çš„ä¸­é—´å±‚ï¼Œæœ¬èº«å¹¶ä¸å­˜å‚¨ä»»ä½•çŠ¶æ€æ•°æ®ï¼Œå› æ­¤æ˜¯ä¸€ä¸ª
<strong>æ— çŠ¶æ€æœåŠ¡</strong>ã€‚</p>
<p>å…¶é«˜å¯ç”¨æ–¹æ¡ˆç›¸å¯¹ç®€å•ï¼šé€šè¿‡éƒ¨ç½²å¤šä¸ª API Server
å‰¯æœ¬ï¼Œå¹¶åœ¨å…¶å‰é¢æ·»åŠ ä¸€ä¸ªè´Ÿè½½å‡è¡¡ç»„ä»¶ï¼ˆå¦‚ Nginxã€LVS
æˆ–äº‘è´Ÿè½½å‡è¡¡ï¼‰ï¼Œå³å¯ä¿è¯å¤–éƒ¨è®¿é—®çš„è¿ç»­æ€§ä¸å¯é æ€§ã€‚</p>
<figure>
<img lazyload="" alt="image-20250831173231803" data-src="/Users/qzj/Desktop/Development/Hexo-blog-source/source/_posts/pictures/17-K8S-é«˜å¯ç”¨é›†ç¾¤/image-20250831173231803.png">
<figcaption aria-hidden="true">image-20250831173231803</figcaption>
</figure>
<h3 id="k8s-scheduler-k8s-controller">K8S Scheduler &amp; K8S
Controller</h3>
<p><strong>Scheduler</strong> å’Œ <strong>Controller Manager</strong>
éƒ½æ˜¯ K8S æ§åˆ¶å¹³é¢çš„<strong>æ— çŠ¶æ€</strong>è¿›ç¨‹ã€‚å®ƒä»¬çš„å·¥ä½œæ¨¡å¼ç›¸åŒï¼šä»
API Server è¯»å–å„ç±»èµ„æºï¼ˆå¦‚ Podã€Node å’Œ ReplicaSet
ç­‰ï¼‰ï¼Œæ‰§è¡Œå†³ç­–æˆ–è®¡ç®—ï¼Œç„¶åå°†ç»“æœé€šè¿‡ API Server å†™å›ï¼ˆä¾‹å¦‚ï¼Œä¸º Pod åˆ›å»º
Binding æˆ–æ›´æ–°èµ„æºçŠ¶æ€ï¼‰ã€‚</p>
<p>å› æ­¤ï¼Œä¸ºäº†å®ç°é«˜å¯ç”¨æ€§ï¼Œé€šå¸¸ä¼šéƒ¨ç½²å¤šä¸ª Scheduler æˆ– Controller
Manager å®ä¾‹ã€‚</p>
<p>ç„¶è€Œï¼Œä¸ API Server
ä¸åŒï¼Œå®ƒä»¬ä¸æ˜¯è¢«åŠ¨åœ°ç­‰å¾…è¯·æ±‚ï¼Œè€Œæ˜¯<strong>ä¸»åŠ¨åœ°æŒç»­è®¿é—®</strong> API
Serverï¼Œä»¥è¯»å–ä¿¡æ¯å¹¶æ‰§è¡Œç›¸åº”çš„æ“ä½œã€‚å¦‚æœå¤šä¸ªå®ä¾‹åŒæ—¶æ‰§è¡Œç›¸åŒç±»å‹çš„å†™å…¥æ“ä½œï¼ˆä¾‹å¦‚ï¼ŒåŒæ—¶ä¸ºåŒä¸€ä¸ª
Pod ç»‘å®š Nodeï¼Œæˆ–åŒæ—¶åˆ›å»º/åˆ é™¤æŸä¸ªèµ„æºï¼‰ï¼Œå¯èƒ½ä¼šå¯¼è‡´å†²çªæˆ–é‡å¤æ“ä½œã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼ŒK8S å†…éƒ¨é‡‡ç”¨äº†<strong>é¢†å¯¼è€…é€‰ä¸¾ï¼ˆLeader
Electionï¼‰</strong>æœºåˆ¶ã€‚è¯¥æœºåˆ¶ç¡®ä¿äº†åœ¨ä»»ä½•ç»™å®šæ—¶é—´ï¼Œå¤šä¸ª Scheduler æˆ–
Controller
å®ä¾‹ä¸­<strong>åªæœ‰ä¸€ä¸ªå¤„äºæ´»è·ƒçŠ¶æ€å¹¶æ‰§è¡Œä»»åŠ¡</strong>ï¼Œè€Œå…¶ä½™çš„åˆ™ä¿æŒ<strong>å¤‡ç”¨</strong>ã€‚å½“æ´»è·ƒå®ä¾‹å‘ç”Ÿæ•…éšœæ—¶ï¼Œå¤‡ç”¨å®ä¾‹ä¼šè‡ªåŠ¨é€šè¿‡é€‰ä¸¾æ¥ç®¡å…¶èŒè´£ï¼Œä»è€Œä¿è¯äº†æœåŠ¡ä¸ä¸­æ–­ã€‚</p>
<p>ä¸‹é¢ç®€å•è¯´ä¸€ä¸‹ K8S çš„é¢†å¯¼è€…é€‰ä¸¾æœºåˆ¶ï¼š</p>
<h4 id="é”å¯¹è±¡ä¸å®ç°æ–¹å¼">é”å¯¹è±¡ä¸å®ç°æ–¹å¼</h4>
<p>K8S çš„Leader Electionä¾èµ–äºåœ¨ API Server
ä¸Šæ“ä½œä¸€ä¸ªâ€œé”å¯¹è±¡â€ï¼Œä»è€Œå®ç°<strong>åˆ†å¸ƒå¼äº’æ–¥</strong>ã€‚</p>
<p>å¸¸è§çš„é”ç±»å‹æœ‰ï¼š</p>
<ul>
<li>ä¼ ç»Ÿæ–¹æ¡ˆï¼šä½¿ç”¨ Endpoints æˆ– ConfigMap
ä½œä¸ºé”ã€‚è¿™ä¸¤ç§æ–¹å¼æ˜¯æ—©æœŸå®ç°ï¼Œç›®å‰å·²ä¸å†æ¨èã€‚</li>
<li>æ¨èæ–¹æ¡ˆï¼šä½¿ç”¨
<code>Lease</code>ï¼ˆ<code>coordination.k8s.io/v1</code> çš„ Lease
èµ„æºï¼‰ã€‚<code>Lease</code>
èµ„æºä¸“ä¸ºç§Ÿçº¦å‹é€‰ä¸»è®¾è®¡ï¼Œå…·æœ‰è½»é‡ã€æ›´æ–°å¼€é”€å°ã€è¯­ä¹‰æ¸…æ™°ç­‰ä¼˜ç‚¹ï¼Œå› æ­¤æ˜¯ç›®å‰çš„é¦–é€‰æ–¹æ¡ˆã€‚</li>
</ul>
<p>è¿™ä¸ªé”å¯¹è±¡ä¼šè®°å½•å…³é”®å…ƒæ•°æ®ï¼Œä¾‹å¦‚å½“å‰æŒæœ‰è€…èº«ä»½ï¼ˆholder
identityï¼‰ã€ç§Ÿçº¦æŒç»­æ—¶é—´ã€ä¸Šæ¬¡ç»­çº¦æ—¶é—´ç­‰ï¼Œä»¥ä¾¿åˆ¤æ–­é”æ˜¯å¦æœ‰æ•ˆæˆ–å·²è¿‡æœŸã€‚</p>
<h4 id="å‚ä¸è€…çš„èº«ä»½æ ‡è¯†">å‚ä¸è€…çš„èº«ä»½æ ‡è¯†</h4>
<p>æ¯ä¸ªå‚ä¸é€‰ä¸¾çš„è¿›ç¨‹åœ¨å¯åŠ¨æ—¶éƒ½ä¼šç”Ÿæˆä¸€ä¸ª<strong>å”¯ä¸€çš„èº«ä»½æ ‡è¯†</strong>ï¼ˆä¾‹å¦‚ï¼Œ<code>podname_uuid</code>
æˆ– <code>hostname+pid</code>ï¼‰ã€‚è¿™ä¸ªæ ‡è¯†ä¼šè¢«å†™å…¥é”å¯¹è±¡çš„
<code>holder</code> å­—æ®µï¼Œæ˜ç¡®åœ°è¡¨æ˜â€œå½“å‰è°æ˜¯é¢†å¯¼è€…â€ã€‚</p>
<h4 id="ä¸‰ä¸ªé‡è¦æ—¶é—´å‚æ•°">ä¸‰ä¸ªé‡è¦æ—¶é—´å‚æ•°</h4>
<p>Leader Electionæ¶‰åŠä¸‰ä¸ªå…³é”®çš„æ—¶é—´å‚æ•°ï¼Œå®ƒä»¬å…±åŒç®¡ç†ç€é€‰ä¸»æµç¨‹ï¼š</p>
<ul>
<li><strong>LeaseDuration</strong>ï¼ˆç§Ÿçº¦æ—¶é•¿ï¼‰ï¼šLeaderåœ¨ä¸ç»­çº¦çš„æƒ…å†µä¸‹ï¼Œä»ç„¶è¢«è§†ä¸ºæŒæœ‰é”çš„æœ€é•¿æ—¶é—´ã€‚</li>
<li><strong>RenewDeadline</strong>ï¼ˆç»­çº¦æˆªæ­¢ï¼‰ï¼šLeaderå¿…é¡»åœ¨è¿™ä¸ªæ—¶é—´çª—å£å†…å®Œæˆç»­çº¦ã€‚å¦‚æœç»­çº¦å¤±è´¥å¹¶è¶…è¿‡æ­¤æˆªæ­¢æ—¶é—´ï¼Œå®ƒå°†è¢«è®¤ä¸ºç»­çº¦å¤±è´¥ã€‚</li>
<li><strong>RetryPeriod</strong>ï¼ˆé‡è¯•é—´éš”ï¼‰ï¼šå½“å€™é€‰è€…å°è¯•è·å–æˆ–ç»­çº¦é”å¤±è´¥æ—¶ï¼Œéœ€è¦ç­‰å¾…çš„æ—¶é—´é—´éš”ã€‚</li>
</ul>
<p>è¿™äº›å‚æ•°çš„å…³ç³»é€šå¸¸ä¸ºï¼š<code>RetryPeriod</code> è¾ƒçŸ­ï¼Œè€Œ
<code>RenewDeadline</code> åˆ™å°äº
<code>LeaseDuration</code>ã€‚è¿™ç§é…ç½®ç¡®ä¿äº†é¢†å¯¼è€…ä¼šåœ¨ç§Ÿçº¦åˆ°æœŸå‰å°½æ—©å°è¯•ç»­çº¦ï¼Œä»è€Œé™ä½å› ç½‘ç»œæ³¢åŠ¨ç­‰åŸå› å¯¼è‡´è¯¯åˆ¤çš„é£é™©ã€‚</p>
<blockquote>
<p>è¿™äº›å‚æ•°åœ¨ <code>client-go</code> çš„ <code>leader-election</code>
å®ç°ä¸­æ˜¯å¯é…ç½®çš„ï¼Œå¯ä»¥æ ¹æ®å…·ä½“çš„ç½‘ç»œç¨³å®šæ€§å’Œéƒ¨ç½²ç¯å¢ƒè¿›è¡Œè°ƒæ•´ã€‚</p>
</blockquote>
<h4 id="leader-election-ä¸»å¾ªç¯è¿‡ç¨‹">Leader Election ä¸»å¾ªç¯è¿‡ç¨‹</h4>
<p>æ ¸å¿ƒæ˜¯åœ¨æ¯ä¸€ä¸ªScheduleræˆ–Controllerå®ä¾‹ä¸ŠæŒç»­è¿è¡Œçš„å¾ªç¯ï¼Œå¯ä»¥åˆ†è§£ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p>
<ol type="1">
<li><p>å¯åŠ¨ä¸åˆå§‹åŒ–
æ¯ä¸ªè¿›ç¨‹å‰¯æœ¬å¯åŠ¨åï¼Œé¦–å…ˆç”Ÿæˆå”¯ä¸€çš„èº«ä»½æ ‡è¯†ï¼Œå¹¶è¯»å–æˆ–åˆ›å»ºæŒ‡å®šçš„é”å¯¹è±¡ã€‚å¦‚æœé”å¯¹è±¡ä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ›å»ºå®ƒã€‚</p></li>
<li><p>å°è¯•è·å–é”</p>
<ul>
<li>è¿›ç¨‹è¯»å–é”å¯¹è±¡çš„å½“å‰çŠ¶æ€ï¼ˆåŒ…æ‹¬æŒæœ‰è€…å’Œä¸Šæ¬¡ç»­çº¦æ—¶é—´ï¼‰ã€‚</li>
<li>å¦‚æœé”æ²¡æœ‰æŒæœ‰è€…ï¼Œæˆ–è€…é”å·²è¿‡æœŸï¼Œè¯¥å€™é€‰è€…ä¼šå°è¯•é€šè¿‡æ¡ä»¶æ›´æ–°ï¼ˆä¹è§‚é”ï¼‰æ¥å°†è‡ªå·±çš„èº«ä»½å†™å…¥
<code>holder</code> å­—æ®µã€‚</li>
<li>å¦‚æœå†™å…¥æˆåŠŸï¼Œè¯¥å®ä¾‹å³æˆä¸ºé¢†å¯¼è€…ï¼Œå¹¶è§¦å‘
<code>OnStartedLeading</code>
å›è°ƒå‡½æ•°ï¼Œå¼€å§‹æ‰§è¡Œå…¶ä¸šåŠ¡é€»è¾‘ï¼ˆä¾‹å¦‚è°ƒåº¦æˆ–æ§åˆ¶å™¨å¾ªç¯ï¼‰ã€‚</li>
</ul></li>
<li><p>é¢†å¯¼è€…ç»­çº¦</p>
<ul>
<li>æˆä¸ºé¢†å¯¼è€…åï¼Œå®ä¾‹ä¼šåœ¨ä¸€ä¸ªå‘¨æœŸå†…å®šæœŸå‘ API Server æ›´æ–°é”å¯¹è±¡ï¼Œä»¥åˆ·æ–°
<code>renewTime</code> å­—æ®µã€‚æ­¤ä¸¾è¡¨æ˜è‡ªå·±ä¾ç„¶æ´»è·ƒå¹¶æŒæœ‰é”ã€‚</li>
<li>å¿…é¡»åœ¨ <code>LeaseDuration</code> åˆ°æœŸå‰å®Œæˆç»­çº¦ã€‚</li>
<li>å¦‚æœé¢†å¯¼è€…è¿ç»­ç»­çº¦å¤±è´¥å¹¶è¾¾åˆ°è®¾å®šçš„é˜ˆå€¼ï¼Œ<code>client-go</code>
ä¼šè§¦å‘
<code>OnStoppedLeading</code>ï¼Œè¯¥å®ä¾‹å°†æ”¾å¼ƒé¢†å¯¼è€…èº«ä»½ï¼Œå¹¶åœæ­¢æ‰§è¡Œå…¶ä¸“å±ä»»åŠ¡ã€‚</li>
</ul></li>
<li><p>å€™é€‰è€…ç­‰å¾…ä¸é‡è¯•</p>
<ul>
<li>å¦‚æœé”å·²è¢«å…¶ä»–å®ä¾‹æŒæœ‰ä¸”æœªè¿‡æœŸï¼Œå€™é€‰è€…ä¸ä¼šç«‹åˆ»è¿›è¡ŒæŠ¢å¤ºã€‚å®ƒä¼šç­‰å¾…
<code>RetryPeriod</code> æŒ‡å®šçš„æ—¶é—´åï¼Œå†æ¬¡é‡è¯•è¯»å–å¹¶æ£€æŸ¥é”çŠ¶æ€ã€‚</li>
<li>å¦‚æœæ£€æµ‹åˆ°é”çš„æŒæœ‰è€…å‘ç”Ÿå˜æ›´ï¼ˆä¾‹å¦‚å‘ç°æ–°çš„
<code>holderIdentity</code>ï¼‰ï¼Œä¼šè§¦å‘ <code>OnNewLeader</code>
å›è°ƒï¼Œå¸¸ç”¨äºæ—¥å¿—è®°å½•æˆ–ç›‘æ§ã€‚</li>
</ul></li>
<li><p>é¢†å¯¼æƒäº‰å¤º
å½“é¢†å¯¼è€…æ— æ³•ç»­çº¦ï¼ˆä¾‹å¦‚å› ç½‘ç»œæ–­è¿æˆ–è¿›ç¨‹å´©æºƒï¼‰å¯¼è‡´ç§Ÿçº¦è¿‡æœŸæ—¶ï¼Œå¤šä¸ªå¤‡ç”¨å€™é€‰è€…ä¼šå‡ ä¹åŒæ—¶å°è¯•æ¡ä»¶æ›´æ–°é”å¯¹è±¡ã€‚ç”±äº
API Server
å¯¹èµ„æºçš„æ›´æ–°æ˜¯åŸå­åŒ–çš„ï¼Œæœ€ç»ˆåªæœ‰ä¸€ä¸ªè¯·æ±‚ä¼šæˆåŠŸå†™å…¥ã€‚å…¶ä»–è¯·æ±‚ä¼šå› ä¸ºç‰ˆæœ¬å†²çªè€Œå¤±è´¥å¹¶è¿›å…¥é‡è¯•ï¼Œä»è€Œé€‰å‡ºæ–°çš„é¢†å¯¼è€…ã€‚</p></li>
</ol>
<h4 id="åŸå­æ€§ä¸ä¸€è‡´æ€§ä¿éšœ">åŸå­æ€§ä¸ä¸€è‡´æ€§ä¿éšœ</h4>
<ul>
<li>é¢†å¯¼è€…é€‰ä¸¾çš„äº’æ–¥æ€§å®Œå…¨ä¾èµ–äº <strong>API Server
å¯¹èµ„æºçš„åŸå­æ›´æ–°</strong>ã€‚å½“å¤šä¸ªå€™é€‰è€…åŒæ—¶å°è¯•æ›´æ–°é”å¯¹è±¡æ—¶ï¼ŒAPI Server
çš„ä¹è§‚å¹¶å‘æ§åˆ¶æœºåˆ¶ï¼ˆé€šå¸¸åŸºäº
<code>resourceVersion</code>ï¼‰ä¼šç¡®ä¿åªæœ‰ç¬¬ä¸€ä¸ªæˆåŠŸå†™å…¥çš„è¯·æ±‚è¢«æ¥å—ï¼Œå…¶ä»–è¯·æ±‚ä¼šå› ç‰ˆæœ¬ä¸åŒ¹é…è€Œå¤±è´¥ã€‚</li>
<li>ç”±äºæ‰€æœ‰æ“ä½œéƒ½é€šè¿‡ API Server å¹¶æœ€ç»ˆå†™å…¥ etcdï¼Œè¿™åˆ©ç”¨äº† etcd
é›†ä¸­å¼å­˜å‚¨çš„ä¸€è‡´æ€§è¯­ä¹‰ï¼Œæœ‰æ•ˆåœ°é¿å…äº†
<strong>è„‘è£‚ï¼ˆsplit-brainï¼‰</strong>é—®é¢˜ï¼Œç¡®ä¿åœ¨ä»»ä½•æ—¶åˆ»éƒ½ä¸ä¼šæœ‰ä¸¤ä¸ªå®ä¾‹åŒæ—¶è¢«é•¿æœŸè®¤å®šä¸ºé¢†å¯¼è€…ã€‚</li>
</ul>

                    
                </div>

                
                        
<div class="post-copyright-info-container border-box">
    <div class="copyright-info-content border-box">
        <div class="copyright-info-top border-box">
            <div class="copyright-post-title border-box text-ellipsis">
                Kubernete é«˜å¯ç”¨é›†ç¾¤
            </div>

            <div class="copyright-post-link border-box text-ellipsis">
                2025/08/31/17-K8S-é«˜å¯ç”¨é›†ç¾¤/
            </div>
        </div>

        <div class="copyright-info-bottom border-box">
            <div class="copyright-post-author bottom-item">
                <div class="type">
                    Author
                </div>
                <div class="content">Zhongjun Qiu</div>
            </div>

            <div class="post-time bottom-item">
                <div class="type">
                    Published
                </div>
                <div class="content">2025-08-31 20:23</div>
            </div>


            <div class="post-license bottom-item">
                <div class="type">
                    License
                </div>
                <div class="content tooltip" data-tooltip-content="CC BY-NC-SA 4.0">
                    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed" target="_blank">
                        
                            <i class="fa-brands fa-creative-commons"></i>
                            <i class="fa-brands fa-creative-commons-by"></i>
                            <i class="fa-brands fa-creative-commons-nc"></i>
                            <i class="fa-brands fa-creative-commons-sa"></i>
                        
                    </a>
                </div>
            </div>
        </div>

        <i class="copyright-bg fa-solid fa-copyright"></i>
    </div>
    <div class="copy-copyright-info flex-center tooltip" data-tooltip-content="Copy copyright info" data-tooltip-offset-y="-2px">
        <i class="fa-solid fa-copy"></i>
    </div>
</div>

                

                <div class="post-bottom-tags-and-share border-box">
                    <div>
                        
                            <ul class="post-tags-box border-box">
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/K8S/">K8S</a>
                                    </li>
                                
                            </ul>
                        
                    </div>
                    <div>
                        
                            <div class="post-share-container border-box">
    <ul class="share-list-wrap border-box">
        <li class="qq share-item border-box flex-center tooltip"
            data-tooltip-content="Share to QQ"
        >
            <i class="fa-brands fa-qq"></i>
        </li>
        <li class="wechat share-item border-box flex-center tooltip tooltip-img"
            data-tooltip-content="Share to WeChat"
            data-tooltip-img-tip="Scan by WeChat"
            data-tooltip-img-style="background-color: #fff; top: -10px; padding: 0.6rem 0.6rem 0.1rem 0.6rem;"
        >
            <i class="fa-brands fa-weixin"></i>
        </li>
        <li class="weibo share-item border-box flex-center tooltip"
            data-tooltip-content="Share to WeiBo"
        >
            <i class="fa-brands fa-weibo"></i>
        </li>
    </ul>
</div>

                        
                    </div>
                </div>

                
                    

<div class="reward-author-container border-box flex-center">
    <div class="reward-btn border-box flex-center tooltip tooltip-img"
            data-tooltip-img-url="/images/post/payment.jpg"
            data-tooltip-img-trigger="click"
            data-tooltip-img-style="top: -6px;"
    >
        <i class="fa-solid fa-gift"></i>&nbsp;REWARD AUTHOR
    </div>
</div>

                

                
                    <div class="post-nav border-box">
                        
                            <div class="prev-post">
                                <a class="prev"
                                   rel="prev"
                                   href="/2025/09/06/1-Go-%E5%8D%8F%E7%A8%8B%E7%90%86%E8%A7%A3/"
                                   title="Goè¯­è¨€ä¸­çš„åç¨‹"
                                >
                                    <span class="left arrow-icon flex-center">
                                        <i class="fas fa-chevron-left"></i>
                                    </span>
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">Goè¯­è¨€ä¸­çš„åç¨‹</span>
                                        <span class="post-nav-item">Prev posts</span>
                                    </span>
                                </a>
                            </div>
                        
                        
                            <div class="next-post">
                                <a class="next"
                                   rel="next"
                                   href="/2025/08/30/16-K8S-%E8%BF%90%E7%BB%B4%E8%A1%A5%E5%85%85/"
                                   title="Kubernetes è¿ç»´é¢å¤–çŸ¥è¯†"
                                >
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">Kubernetes è¿ç»´é¢å¤–çŸ¥è¯†</span>
                                        <span class="post-nav-item">Next posts</span>
                                    </span>
                                    <span class="right arrow-icon flex-center">
                                        <i class="fas fa-chevron-right"></i>
                                    </span>
                                </a>
                            </div>
                        
                    </div>
                

                
                    


    <div class="comments-container border-box">
        <div id="comments-anchor" class="comment-area-title border-box">
            <i class="fas fa-comments"></i>&nbsp;Comments
        </div>
        <div class="comment-plugin-fail border-box">
    <span class="fail-tip">Comment plugin failed to load</span>
    <button class="reload keep-button">Click to reload</button>
</div>
<div class="comment-plugin-loading flex-center border-box">
    <i class="loading-icon fa-solid fa-spinner fa-spin"></i>
    <span class="load-tip">Loading comment plugin</span>
</div>
<script data-pjax>
  window.KeepCommentPlugin = {}
  window.KeepCommentPlugin.hideLoading = () => {
    const cplDom = document.querySelector('.comments-container .comment-plugin-loading')
    cplDom.style.display = 'none'
  }
  window.KeepCommentPlugin.loadFailHandle = () => {
    window.KeepCommentPlugin.hideLoading()
    const cpfDom = document.querySelector('.comments-container .comment-plugin-fail')
    cpfDom.style.display = 'flex'
    cpfDom.querySelector('.reload').addEventListener('click', () => {
      window.location.reload()
    })
  }
</script>

        
            

    <div class="waline-comment-container">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/waline/3.3.2/waline.css"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/waline/3.3.2/waline-meta.css"/>
        <div id="waline-comment"></div>
        <script data-pjax>
          window.KeepCommentPlugin.walineOptions = JSON.parse('{}'.replace(/&#34;/g, '"'))
          window.KeepCommentPlugin.walineOptions.el = '#waline-comment'
          window.KeepCommentPlugin.walineOptions.comment = '.post-comments-count'
          window.KeepCommentPlugin.walineOptions.serverURL = 'https://waline-vercel-two-rho.vercel.app/'
          window.KeepCommentPlugin.walineOptions.lang = 'en' || 'zh-CN'
          window.KeepCommentPlugin.walineOptions.reaction = 'true' === 'true'
        </script>

        

        
            <script 
                    async
                    type="module"
            >
              import { init } from 'https://cdnjs.cloudflare.com/ajax/libs/waline/3.3.2/waline.js'
              window.KeepCommentPlugin.initWaline = () => {
                if (init) {
                  init(window.KeepCommentPlugin.walineOptions)
                  window.KeepCommentPlugin.hideLoading()
                } else {
                  setTimeout(() => {
                    window.KeepCommentPlugin.initWaline()
                  }, 1000)
                }
              }

              if ('false' === 'true') {
                setTimeout(() => {
                  window.KeepCommentPlugin.initWaline()
                }, 1200)
              } else {
                window.addEventListener('DOMContentLoaded', window.KeepCommentPlugin.initWaline)
              }
            </script>
        
    </div>


        
    </div>





                
            </div>
        </div>

        
            <div class="pc-post-toc right-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#k8s%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6"><span class="nav-text">K8Sæ ¸å¿ƒç»„ä»¶</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#k8s-api-server"><span class="nav-text">K8S API Server</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#k8s-scheduler"><span class="nav-text">K8S Scheduler</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#k8s-controller"><span class="nav-text">K8S Controller</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#etcd"><span class="nav-text">etcd</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#kubelet"><span class="nav-text">Kubelet</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#kube-proxy"><span class="nav-text">Kube-Proxy</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#k8s%E9%AB%98%E5%8F%AF%E7%94%A8ha%E9%9B%86%E7%BE%A4"><span class="nav-text">K8Sé«˜å¯ç”¨ï¼ˆHAï¼‰é›†ç¾¤</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#etcd-1"><span class="nav-text">etcd</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A2%86%E5%AF%BC%E8%80%85%E9%80%89%E4%B8%BEleader-election"><span class="nav-text">é¢†å¯¼è€…é€‰ä¸¾ï¼ˆLeader Electionï¼‰</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%A5%E5%BF%97%E5%A4%8D%E5%88%B6log-replication"><span class="nav-text">æ—¥å¿—å¤åˆ¶ï¼ˆLog Replicationï¼‰</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%A5%E5%BF%97%E6%8F%90%E4%BA%A4%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7%E4%BF%9D%E9%9A%9C"><span class="nav-text">æ—¥å¿—æäº¤çš„å®‰å…¨æ€§ä¿éšœ</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#api-server"><span class="nav-text">API Server</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#k8s-scheduler-k8s-controller"><span class="nav-text">K8S Scheduler &amp; K8S
Controller</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%94%81%E5%AF%B9%E8%B1%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F"><span class="nav-text">é”å¯¹è±¡ä¸å®ç°æ–¹å¼</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%82%E4%B8%8E%E8%80%85%E7%9A%84%E8%BA%AB%E4%BB%BD%E6%A0%87%E8%AF%86"><span class="nav-text">å‚ä¸è€…çš„èº«ä»½æ ‡è¯†</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%89%E4%B8%AA%E9%87%8D%E8%A6%81%E6%97%B6%E9%97%B4%E5%8F%82%E6%95%B0"><span class="nav-text">ä¸‰ä¸ªé‡è¦æ—¶é—´å‚æ•°</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#leader-election-%E4%B8%BB%E5%BE%AA%E7%8E%AF%E8%BF%87%E7%A8%8B"><span class="nav-text">Leader Election ä¸»å¾ªç¯è¿‡ç¨‹</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8E%9F%E5%AD%90%E6%80%A7%E4%B8%8E%E4%B8%80%E8%87%B4%E6%80%A7%E4%BF%9D%E9%9A%9C"><span class="nav-text">åŸå­æ€§ä¸ä¸€è‡´æ€§ä¿éšœ</span></a></li></ol></li></ol></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>
        </div>

        <div class="page-main-content-bottom border-box">
            
<footer class="footer border-box">
    <div class="copyright-info info-item">
    &copy;&nbsp;<span>2020</span>&nbsp;-&nbsp;2025
    
            &nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;&nbsp;<a href="/">Zhongjun Qiu</a>
        
    </div>

    <div class="theme-info info-item">
        Powered by&nbsp;<a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;&&nbsp;Theme&nbsp;<a class="keep-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep</a>
    </div>

    
        
        <div class="deploy-info info-item">
            
                <a target="_blank" rel="nofollow" href="https://github.com">
            
            This site is deployed on <span class="tooltip" data-tooltip-content="GitHub Pages"><img src="/images/brands/github.png"></span>
            
                </a>
            
        </div>
    

    
        <div class="count-info info-item">
            
                <span class="count-item border-box word">
                    <span class="item-type border-box">Total words</span>
                    <span class="item-value border-box word">390.6k</span>
                </span>
            

            

            
                <span class="count-item border-box pv">
                    <span class="item-type border-box">Page View</span>
                    <span class="item-value border-box pv" id="busuanzi_value_site_pv"></span>
                </span>
            
        </div>
    

    
</footer>

        </div>
    </div>

    <!-- post tools -->
    
        <div class="post-tools right-toc">
            <div class="post-tools-container border-box">
    <ul class="post-tools-list border-box">
        <!-- PC encrypt again -->
        

        <!-- PC TOC show toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- PC go comment -->
        
            <li class="tools-item flex-center go-to-comments">
                <i class="fas fa-comment"></i>
                <span class="post-comments-count"></span>
            </li>
        

        <!-- PC full screen -->
        <li class="tools-item flex-center full-screen">
            <i class="fa-solid fa-expand"></i>
        </li>
    </ul>
</div>

        </div>
    

    <!-- side tools -->
    <div class="side-tools">
        <div class="side-tools-container border-box ">
    <ul class="side-tools-list side-tools-show-handle border-box">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <!-- toggle mode -->
        
            <li class="tools-item tool-toggle-theme-mode flex-center">
                <i class="fas fa-moon"></i>
            </li>
        

        <!-- rss -->
        

        <!-- to bottom -->
        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list border-box">
        
            <li class="tools-item toggle-show-toc-tablet flex-center">
                <i class="fas fa-list"></i>
            </li>
        

        
            <li class="tools-item go-to-comments-tablet flex-center">
                <i class="fas fa-comment"></i>
            </li>
        

        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>

        <li class="tools-item tool-scroll-to-top flex-center show-arrow">
            <i class="arrow fas fa-arrow-up"></i>
            <span class="percent"></span>
        </li>
    </ul>
</div>

    </div>

    <!-- image mask -->
    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    <!-- local search -->
    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

    <!-- tablet toc -->
    
        <div class="tablet-post-toc-mask">
            <div class="tablet-post-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#k8s%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6"><span class="nav-text">K8Sæ ¸å¿ƒç»„ä»¶</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#k8s-api-server"><span class="nav-text">K8S API Server</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#k8s-scheduler"><span class="nav-text">K8S Scheduler</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#k8s-controller"><span class="nav-text">K8S Controller</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#etcd"><span class="nav-text">etcd</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#kubelet"><span class="nav-text">Kubelet</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#kube-proxy"><span class="nav-text">Kube-Proxy</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#k8s%E9%AB%98%E5%8F%AF%E7%94%A8ha%E9%9B%86%E7%BE%A4"><span class="nav-text">K8Sé«˜å¯ç”¨ï¼ˆHAï¼‰é›†ç¾¤</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#etcd-1"><span class="nav-text">etcd</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A2%86%E5%AF%BC%E8%80%85%E9%80%89%E4%B8%BEleader-election"><span class="nav-text">é¢†å¯¼è€…é€‰ä¸¾ï¼ˆLeader Electionï¼‰</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%A5%E5%BF%97%E5%A4%8D%E5%88%B6log-replication"><span class="nav-text">æ—¥å¿—å¤åˆ¶ï¼ˆLog Replicationï¼‰</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%A5%E5%BF%97%E6%8F%90%E4%BA%A4%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7%E4%BF%9D%E9%9A%9C"><span class="nav-text">æ—¥å¿—æäº¤çš„å®‰å…¨æ€§ä¿éšœ</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#api-server"><span class="nav-text">API Server</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#k8s-scheduler-k8s-controller"><span class="nav-text">K8S Scheduler &amp; K8S
Controller</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%94%81%E5%AF%B9%E8%B1%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F"><span class="nav-text">é”å¯¹è±¡ä¸å®ç°æ–¹å¼</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%82%E4%B8%8E%E8%80%85%E7%9A%84%E8%BA%AB%E4%BB%BD%E6%A0%87%E8%AF%86"><span class="nav-text">å‚ä¸è€…çš„èº«ä»½æ ‡è¯†</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%89%E4%B8%AA%E9%87%8D%E8%A6%81%E6%97%B6%E9%97%B4%E5%8F%82%E6%95%B0"><span class="nav-text">ä¸‰ä¸ªé‡è¦æ—¶é—´å‚æ•°</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#leader-election-%E4%B8%BB%E5%BE%AA%E7%8E%AF%E8%BF%87%E7%A8%8B"><span class="nav-text">Leader Election ä¸»å¾ªç¯è¿‡ç¨‹</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8E%9F%E5%AD%90%E6%80%A7%E4%B8%8E%E4%B8%80%E8%87%B4%E6%80%A7%E4%BF%9D%E9%9A%9C"><span class="nav-text">åŸå­æ€§ä¸ä¸€è‡´æ€§ä¿éšœ</span></a></li></ol></li></ol></li></ol>
    </div>
</div>

            </div>
        </div>
    
</main>





<!-- common js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/utils.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/header-shrink.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/back2top.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/toggle-theme.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/code-block.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/main.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/libs/anime.min.js"></script>

<!-- local search -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/local-search.min.js"></script>


<!-- lazyload -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/lazyload.min.js"></script>


<div class="">
    <!-- home page -->
    

    <!-- post page -->
    
        <!-- post-helper -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/post/post-helper.min.js"></script>

        <!-- toc -->
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/post/toc.min.js"></script>
        

        <!-- copyright-info -->
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/post/copyright-info.min.js"></script>
        

        <!-- share -->
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.5/js/post/share.min.js"></script>
        
    

    <!-- categories page -->
    

    <!-- links page -->
    

    <!-- photos page -->
    

    <!-- tools page -->
    
</div>

<!-- mermaid -->


<!-- pjax -->



    
        
    
        
            
<script class="custom-inject-js" src="/js/custom_code_block.js" data-pjax></script>

        
    

</body>
</html>
